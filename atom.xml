<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Daichong&#39;s Blog</title>
  
  <subtitle>æˆ´å´‡åšå®¢,æˆ´å´‡æŠ€æœ¯åšå®¢,phpæŠ€æœ¯åšå®¢,hexoåšå®¢,webæŠ€æœ¯åšå®¢</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://www.daichongweb.com/"/>
  <updated>2020-08-24T07:36:23.123Z</updated>
  <id>http://www.daichongweb.com/</id>
  
  <author>
    <name>Daichongweb</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>JetBrains2020å…¨å®¶æ¡¶æ¿€æ´»</title>
    <link href="http://www.daichongweb.com/JetBrains2020%E5%85%A8%E5%AE%B6%E6%A1%B6%E6%BF%80%E6%B4%BB/"/>
    <id>http://www.daichongweb.com/JetBrains2020å…¨å®¶æ¡¶æ¿€æ´»/</id>
    <published>2020-08-19T02:28:42.000Z</published>
    <updated>2020-08-24T07:36:23.123Z</updated>
    
    <content type="html"><![CDATA[<h4 id="å®˜æ–¹ä¸‹è½½æœ€æ–°ç‰ˆ"><a href="#å®˜æ–¹ä¸‹è½½æœ€æ–°ç‰ˆ" class="headerlink" title="å®˜æ–¹ä¸‹è½½æœ€æ–°ç‰ˆ"></a>å®˜æ–¹ä¸‹è½½æœ€æ–°ç‰ˆ</h4><a href="https://www.jetbrains.com" target="_blank" rel="noopener">JetBrainså®˜ç½‘ä¸‹è½½</a><h5 id="äº²æµ‹å¯æ¿€æ´»"><a href="#äº²æµ‹å¯æ¿€æ´»" class="headerlink" title="äº²æµ‹å¯æ¿€æ´»"></a>äº²æµ‹å¯æ¿€æ´»</h5><blockquote><p>1.IntelliJ IDEA 2020.2åŠä»¥ä¸‹ç‰ˆæœ¬<br>2.PhpStorm 2020.2åŠä»¥ä¸‹ç‰ˆæœ¬<br>3.WebStorm 2020.2åŠä»¥ä¸‹ç‰ˆæœ¬<br><a id="more"></a></p></blockquote><h4 id="ä¸‹è½½è¡¥ä¸"><a href="#ä¸‹è½½è¡¥ä¸" class="headerlink" title="ä¸‹è½½è¡¥ä¸"></a>ä¸‹è½½è¡¥ä¸</h4><a href="https://www.daichongweb.cn/image/jetbrains-agent-2020.jar" target="_blank" rel="noopener">ä¸‹è½½è¡¥ä¸</a><h4 id="å¦‚ä½•æ¿€æ´»"><a href="#å¦‚ä½•æ¿€æ´»" class="headerlink" title="å¦‚ä½•æ¿€æ´»"></a>å¦‚ä½•æ¿€æ´»</h4><p>&emsp;(1).è¿è¡ŒIDEï¼ˆæ–°å®‰è£…çš„é€‰æ‹©<code>Evaluate</code>ï¼‰</p><p>&emsp;(2).éšä¾¿æ‰“å¼€æˆ–è€…åˆ›å»ºä¸€ä¸ªé¡¹ç›®ï¼ŒæˆåŠŸåä¿æŒä¸åŠ¨</p><p>&emsp;(3).æŠŠè¡¥ä¸è§£å‹åçš„<code>jetbrains-agent.jar</code>æ‹–å…¥åˆ°IDEä¸­ï¼Œå¼¹æ¡†åç‚¹å‡»<code>Restart</code>ã€‚</p><p>&emsp;(4).é‡å¯åä¼šå¼¹å‡ºã€JetbrainsAgent é…ç½®åŠ©æ‰‹ã€‘ï¼Œé€‰æ‹©<code>Activation Code</code>ï¼Œå¤åˆ¶ä¸‹é¢çš„å®‰è£…å‚æ•°ï¼Œç„¶åç‚¹å‡»ä¸º<code>XXX</code>å®‰è£…å°±å¯ä»¥äº†ï¼ï¼ï¼</p><h4 id="å®‰è£…å‚æ•°"><a href="#å®‰è£…å‚æ•°" class="headerlink" title="å®‰è£…å‚æ•°"></a>å®‰è£…å‚æ•°</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LFq51qqupnaiTNn39w6zATiOTxZI2JYuRJEBlzmUDv4zeeNlXhMgJZVb0q5QkLr+CIUrSuNB7ucifrGXawLB4qswPOXYG7+ItDNUR/<span class="number">9</span>UkLTUWlnHLX07hnR1USOrWIjTmbytcIKEdaI6x0RskyotuItj84xxoSBP/iRBW2EHpOc</span><br></pre></td></tr></table></figure><h4 id="å¸¸è§é—®é¢˜"><a href="#å¸¸è§é—®é¢˜" class="headerlink" title="å¸¸è§é—®é¢˜"></a>å¸¸è§é—®é¢˜</h4><p>&emsp;(1).å®‰è£…æˆåŠŸåè¿˜æ˜¯è·³è½¬åˆ°æ¿€æ´»é¡µé¢ï¼Œè¯·å°è¯•æ–­ç½‘åå†æ“ä½œã€‚<br>&emsp;(2).æ–­ç½‘åè¿˜æ˜¯æ— æ³•ç ´è§£ï¼Œè¯·å°è¯•åˆ é™¤hostsè®¾ç½®çš„æ˜ å°„åå†æ“ä½œã€‚</p><h4 id="è‡´è°¢ğŸ™"><a href="#è‡´è°¢ğŸ™" class="headerlink" title="è‡´è°¢ğŸ™"></a>è‡´è°¢ğŸ™</h4><p>&emsp;å¥½ç”¨çš„è¯å°±è¯·è¯„è®ºä¸€ä¸‹å†èµ°å§ï¼</p>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;å®˜æ–¹ä¸‹è½½æœ€æ–°ç‰ˆ&quot;&gt;&lt;a href=&quot;#å®˜æ–¹ä¸‹è½½æœ€æ–°ç‰ˆ&quot; class=&quot;headerlink&quot; title=&quot;å®˜æ–¹ä¸‹è½½æœ€æ–°ç‰ˆ&quot;&gt;&lt;/a&gt;å®˜æ–¹ä¸‹è½½æœ€æ–°ç‰ˆ&lt;/h4&gt;&lt;a href=&quot;https://www.jetbrains.com&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;JetBrainså®˜ç½‘ä¸‹è½½&lt;/a&gt;
&lt;h5 id=&quot;äº²æµ‹å¯æ¿€æ´»&quot;&gt;&lt;a href=&quot;#äº²æµ‹å¯æ¿€æ´»&quot; class=&quot;headerlink&quot; title=&quot;äº²æµ‹å¯æ¿€æ´»&quot;&gt;&lt;/a&gt;äº²æµ‹å¯æ¿€æ´»&lt;/h5&gt;&lt;blockquote&gt;
&lt;p&gt;1.IntelliJ IDEA 2020.2åŠä»¥ä¸‹ç‰ˆæœ¬&lt;br&gt;2.PhpStorm 2020.2åŠä»¥ä¸‹ç‰ˆæœ¬&lt;br&gt;3.WebStorm 2020.2åŠä»¥ä¸‹ç‰ˆæœ¬&lt;br&gt;&lt;/p&gt;&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="å¼€å‘å·¥å…·" scheme="http://www.daichongweb.com/tags/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
  <entry>
    <title>fastjsonç±»å‹è½¬æ¢</title>
    <link href="http://www.daichongweb.com/fastjson%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/"/>
    <id>http://www.daichongweb.com/fastjsonç±»å‹è½¬æ¢/</id>
    <published>2020-05-25T03:15:32.000Z</published>
    <updated>2020-08-19T03:46:29.165Z</updated>
    
    <content type="html"><![CDATA[<h4 id="jsonStringè½¬map"><a href="#jsonStringè½¬map" class="headerlink" title="jsonStringè½¬map"></a>jsonStringè½¬map</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">JSON.parseObject(string)</span><br></pre></td></tr></table></figure><h4 id="å®ä½“ç±»è½¬jsonstring"><a href="#å®ä½“ç±»è½¬jsonstring" class="headerlink" title="å®ä½“ç±»è½¬jsonstring"></a>å®ä½“ç±»è½¬jsonstring</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">JSON.toJSONString(javaClass)</span><br></pre></td></tr></table></figure><a id="more"></a><h4 id="å­˜å…¥redisé˜Ÿåˆ—ä¹‹å‰æ˜¯jsonStringï¼Œæ‹¿å‡ºæ¥å˜æˆobjectå¤„ç†åŠæ³•"><a href="#å­˜å…¥redisé˜Ÿåˆ—ä¹‹å‰æ˜¯jsonStringï¼Œæ‹¿å‡ºæ¥å˜æˆobjectå¤„ç†åŠæ³•" class="headerlink" title="å­˜å…¥redisé˜Ÿåˆ—ä¹‹å‰æ˜¯jsonStringï¼Œæ‹¿å‡ºæ¥å˜æˆobjectå¤„ç†åŠæ³•"></a>å­˜å…¥redisé˜Ÿåˆ—ä¹‹å‰æ˜¯jsonStringï¼Œæ‹¿å‡ºæ¥å˜æˆobjectå¤„ç†åŠæ³•</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å…ˆè½¬å­—ç¬¦</span></span><br><span class="line">String value = lotteryData.index(roomId, userId).toString();</span><br><span class="line"><span class="comment">// è½¬map</span></span><br><span class="line">JSON.parseObject(value);</span><br></pre></td></tr></table></figure><h4 id="å¦‚ä½•ç»„æˆä¸€ä¸ªå¤šç»´æ•°ç»„"><a href="#å¦‚ä½•ç»„æˆä¸€ä¸ªå¤šç»´æ•°ç»„" class="headerlink" title="å¦‚ä½•ç»„æˆä¸€ä¸ªå¤šç»´æ•°ç»„"></a>å¦‚ä½•ç»„æˆä¸€ä¸ªå¤šç»´æ•°ç»„</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¾‹å­</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"data"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"nickname"</span>: <span class="string">"æˆ´å´‡"</span>,</span><br><span class="line">            <span class="string">"userId"</span>: <span class="number">6144</span>,</span><br><span class="line">            <span class="string">"roomId"</span>: <span class="number">10086</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"nickname"</span>: <span class="string">"æˆ´å´‡"</span>,</span><br><span class="line">            <span class="string">"userId"</span>: <span class="number">2174</span>,</span><br><span class="line">            <span class="string">"roomId"</span>: <span class="number">10086</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"nickname"</span>: <span class="string">"æˆ´å´‡"</span>,</span><br><span class="line">            <span class="string">"userId"</span>: <span class="number">9997</span>,</span><br><span class="line">            <span class="string">"roomId"</span>: <span class="number">10086</span></span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="string">"code"</span>: <span class="string">"0"</span>,</span><br><span class="line">    <span class="string">"msg"</span>: <span class="string">"æ“ä½œæˆåŠŸï¼"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åšæ³•</span></span><br><span class="line">List&lt;Map&lt;String, Object&gt;&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">long</span> userId : rands) &#123;</span><br><span class="line">    <span class="keyword">if</span> (userId == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    String value = lotteryData.index(roomId, userId).toString();</span><br><span class="line">    list.add(JSON.parseObject(value));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;jsonStringè½¬map&quot;&gt;&lt;a href=&quot;#jsonStringè½¬map&quot; class=&quot;headerlink&quot; title=&quot;jsonStringè½¬map&quot;&gt;&lt;/a&gt;jsonStringè½¬map&lt;/h4&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;JSON.parseObject(string)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;å®ä½“ç±»è½¬jsonstring&quot;&gt;&lt;a href=&quot;#å®ä½“ç±»è½¬jsonstring&quot; class=&quot;headerlink&quot; title=&quot;å®ä½“ç±»è½¬jsonstring&quot;&gt;&lt;/a&gt;å®ä½“ç±»è½¬jsonstring&lt;/h4&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;JSON.toJSONString(javaClass)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
      <category term="java" scheme="http://www.daichongweb.com/tags/java/"/>
    
  </entry>
  
  <entry>
    <title>macä¸‹ä½¿ç”¨homebrewå®‰è£…æŒ‡å®šç‰ˆæœ¬node</title>
    <link href="http://www.daichongweb.com/mac%E4%B8%8B%E4%BD%BF%E7%94%A8homebrew%E5%AE%89%E8%A3%85%E6%8C%87%E5%AE%9A%E7%89%88%E6%9C%ACnode/"/>
    <id>http://www.daichongweb.com/macä¸‹ä½¿ç”¨homebrewå®‰è£…æŒ‡å®šç‰ˆæœ¬node/</id>
    <published>2020-05-10T11:21:41.000Z</published>
    <updated>2020-08-19T03:46:29.183Z</updated>
    
    <content type="html"><![CDATA[<h4 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h4><p>&emsp;macä¸‹çš„homebrewç›´æ¥ä½¿ç”¨<code>brew install node</code>å®‰è£…çš„nodeç‰ˆæœ¬æ˜¯<code>14.+</code>ï¼Œè¿™ç»™å¾ˆå¤šç¨‹åºå¸¦æ¥äº†é—®é¢˜ï¼Œå¦‚æœç›´æ¥å®‰è£…ä½ç‰ˆæœ¬çš„nodeä¼šé€ æˆâ€˜npmâ€™ç­‰æ— æ³•ä½¿ç”¨ã€‚</p><h4 id="å¸è½½"><a href="#å¸è½½" class="headerlink" title="å¸è½½"></a>å¸è½½</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew remove node</span><br></pre></td></tr></table></figure><a id="more"></a><h4 id="è§£ç»‘"><a href="#è§£ç»‘" class="headerlink" title="è§£ç»‘"></a>è§£ç»‘</h4><p>&emsp;å¸è½½ä¹‹åè¦å…ˆæŠŠä¹‹å‰nodeè§£é™¤è¿æ¥ã€‚<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew unlink node</span><br></pre></td></tr></table></figure></p><h4 id="æŸ¥æ‰¾å¯ç”¨çš„nodeç‰ˆæœ¬"><a href="#æŸ¥æ‰¾å¯ç”¨çš„nodeç‰ˆæœ¬" class="headerlink" title="æŸ¥æ‰¾å¯ç”¨çš„nodeç‰ˆæœ¬"></a>æŸ¥æ‰¾å¯ç”¨çš„nodeç‰ˆæœ¬</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew search node</span><br></pre></td></tr></table></figure><img src="/macä¸‹ä½¿ç”¨homebrewå®‰è£…æŒ‡å®šç‰ˆæœ¬node/img/2.png" width="500"><h4 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install node@10</span><br></pre></td></tr></table></figure><img src="/macä¸‹ä½¿ç”¨homebrewå®‰è£…æŒ‡å®šç‰ˆæœ¬node/img/3.png" width="500"><h4 id="æ·»åŠ ç¯å¢ƒå˜é‡"><a href="#æ·»åŠ ç¯å¢ƒå˜é‡" class="headerlink" title="æ·»åŠ ç¯å¢ƒå˜é‡"></a>æ·»åŠ ç¯å¢ƒå˜é‡</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vi ~/.bash_profile</span><br><span class="line">export PATH="/usr/local/opt/node@10/bin:$PATH"</span><br></pre></td></tr></table></figure><img src="/macä¸‹ä½¿ç”¨homebrewå®‰è£…æŒ‡å®šç‰ˆæœ¬node/img/4.png" width="500"><p>&emsp;ç»è¿‡æ­¤æ­¥éª¤è¿˜æ˜¯æ— æ³•åœ¨ç»ˆç«¯ä½¿ç”¨â€˜node -vâ€™å°±å¢åŠ <br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vi ~/.bash_profile</span><br><span class="line">alias node='/usr/local/opt/node@10/bin/node'</span><br></pre></td></tr></table></figure></p><p>&emsp;æ— æ³•ä½¿ç”¨<code>npm</code>ç­‰æƒ…å†µæ‰§è¡Œ<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew link --overwrite --force node@10</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;ä»‹ç»&quot;&gt;&lt;a href=&quot;#ä»‹ç»&quot; class=&quot;headerlink&quot; title=&quot;ä»‹ç»&quot;&gt;&lt;/a&gt;ä»‹ç»&lt;/h4&gt;&lt;p&gt;&amp;emsp;macä¸‹çš„homebrewç›´æ¥ä½¿ç”¨&lt;code&gt;brew install node&lt;/code&gt;å®‰è£…çš„nodeç‰ˆæœ¬æ˜¯&lt;code&gt;14.+&lt;/code&gt;ï¼Œè¿™ç»™å¾ˆå¤šç¨‹åºå¸¦æ¥äº†é—®é¢˜ï¼Œå¦‚æœç›´æ¥å®‰è£…ä½ç‰ˆæœ¬çš„nodeä¼šé€ æˆâ€˜npmâ€™ç­‰æ— æ³•ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;h4 id=&quot;å¸è½½&quot;&gt;&lt;a href=&quot;#å¸è½½&quot; class=&quot;headerlink&quot; title=&quot;å¸è½½&quot;&gt;&lt;/a&gt;å¸è½½&lt;/h4&gt;&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;brew remove node&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
      <category term="node" scheme="http://www.daichongweb.com/tags/node/"/>
    
  </entry>
  
  <entry>
    <title>phpç”Ÿæˆæµ·æŠ¥å›¾å‡ºç°å›¾ç‰‡æŸåçš„é—®é¢˜</title>
    <link href="http://www.daichongweb.com/php%E7%94%9F%E6%88%90%E6%B5%B7%E6%8A%A5%E5%9B%BE%E5%87%BA%E7%8E%B0%E5%9B%BE%E7%89%87%E6%8D%9F%E5%9D%8F%E7%9A%84%E9%97%AE%E9%A2%98/"/>
    <id>http://www.daichongweb.com/phpç”Ÿæˆæµ·æŠ¥å›¾å‡ºç°å›¾ç‰‡æŸåçš„é—®é¢˜/</id>
    <published>2020-05-10T08:52:30.000Z</published>
    <updated>2020-08-19T03:46:29.209Z</updated>
    
    <content type="html"><![CDATA[<h4 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h4><p>&emsp;è¿‘å¹´å°ç¨‹åºã€å¾®ä¿¡å‘å±•è¿…é€Ÿã€‚å¾®ä¿¡ã€å¾®åšç—…æ¯’å¼ä¼ æ’­ä½¿ç”¨æˆ·ä»ä¼ ç»Ÿçš„APPä¸Šå‘<code>å³æ‰«å³ç”¨ã€æ— éœ€å®‰è£…</code>çš„å°ç¨‹åºä¸Šè½¬åŒ–ã€‚è€Œå¾®ä¿¡å…¬ä¼—å·ã€å°ç¨‹åºçš„è¿…é€Ÿå‘å±•ç¦»ä¸å¼€è½¬å‘ã€äºŒç»´ç åˆ†äº«ã€‚</p><p>&emsp;ä½†æ˜¯äºŒç»´ç å½¢å¼å•ä¸€ï¼Œå¯¹ç”¨æˆ·æ¥è¯´æ¯«æ— å¸å¼•åŠ›ã€‚çº¯ç²¹ä¾é â€˜å†å–ã€é‡‘é’±ã€ç¤¼ç‰©å¸å¼•â€™æ–¹å¼å·²ç»å˜å¾—æ„ˆæ¥æ„ˆæ— ä»·å€¼ã€‚</p><p>&emsp;å¯¹äºâ€™è§†è§‰åŠ¨ç‰©â€™å’Œå¤§éƒ¨åˆ†ç”¨æˆ·æ¥è¯´ï¼Œç²¾ç¾çš„å›¾ç‰‡åŠ ä¸ŠäºŒç»´ç çš„ç»„åˆæ›´å…·æœ‰å¸å¼•åŠ›ã€‚<br><a id="more"></a><br><img src="/phpç”Ÿæˆæµ·æŠ¥å›¾å‡ºç°å›¾ç‰‡æŸåçš„é—®é¢˜/img/3.jpg"></p><h4 id="phpç”Ÿæˆæµ·æŠ¥å›¾å‰ææ¡ä»¶"><a href="#phpç”Ÿæˆæµ·æŠ¥å›¾å‰ææ¡ä»¶" class="headerlink" title="phpç”Ÿæˆæµ·æŠ¥å›¾å‰ææ¡ä»¶"></a>phpç”Ÿæˆæµ·æŠ¥å›¾å‰ææ¡ä»¶</h4><ul><li>gdåº“æ‰©å±•</li></ul><h4 id="ä¸Šä»£ç "><a href="#ä¸Šä»£ç " class="headerlink" title="ä¸Šä»£ç "></a>ä¸Šä»£ç </h4><h5 id="ç”Ÿæˆæ–¹æ³•"><a href="#ç”Ÿæˆæ–¹æ³•" class="headerlink" title="ç”Ÿæˆæ–¹æ³•"></a>ç”Ÿæˆæ–¹æ³•</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç”Ÿæˆæ–¹æ³•</span></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">createPoster</span><span class="params">($data)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $poster = <span class="keyword">new</span> Poster();</span><br><span class="line">        <span class="comment">//åˆ›å»ºç”»å¸ƒ</span></span><br><span class="line">        $im = $poster-&gt;createTrueColor(<span class="number">672</span>, <span class="number">1060</span>);</span><br><span class="line">        <span class="comment">//å­—ä½“æ–‡ä»¶</span></span><br><span class="line">        $font_file = <span class="keyword">$this</span>-&gt;typeface;</span><br><span class="line">        <span class="comment">// å•†å“å›¾ç‰‡</span></span><br><span class="line">        $goodsImg = $poster-&gt;createImgBoard($im, $data[<span class="string">'goodsPath'</span>], <span class="number">0</span>, <span class="number">0</span>, <span class="number">672</span>, <span class="number">668</span>);</span><br><span class="line">        <span class="comment">//äºŒç»´ç </span></span><br><span class="line">        $codeImg = $poster-&gt;createImgBoard($im, $data[<span class="string">'qrcode'</span>], <span class="number">410</span>, <span class="number">710</span>, <span class="number">225</span>, <span class="number">225</span>);</span><br><span class="line">        <span class="comment">//headimg</span></span><br><span class="line">        $headImg = $poster-&gt;createImgBoard($im, $data[<span class="string">'headimg'</span>], <span class="number">46</span>, <span class="number">942</span>, <span class="number">65</span>, <span class="number">65</span>);</span><br><span class="line">        <span class="comment">//btnimg</span></span><br><span class="line">        $btnimg = $poster-&gt;createImgBoard($im, $data[<span class="string">'btn'</span>], <span class="number">420</span>, <span class="number">960</span>, <span class="number">220</span>, <span class="number">48</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä»·æ ¼</span></span><br><span class="line">        $price_font = ImageColorAllocate($im, <span class="number">248</span>, <span class="number">6</span>, <span class="number">74</span>);</span><br><span class="line">        imagettftext($im, <span class="number">25</span>, <span class="number">0</span>, <span class="number">41</span>, <span class="number">759</span>, $price_font, $font_file, <span class="string">'Â¥'</span>);</span><br><span class="line">        imagettftext($im, <span class="number">38</span>, <span class="number">0</span>, <span class="number">60</span>, <span class="number">760</span>, $price_font, $font_file, $data[<span class="string">"price"</span>]);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å•†å“åç§°</span></span><br><span class="line">        $goodsName = trim(mb_substr($data[<span class="string">'title'</span>], <span class="number">0</span>, <span class="number">20</span>));</span><br><span class="line">        $good_font = ImageColorAllocate($im, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">        imagettftext($im, <span class="number">24</span>, <span class="number">0</span>, <span class="number">40</span>, <span class="number">820</span>, $good_font, $font_file, $poster-&gt;AutoWrap(<span class="number">12</span>, <span class="number">0</span>, $font_file, $goodsName, <span class="number">160</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ˜µç§°</span></span><br><span class="line">        $nickname = trim(mb_substr($data[<span class="string">'nickname'</span>], <span class="number">0</span>, <span class="number">8</span>));</span><br><span class="line">        $nick_font = ImageColorAllocate($im, <span class="number">109</span>, <span class="number">114</span>, <span class="number">120</span>);</span><br><span class="line">        imagettftext($im, <span class="number">16</span>, <span class="number">0</span>, <span class="number">130</span>, <span class="number">965</span>, $nick_font, $font_file, $poster-&gt;AutoWrap(<span class="number">12</span>, <span class="number">0</span>, $font_file, $nickname, <span class="number">80</span>));</span><br><span class="line">        imagettftext($im, <span class="number">16</span>, <span class="number">0</span>, <span class="number">130</span>, <span class="number">1000</span>, $nick_font, $font_file, $data[<span class="string">'time'</span>]);</span><br><span class="line">        ob_clean();</span><br><span class="line">        ob_end_clean();</span><br><span class="line">        <span class="comment">// è¾“å‡ºå›¾ç‰‡</span></span><br><span class="line">        $poster-&gt;lookImg($im);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//é‡Šæ”¾ç©ºé—´</span></span><br><span class="line">        imagedestroy($im);</span><br><span class="line">        imagedestroy($btnimg);</span><br><span class="line">        imagedestroy($goodsImg);</span><br><span class="line">        imagedestroy($codeImg);</span><br><span class="line">        imagedestroy($headImg);</span><br><span class="line">        <span class="comment">// åˆ é™¤æœ¬åœ°äºŒç»´ç </span></span><br><span class="line">        Qrcode::deleteCode($data[<span class="string">'qrcode'</span>]);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h5 id="å®ç°ç±»"><a href="#å®ç°ç±»" class="headerlink" title="å®ç°ç±»"></a>å®ç°ç±»</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å…·ä½“ç±»</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">library</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  ç”Ÿæˆæµ·æŠ¥å›¾</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> daichongweb</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@url</span> daichongweb.cn,daichongweb.com</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Poster</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä»å›¾ç‰‡æ–‡ä»¶åˆ›å»ºImageèµ„æº</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $file å›¾ç‰‡æ–‡ä»¶ï¼Œæ”¯æŒurl</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> bool|resource    æˆåŠŸè¿”å›å›¾ç‰‡imageèµ„æºï¼Œå¤±è´¥è¿”å›false</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">createImageFromFile</span><span class="params">($file)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">'/http(s)?:\/\//'</span>, $file)) &#123;</span><br><span class="line">            $fileSuffix = <span class="keyword">self</span>::getNetworkImgType($file);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $file_info = getimagesize($file);</span><br><span class="line">            $fileSuffix = $file_info[<span class="number">2</span>];</span><br><span class="line">            <span class="comment">// $fileSuffix = pathinfo($file, PATHINFO_EXTENSION);</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!$fileSuffix) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">switch</span> ($fileSuffix) &#123;</span><br><span class="line">            <span class="comment">/*case 'jpeg':</span></span><br><span class="line"><span class="comment">                $theImage = <span class="doctag">@imagecreatefromjpeg</span>($file);</span></span><br><span class="line"><span class="comment">                break;*/</span></span><br><span class="line">            <span class="keyword">case</span> <span class="string">'2'</span>:</span><br><span class="line">                $theImage = imagecreatefromjpeg($file);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">'3'</span>:</span><br><span class="line">                $theImage = @imagecreatefrompng($file);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">'1'</span>:</span><br><span class="line">                $theImage = @imagecreatefromgif($file);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                $theImage = @imagecreatefromstring(file_get_contents($file));</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> $theImage;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ–‡å­—æ¢è¡Œ</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">AutoWrap</span><span class="params">($fontsize, $angle, $fontface, $string, $width)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $content = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; mb_strlen($string); $i++) &#123;</span><br><span class="line">            $letter[] = mb_substr($string, $i, <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">foreach</span> ($letter <span class="keyword">as</span> $l) &#123;</span><br><span class="line">            $teststr = $content . <span class="string">""</span> . $l;</span><br><span class="line">            $testbox = imagettfbbox($fontsize, $angle, $fontface, $teststr);</span><br><span class="line">            <span class="keyword">if</span> (($testbox[<span class="number">2</span>] &gt; $width) &amp;&amp; ($content !== <span class="string">""</span>)) &#123;</span><br><span class="line">                $content .= <span class="string">"\n"</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            $content .= $l;</span><br><span class="line">        &#125;</span><br><span class="line">        $content = mb_convert_encoding($content, <span class="string">"html-entities"</span>, <span class="string">"utf-8"</span>);</span><br><span class="line">        <span class="keyword">return</span> $content;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getNetworkImgType</span><span class="params">($url)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $ch = curl_init();</span><br><span class="line">        curl_setopt($ch, CURLOPT_URL, $url);</span><br><span class="line">        curl_setopt($ch, CURLOPT_NOBODY, <span class="number">1</span>);</span><br><span class="line">        curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, <span class="number">3</span>);</span><br><span class="line">        curl_setopt($ch, CURLOPT_TIMEOUT, <span class="number">3</span>);</span><br><span class="line">        curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, <span class="keyword">false</span>);</span><br><span class="line">        curl_exec($ch);</span><br><span class="line">        $http_code = curl_getinfo($ch);</span><br><span class="line">        curl_close($ch);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ($http_code[<span class="string">'http_code'</span>] == <span class="number">200</span>) &#123;</span><br><span class="line">            $theImgType = explode(<span class="string">'/'</span>, $http_code[<span class="string">'content_type'</span>]);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> ($theImgType[<span class="number">0</span>] == <span class="string">'image'</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> $theImgType[<span class="number">1</span>];</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºçœŸå½©ç”»å¸ƒ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> int $width</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> int $height</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> int $r</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> int $g</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> int $b</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> false|resource</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">createTrueColor</span><span class="params">(int $width, int $height, $r = <span class="number">255</span>, $g = <span class="number">255</span>, $b = <span class="number">255</span>)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $im = imagecreatetruecolor($width, $height);</span><br><span class="line">        $color = imagecolorallocate($im, $r, $g, $b);</span><br><span class="line">        imagefill($im, <span class="number">0</span>, <span class="number">0</span>, $color);</span><br><span class="line">        <span class="keyword">return</span> $im;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºå›¾åƒç”»å¸ƒ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $im</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $imgUrl</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $dst_w</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $dst_h</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> bool|resource</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">createImgBoard</span><span class="params">($im, $imgUrl, $dst_x, $dst_y, $dst_w, $dst_h)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">list</span>($width, $height) = getimagesize($imgUrl);</span><br><span class="line">        $imgBoard = Poster::createImageFromFile($imgUrl);</span><br><span class="line">        imagecopyresized($im, $imgBoard, $dst_x, $dst_y, <span class="number">0</span>, <span class="number">0</span>, $dst_w, $dst_h, $width, $height);</span><br><span class="line">        <span class="keyword">return</span> $imgBoard;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $im</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">lookImg</span><span class="params">($im)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        header(<span class="string">"Content-type:text/html;charset=utf-8"</span>);</span><br><span class="line">        Header(<span class="string">"Content-Type: image/jpeg"</span>); <span class="comment">// jpeg ç”Ÿæˆä¼šæ›´å¿«ï¼Œpngç”Ÿæˆé€Ÿåº¦æ…¢ä½†æ˜¯é«˜æ¸…</span></span><br><span class="line">        imagejpeg($im);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="ä½¿ç”¨æ–¹æ³•"><a href="#ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ–¹æ³•"></a>ä½¿ç”¨æ–¹æ³•</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·å–å¾®ä¿¡äºŒç»´ç </span></span><br><span class="line">$codePath = Qrcode::createQrcode([</span><br><span class="line">    <span class="string">'scene'</span> =&gt; $scene,</span><br><span class="line">    <span class="string">'page'</span> =&gt; $path,</span><br><span class="line">    <span class="string">'width'</span> =&gt; <span class="string">'112'</span>,</span><br><span class="line">    <span class="string">'auto_color'</span> =&gt; <span class="keyword">false</span>,</span><br><span class="line">    <span class="string">'line_color'</span> =&gt; [</span><br><span class="line">        <span class="string">'r'</span> =&gt; <span class="number">0</span>,</span><br><span class="line">        <span class="string">'g'</span> =&gt; <span class="number">0</span>,</span><br><span class="line">        <span class="string">'b'</span> =&gt; <span class="number">0</span></span><br><span class="line">    ]</span><br><span class="line">]);</span><br><span class="line">$data = [</span><br><span class="line">    <span class="string">'bg'</span> =&gt; <span class="keyword">$this</span>-&gt;bg,</span><br><span class="line">    <span class="string">'goodsPath'</span> =&gt; $goodsPath,</span><br><span class="line">    <span class="string">'title'</span> =&gt; $goodsName,</span><br><span class="line">    <span class="string">'price'</span> =&gt; $goodsPrice,</span><br><span class="line">    <span class="string">'btn'</span> =&gt; <span class="keyword">$this</span>-&gt;btn,</span><br><span class="line">    <span class="string">'time'</span> =&gt; date(<span class="string">'Y-m-d H:i'</span>),</span><br><span class="line">    <span class="string">'qrcode'</span> =&gt; $codePath,</span><br><span class="line">    <span class="string">'headimg'</span> =&gt; $userInfo-&gt;headimgurl ? $userInfo-&gt;headimgurl : <span class="keyword">$this</span>-&gt;defaultHeadImg,</span><br><span class="line">    <span class="string">'nickname'</span> =&gt; $userInfo-&gt;nickname ? $userInfo-&gt;nickname : <span class="string">'ç‰¹æŠ±æŠ±'</span></span><br><span class="line">];</span><br><span class="line"><span class="keyword">$this</span>-&gt;createPoster($data);</span><br></pre></td></tr></table></figure><h4 id="æ•ˆæœå›¾"><a href="#æ•ˆæœå›¾" class="headerlink" title="æ•ˆæœå›¾"></a>æ•ˆæœå›¾</h4><div style="display: flex;justify-content: space-around;"><br>    <div style="display: inline-block;"><img src="/phpç”Ÿæˆæµ·æŠ¥å›¾å‡ºç°å›¾ç‰‡æŸåçš„é—®é¢˜/img/1.jpg" width="300"></div><div style="display: inline-block;"><img src="/phpç”Ÿæˆæµ·æŠ¥å›¾å‡ºç°å›¾ç‰‡æŸåçš„é—®é¢˜/img/2.jpg" width="300"></div><br></div><p>&emsp;ä»ä¸Šé¢ä¸¤ä¸ªå›¾å¾ˆæ˜æ˜¾å¯ä»¥çœ‹å‡ºï¼Œç¬¬äºŒå¼ å›¾ä¸‹é¢è¢«åˆ‡æ‰äº†ï¼Œè€Œä¸”ç”µè„‘æ˜¯æ‰“ä¸å¼€çš„ã€‚è§£å†³è¿™ä¸ªé—®é¢˜çš„å…³é”®åœ¨äº<code>ob_clean();ob_end_clean();</code>ä¸¤ä¸ªå‡½æ•°ã€‚</p><h4 id="è§£å†³æ–¹æ³•"><a href="#è§£å†³æ–¹æ³•" class="headerlink" title="è§£å†³æ–¹æ³•"></a>è§£å†³æ–¹æ³•</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ¸…ç©ºç¼“å†²åŒº</span></span><br><span class="line">ob_clean();</span><br><span class="line">ob_end_clean();</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;ç®€ä»‹&quot;&gt;&lt;a href=&quot;#ç®€ä»‹&quot; class=&quot;headerlink&quot; title=&quot;ç®€ä»‹&quot;&gt;&lt;/a&gt;ç®€ä»‹&lt;/h4&gt;&lt;p&gt;&amp;emsp;è¿‘å¹´å°ç¨‹åºã€å¾®ä¿¡å‘å±•è¿…é€Ÿã€‚å¾®ä¿¡ã€å¾®åšç—…æ¯’å¼ä¼ æ’­ä½¿ç”¨æˆ·ä»ä¼ ç»Ÿçš„APPä¸Šå‘&lt;code&gt;å³æ‰«å³ç”¨ã€æ— éœ€å®‰è£…&lt;/code&gt;çš„å°ç¨‹åºä¸Šè½¬åŒ–ã€‚è€Œå¾®ä¿¡å…¬ä¼—å·ã€å°ç¨‹åºçš„è¿…é€Ÿå‘å±•ç¦»ä¸å¼€è½¬å‘ã€äºŒç»´ç åˆ†äº«ã€‚&lt;/p&gt;
&lt;p&gt;&amp;emsp;ä½†æ˜¯äºŒç»´ç å½¢å¼å•ä¸€ï¼Œå¯¹ç”¨æˆ·æ¥è¯´æ¯«æ— å¸å¼•åŠ›ã€‚çº¯ç²¹ä¾é â€˜å†å–ã€é‡‘é’±ã€ç¤¼ç‰©å¸å¼•â€™æ–¹å¼å·²ç»å˜å¾—æ„ˆæ¥æ„ˆæ— ä»·å€¼ã€‚&lt;/p&gt;
&lt;p&gt;&amp;emsp;å¯¹äºâ€™è§†è§‰åŠ¨ç‰©â€™å’Œå¤§éƒ¨åˆ†ç”¨æˆ·æ¥è¯´ï¼Œç²¾ç¾çš„å›¾ç‰‡åŠ ä¸ŠäºŒç»´ç çš„ç»„åˆæ›´å…·æœ‰å¸å¼•åŠ›ã€‚&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="php" scheme="http://www.daichongweb.com/tags/php/"/>
    
  </entry>
  
  <entry>
    <title>å¾®ä¿¡å°ç¨‹åºæ”¯ä»˜</title>
    <link href="http://www.daichongweb.com/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%94%AF%E4%BB%98/"/>
    <id>http://www.daichongweb.com/å¾®ä¿¡å°ç¨‹åºæ”¯ä»˜/</id>
    <published>2020-05-10T06:57:38.000Z</published>
    <updated>2020-08-19T03:46:29.224Z</updated>
    
    <content type="html"><![CDATA[<h4 id="å°ç¨‹åºæ”¯ä»˜"><a href="#å°ç¨‹åºæ”¯ä»˜" class="headerlink" title="å°ç¨‹åºæ”¯ä»˜"></a>å°ç¨‹åºæ”¯ä»˜</h4><p>&emsp;ç°å¦‚ä»Šçš„å°ç¨‹åºæ„ˆå‘é‡è¦ï¼Œå¾®ä¿¡å°ç¨‹åºå¼€å‘ä¹Ÿæˆä¸ºå¼€å‘è€…å¿…é¡»æŒæ¡çš„é‡è¦çš„æŠ€èƒ½ä¹‹ä¸€ã€‚<br>&emsp;ç»è¿‡å¤šå¹´çš„å‘å±•ï¼Œå°ç¨‹åºå¼€å‘æ›´æ–°æ¢ä»£éå¸¸å¿«ï¼Œåœ¨æœ€è¿‘çš„å¼€å‘ä¸­å‘ç°ä¹‹å‰å°ç¨‹åºæ”¯ä»˜çš„å†™æ³•å·²ç»å®Œå…¨ä¸é€‚ç”¨äº†ï¼Œå®³å¾—æˆ‘ç ”ç©¶äº†å¾ˆä¹…ï¼Œç‰¹å†™ä¸€ç¯‡æ–‡ç« è®°å½•ä¸€ä¸‹ã€‚</p><h4 id="å¼€å‘å‰æ"><a href="#å¼€å‘å‰æ" class="headerlink" title="å¼€å‘å‰æ"></a>å¼€å‘å‰æ</h4><p>&emsp;ï¼ˆ1ï¼‰å¼€é€šå¾®ä¿¡æ”¯ä»˜å•†æˆ·å·ã€‚<br>&emsp;ï¼ˆ2ï¼‰å¼€é€šå°ç¨‹åºã€‚<br>&emsp;ï¼ˆ3ï¼‰å¾®ä¿¡æ”¯ä»˜å¹³å°è®¾ç½®ç‰¹çº¦å•†æˆ·APPID,ç»‘å®šå°ç¨‹åºAppidã€‚ï¼ˆè¿™é‡Œè¦æ³¨æ„ï¼Œå°ç¨‹åºå’Œæ”¯ä»˜å•†æˆ·å¿…é¡»æ˜¯åŒä¸€ä¸ªä¸»ä½“ï¼‰ã€‚<br>&emsp;ï¼ˆ4ï¼‰å°ç¨‹åºç»‘å®šå¾®ä¿¡æ”¯ä»˜å•†æˆ·å·ã€‚</p><a id="more"></a><h4 id="å…·ä½“å·®åˆ«"><a href="#å…·ä½“å·®åˆ«" class="headerlink" title="å…·ä½“å·®åˆ«"></a>å…·ä½“å·®åˆ«</h4><p>&emsp;å¯ä»¥ä»å¾ˆä¹…ä¹‹å‰çš„æ–‡ç« çœ‹å‡ºï¼Œç°åœ¨çš„å°ç¨‹åºæ”¯ä»˜å¤šäº†ä¸€ä¸ªäºŒæ¬¡ç­¾åçš„æ­¥éª¤ï¼Œè¿™ç‚¹éœ€è¦å¤§å®¶æ³¨æ„ã€‚<br>&emsp;å…¶ä»–çš„æ­¥éª¤å€’æ˜¯æ²¡ä»€ä¹ˆå·®åˆ«ï¼Œå…·ä½“å¯ <a href="https://pay.weixin.qq.com/wiki/doc/api/wxa/wxa_api.php?chapter=9_1" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p><h4 id="ä¸Šä»£ç ï¼ˆåºŸè¯ä¸å¤šè¯´ï¼Œyii2å†™æ³•ï¼‰"><a href="#ä¸Šä»£ç ï¼ˆåºŸè¯ä¸å¤šè¯´ï¼Œyii2å†™æ³•ï¼‰" class="headerlink" title="ä¸Šä»£ç ï¼ˆåºŸè¯ä¸å¤šè¯´ï¼Œyii2å†™æ³•ï¼‰"></a>ä¸Šä»£ç ï¼ˆåºŸè¯ä¸å¤šè¯´ï¼Œyii2å†™æ³•ï¼‰</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">actionIndex</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        $user_id = FsRequest::userId(<span class="string">'true'</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!$user_id) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="keyword">Exception</span>(<span class="string">'è¯·å…ˆç™»å½•'</span>, [], <span class="number">201</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $data = \Yii::$app-&gt;request-&gt;post();</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">empty</span>($data)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="keyword">Exception</span>(<span class="string">'å‚æ•°ä¸å…¨'</span>, [], <span class="number">201</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        $openId = WeixinUser::find()-&gt;where([<span class="string">'ecuid'</span> =&gt; $user_id])-&gt;select([<span class="string">'dingdang_mini'</span>])-&gt;one();</span><br><span class="line">        <span class="keyword">if</span> (!$openId) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="keyword">Exception</span>(<span class="string">'æœªç»‘å®šå°ç¨‹åº'</span>, [], <span class="number">201</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        $payParams = [</span><br><span class="line">            <span class="string">'appid'</span> =&gt; $appid,</span><br><span class="line">            <span class="string">'mch_id'</span> =&gt; $mch_id,</span><br><span class="line">            <span class="string">'nonce_str'</span> =&gt; WxHelper::createNoncestr(<span class="number">32</span>),</span><br><span class="line">            <span class="string">'sign'</span> =&gt; <span class="string">''</span>,</span><br><span class="line">            <span class="string">'body'</span> =&gt; $data[<span class="string">'body'</span>],</span><br><span class="line">            <span class="string">'out_trade_no'</span> =&gt; $data[<span class="string">'orderId'</span>],</span><br><span class="line">            <span class="string">'total_fee'</span> =&gt; (int)($data[<span class="string">'price'</span>] * <span class="number">100</span>),</span><br><span class="line">            <span class="string">'openid'</span> =&gt; $openId-&gt;dingdang_mini,</span><br><span class="line">            <span class="string">'spbill_create_ip'</span> =&gt; $_SERVER[<span class="string">'REMOTE_ADDR'</span>],</span><br><span class="line">            <span class="string">'notify_url'</span> =&gt; <span class="string">'æ”¯ä»˜å›è°ƒ'</span>,</span><br><span class="line">            <span class="string">'trade_type'</span> =&gt; <span class="string">'JSAPI'</span>,</span><br><span class="line">        ];</span><br><span class="line"></span><br><span class="line">        $payParams[<span class="string">'sign'</span>] = WxHelper::paySign($payParams, $key);</span><br><span class="line">        $xml = WxHelper::arrayToXml($payParams);</span><br><span class="line">        <span class="comment">// die($xml);</span></span><br><span class="line">        $payUrl = <span class="string">'https://api.mch.weixin.qq.com/pay/unifiedorder'</span>;</span><br><span class="line"></span><br><span class="line">        $curl = <span class="keyword">new</span> Curl();</span><br><span class="line">        $curl-&gt;setHeader(<span class="string">'Content-Type'</span>, <span class="string">'text/xml; charset=utf-8'</span>); <span class="comment">// xml</span></span><br><span class="line">        $curl-&gt;post($payUrl, $xml);</span><br><span class="line">        <span class="comment">// è¯·æ±‚å¤±è´¥</span></span><br><span class="line">        <span class="keyword">if</span> ($curl-&gt;error) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="keyword">Exception</span>($curl-&gt;errorMessage, [], <span class="number">201</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// å¾®ä¿¡è¿”å›é”™è¯¯</span></span><br><span class="line">            $result = WxHelper::xmlToArray($curl-&gt;response);</span><br><span class="line">            <span class="keyword">if</span> ($result[<span class="string">'result_code'</span>] == <span class="string">'FAIL'</span>) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="keyword">Exception</span>($result[<span class="string">'err_code_des'</span>], [], <span class="number">201</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// äºŒæ¬¡ç­¾å</span></span><br><span class="line">            $payParamsResult = [</span><br><span class="line">                <span class="string">'appId'</span> =&gt; <span class="keyword">$this</span>-&gt;appid,</span><br><span class="line">                <span class="string">'nonceStr'</span> =&gt; WxHelper::createNoncestr(<span class="number">32</span>),</span><br><span class="line">                <span class="string">'package'</span> =&gt; <span class="string">'prepay_id='</span> . $result[<span class="string">'prepay_id'</span>],</span><br><span class="line">                <span class="string">'paySign'</span> =&gt; <span class="string">''</span>,</span><br><span class="line">                <span class="string">'signType'</span> =&gt; <span class="string">'MD5'</span>,</span><br><span class="line">                <span class="string">'timeStamp'</span> =&gt; (string)time()</span><br><span class="line">            ];</span><br><span class="line">            $payParamsResult[<span class="string">'paySign'</span>] = WxHelper::paySign($payParamsResult, <span class="keyword">$this</span>-&gt;key);</span><br><span class="line">            FsResponse::jsonSuccess($payParamsResult);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (<span class="keyword">Exception</span> $e) &#123;</span><br><span class="line">        <span class="keyword">return</span> FsResponse::jsonFaild($e-&gt;getCode(), $e-&gt;getMessage());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// å…·ä½“æ–¹æ³•</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">library</span>\<span class="title">wechat</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> \<span class="title">Curl</span>\<span class="title">Curl</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">app</span>\<span class="title">models</span>\<span class="title">redis</span>\<span class="title">WxAccessToken</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">yii</span>\<span class="title">db</span>\<span class="title">Exception</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Class WxHelper</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@package</span> app\library</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WxHelper</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">// è·å–å°ç¨‹åºAccessToken</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getToken</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $token = WxAccessToken::get();</span><br><span class="line">        <span class="keyword">if</span> (!$token) &#123;</span><br><span class="line">            $url = <span class="string">'https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&amp;appid='</span> . $appId . <span class="string">'&amp;secret='</span> . $secret;</span><br><span class="line">            $curl = <span class="keyword">new</span> Curl();</span><br><span class="line">            $curl-&gt;get($url);</span><br><span class="line">            <span class="keyword">if</span> ($curl-&gt;error) &#123;</span><br><span class="line">                WxAccessToken::delete();</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="keyword">Exception</span>($curl-&gt;errorMessage, [],<span class="number">210</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">isset</span>($curl-&gt;response-&gt;errcode)) &#123;</span><br><span class="line">                WxAccessToken::delete();</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="keyword">Exception</span>($curl-&gt;response-&gt;errmsg,[],<span class="number">210</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            $token = $curl-&gt;response-&gt;access_token;</span><br><span class="line">            $time = $curl-&gt;response-&gt;expires_in;</span><br><span class="line">            WxAccessToken::set($token, $time - <span class="number">100</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> $token;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">xmlToArray</span><span class="params">($xml)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">//ç¦æ­¢å¼•ç”¨å¤–éƒ¨xmlå®ä½“</span></span><br><span class="line">        libxml_disable_entity_loader(<span class="keyword">true</span>);</span><br><span class="line">        $values = json_decode(json_encode(simplexml_load_string($xml, <span class="string">'SimpleXMLElement'</span>, LIBXML_NOCDATA)), <span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">return</span> $values;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">paySign</span><span class="params">($payParams, $key)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        ksort($payParams);</span><br><span class="line">        $signString = <span class="keyword">self</span>::toUrlParams($payParams);</span><br><span class="line">        $signString .= <span class="string">'&amp;key='</span> . $key;</span><br><span class="line">        $signString = strtoupper(md5($signString));</span><br><span class="line">        <span class="keyword">return</span> $signString;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">#ç”Ÿæˆéšæœºå­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">createNoncestr</span><span class="params">($length = <span class="number">7</span>)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $chars = <span class="string">"abcdefghijklmnopqrstuvwxyzABCDEFGHIGKLMNOPQRSTUVWXYZ0123456789"</span>;</span><br><span class="line">        $str = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; $length; $i++) &#123;</span><br><span class="line">            $str .= substr($chars, mt_rand(<span class="number">0</span>, strlen($chars) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> $str;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">toUrlParams</span><span class="params">($payParams)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $buff = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">foreach</span> ($payParams <span class="keyword">as</span> $k =&gt; $v) &#123;</span><br><span class="line">            <span class="keyword">if</span> ($k != <span class="string">"sign"</span> &amp;&amp; $v != <span class="string">""</span> &amp;&amp; !is_array($v)) &#123;</span><br><span class="line">                $buff .= $k . <span class="string">"="</span> . $v . <span class="string">"&amp;"</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $buff = trim($buff, <span class="string">"&amp;"</span>);</span><br><span class="line">        <span class="keyword">return</span> $buff;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">arrayToXml</span><span class="params">($array)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $xml = <span class="string">"&lt;xml&gt;"</span>;</span><br><span class="line">        <span class="keyword">foreach</span> ($array <span class="keyword">as</span> $key =&gt; $val) &#123;</span><br><span class="line">            <span class="keyword">if</span> (is_numeric($val)) &#123;</span><br><span class="line">                $xml .= <span class="string">"&lt;"</span> . $key . <span class="string">"&gt;"</span> . $val . <span class="string">"&lt;/"</span> . $key . <span class="string">"&gt;"</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $xml .= <span class="string">"&lt;"</span> . $key . <span class="string">"&gt;&lt;![CDATA["</span> . $val . <span class="string">"]]&gt;&lt;/"</span> . $key . <span class="string">"&gt;"</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        $xml .= <span class="string">"&lt;/xml&gt;"</span>;</span><br><span class="line">        <span class="keyword">return</span> $xml;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>&emsp;å¾®ä¿¡æ”¯ä»˜æ¯”è¾ƒç®€å•ï¼Œåªæ˜¯æ–‡æ¡£å†™çš„ä¸æ¸…æ™°å¯¼è‡´å¼€å‘éš¾åº¦å¢åŠ ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;å°ç¨‹åºæ”¯ä»˜&quot;&gt;&lt;a href=&quot;#å°ç¨‹åºæ”¯ä»˜&quot; class=&quot;headerlink&quot; title=&quot;å°ç¨‹åºæ”¯ä»˜&quot;&gt;&lt;/a&gt;å°ç¨‹åºæ”¯ä»˜&lt;/h4&gt;&lt;p&gt;&amp;emsp;ç°å¦‚ä»Šçš„å°ç¨‹åºæ„ˆå‘é‡è¦ï¼Œå¾®ä¿¡å°ç¨‹åºå¼€å‘ä¹Ÿæˆä¸ºå¼€å‘è€…å¿…é¡»æŒæ¡çš„é‡è¦çš„æŠ€èƒ½ä¹‹ä¸€ã€‚&lt;br&gt;&amp;emsp;ç»è¿‡å¤šå¹´çš„å‘å±•ï¼Œå°ç¨‹åºå¼€å‘æ›´æ–°æ¢ä»£éå¸¸å¿«ï¼Œåœ¨æœ€è¿‘çš„å¼€å‘ä¸­å‘ç°ä¹‹å‰å°ç¨‹åºæ”¯ä»˜çš„å†™æ³•å·²ç»å®Œå…¨ä¸é€‚ç”¨äº†ï¼Œå®³å¾—æˆ‘ç ”ç©¶äº†å¾ˆä¹…ï¼Œç‰¹å†™ä¸€ç¯‡æ–‡ç« è®°å½•ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;h4 id=&quot;å¼€å‘å‰æ&quot;&gt;&lt;a href=&quot;#å¼€å‘å‰æ&quot; class=&quot;headerlink&quot; title=&quot;å¼€å‘å‰æ&quot;&gt;&lt;/a&gt;å¼€å‘å‰æ&lt;/h4&gt;&lt;p&gt;&amp;emsp;ï¼ˆ1ï¼‰å¼€é€šå¾®ä¿¡æ”¯ä»˜å•†æˆ·å·ã€‚&lt;br&gt;&amp;emsp;ï¼ˆ2ï¼‰å¼€é€šå°ç¨‹åºã€‚&lt;br&gt;&amp;emsp;ï¼ˆ3ï¼‰å¾®ä¿¡æ”¯ä»˜å¹³å°è®¾ç½®ç‰¹çº¦å•†æˆ·APPID,ç»‘å®šå°ç¨‹åºAppidã€‚ï¼ˆè¿™é‡Œè¦æ³¨æ„ï¼Œå°ç¨‹åºå’Œæ”¯ä»˜å•†æˆ·å¿…é¡»æ˜¯åŒä¸€ä¸ªä¸»ä½“ï¼‰ã€‚&lt;br&gt;&amp;emsp;ï¼ˆ4ï¼‰å°ç¨‹åºç»‘å®šå¾®ä¿¡æ”¯ä»˜å•†æˆ·å·ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="å°ç¨‹åºæ”¯ä»˜" scheme="http://www.daichongweb.com/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%94%AF%E4%BB%98/"/>
    
  </entry>
  
  <entry>
    <title>phpOffice/phpSpreadsheetå¯¼å‡ºexcel</title>
    <link href="http://www.daichongweb.com/phpOffice-phpSpreadsheet%E5%AF%BC%E5%87%BAexcel/"/>
    <id>http://www.daichongweb.com/phpOffice-phpSpreadsheetå¯¼å‡ºexcel/</id>
    <published>2020-04-10T01:46:38.000Z</published>
    <updated>2020-08-19T03:46:29.197Z</updated>
    
    <content type="html"><![CDATA[<h4 id="åˆè¯†phpSpreadsheet"><a href="#åˆè¯†phpSpreadsheet" class="headerlink" title="åˆè¯†phpSpreadsheet"></a>åˆè¯†phpSpreadsheet</h4><p>&emsp;PHPSpreadsheetæ˜¯ç”±è€å¤–ä½¿ç”¨çº¯PHPç¼–å†™çš„Excelæ–‡ä»¶å¤„ç†æ‰©å±•ï¼Œä»–ä½¿ç”¨çš„æ˜¯æœ€æ–°å†™æ³•ï¼Œç›¸æ¯”PHPExcel(å·²ä¸å†ç»´æŠ¤)æ€§èƒ½æå‡å·¨å¤§ï¼Œä½¿ç”¨æ–¹æ³•å’Œå‡½æ•°åŸºæœ¬ç›¸åŒï¼Œå¯ä»¥å®Œå…¨çš„æ›¿ä»£PHPExcelã€‚ä½¿ç”¨PhpSpreadsheetå¯ä»¥è½»æ¾è¯»å–å’Œå†™å…¥Excelæ–‡æ¡£ï¼Œæ”¯æŒExcelçš„æ‰€æœ‰æ“ä½œã€‚</p><h5 id="è½¯ä»¶ä¾èµ–"><a href="#è½¯ä»¶ä¾èµ–" class="headerlink" title="è½¯ä»¶ä¾èµ–"></a>è½¯ä»¶ä¾èµ–</h5><ul><li>PHP5.6æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œæ¨èPHP7</li><li>php_zipæ‰©å±•</li><li>php_gd2æ‰©å±•<a id="more"></a></li></ul><h5 id="PHPSpreadsheet-ç‰¹æ€§"><a href="#PHPSpreadsheet-ç‰¹æ€§" class="headerlink" title="PHPSpreadsheet ç‰¹æ€§"></a>PHPSpreadsheet ç‰¹æ€§</h5><ul><li><p>æ”¯æŒå¯¼å…¥å’Œå¯¼å‡º.xlsï¼Œ.xlsxï¼Œ.htmlï¼Œ.csvï¼Œ.pdfç­‰æ ¼å¼æ–‡ä»¶ã€‚</p></li><li><p>æä¾›ä¸°å¯Œçš„APIï¼Œæä¾›å•å…ƒæ ¼æ ·å¼è®¾ç½®ã€Excelè¡¨æ ¼å±æ€§è®¾ç½®ã€å›¾è¡¨è®¾ç½®ç­‰ç­‰è¯¸å¤šåŠŸèƒ½ã€‚ä½¿ç”¨PhpSpreadsheetå®Œå…¨å¯ä»¥ç”Ÿæˆä¸€ä¸ªå¤–è§‚ç»“æ„éƒ½æ»¡è¶³ä½ çš„Excelè¡¨æ ¼æ–‡ä»¶ã€‚</p></li><li><p>å“è¶Šçš„æ€§èƒ½ï¼Œå°¤å…¶åœ¨PHP7ä¸Šè¡¨ç°ä¼˜å¼‚ï¼Œæ¯”PHPExcelå¼ºå¤§å¾ˆå¤šã€‚</p></li></ul><h5 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer <span class="keyword">require</span> phpoffice/phpspreadsheet</span><br></pre></td></tr></table></figure><h4 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h4><p>&emsp;ä¸‹é¢å’±ä»¬æ¥åšä¸€ä¸ªé€šç”¨çš„å¯¼å‡ºExcelè¡¨æ ¼ç±»ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">common</span>\<span class="title">library</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">app</span>\<span class="title">common</span>\<span class="title">exception</span>\<span class="title">BusiException</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpOffice</span>\<span class="title">PhpSpreadsheet</span>\<span class="title">IOFactory</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpOffice</span>\<span class="title">PhpSpreadsheet</span>\<span class="title">Spreadsheet</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¯¼å‡ºexcel class</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> daichongweb</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Export</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">// è¡¨æ ¼åæ ‡</span></span><br><span class="line">    <span class="keyword">private</span> $cellIndex = [<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'D'</span>, <span class="string">'E'</span>, <span class="string">'F'</span>, <span class="string">'G'</span>, <span class="string">'H'</span>, <span class="string">'I'</span>, <span class="string">'J'</span>, <span class="string">'K'</span>, <span class="string">'L'</span>, <span class="string">'M'</span>, <span class="string">'N'</span>, <span class="string">'O'</span>, <span class="string">'P'</span>, <span class="string">'Q'</span>, <span class="string">'R'</span>, <span class="string">'S'</span>, <span class="string">'T'</span>, <span class="string">'U'</span>, <span class="string">'V'</span>, <span class="string">'W'</span>, <span class="string">'X'</span>, <span class="string">'Y'</span>, <span class="string">'Z'</span>, <span class="string">'AA'</span>, <span class="string">'AB'</span>, <span class="string">'AC'</span>, <span class="string">'AD'</span>, <span class="string">'AE'</span>, <span class="string">'AF'</span>, <span class="string">'AG'</span>, <span class="string">'AH'</span>, <span class="string">'AI'</span>, <span class="string">'AJ'</span>, <span class="string">'AK'</span>, <span class="string">'AL'</span>, <span class="string">'AM'</span>, <span class="string">'AN'</span>, <span class="string">'AO'</span>, <span class="string">'AP'</span>, <span class="string">'AQ'</span>, <span class="string">'AR'</span>, <span class="string">'AS'</span>, <span class="string">'AT'</span>, <span class="string">'AU'</span>, <span class="string">'AV'</span>, <span class="string">'AW'</span>, <span class="string">'AX'</span>, <span class="string">'AY'</span>, <span class="string">'AZ'</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é»˜è®¤é…ç½®</span></span><br><span class="line">    <span class="keyword">public</span> $config = [</span><br><span class="line">        <span class="string">'bold'</span> =&gt; <span class="keyword">true</span>, <span class="comment">// åŠ ç²—</span></span><br><span class="line">        <span class="string">'size'</span> =&gt; <span class="number">12</span>, <span class="comment">// æ–‡å­—å¤§å°</span></span><br><span class="line">        <span class="string">'column'</span> =&gt; <span class="number">4</span>, <span class="comment">// è®¾ç½®åˆ—æ•°</span></span><br><span class="line">        <span class="string">'title'</span> =&gt; <span class="string">'é»˜è®¤å¯¼å‡º'</span>, <span class="comment">// è¡¨æ ¼æ ‡é¢˜</span></span><br><span class="line">        <span class="string">'name'</span> =&gt; <span class="string">'ç‰¹æŠ±æŠ±'</span>, <span class="comment">// æ–‡ä»¶å</span></span><br><span class="line">        <span class="string">'type'</span> =&gt; <span class="string">'Xls'</span>, <span class="comment">// å¯¼å‡ºæ ¼å¼</span></span><br><span class="line">    ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é»˜è®¤è¡¨å¤´</span></span><br><span class="line">    <span class="keyword">public</span> $tableHeader = [</span><br><span class="line">        <span class="string">'php'</span>,</span><br><span class="line">        <span class="string">'vue'</span>,</span><br><span class="line">        <span class="string">'java'</span>,</span><br><span class="line">        <span class="string">'go'</span>,</span><br><span class="line">    ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é»˜è®¤æ•°æ®</span></span><br><span class="line">    <span class="keyword">public</span> $tableDefaultData = [</span><br><span class="line">        [</span><br><span class="line">            <span class="string">'å¤©ä¸‹ç¬¬ä¸€'</span>,</span><br><span class="line">            <span class="string">'Vueç‰›é€¼'</span>,</span><br><span class="line">            <span class="string">'javaç‰›é€¼'</span>,</span><br><span class="line">            <span class="string">'goç‰›é€¼'</span>,</span><br><span class="line">        ],</span><br><span class="line">    ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> array $tableHeader è¡¨å¤´</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> array $tableDefaultData éœ€è¦å¯¼å‡ºæ•°æ®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($tableHeader, $tableDefaultData)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">empty</span>($tableHeader)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> BusiException(<span class="string">'export error'</span>, <span class="string">'è¯·è®¾ç½®è¡¨å¤´'</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">empty</span>($tableDefaultData)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> BusiException(<span class="string">'export error'</span>, <span class="string">'è¯·è®¾ç½®å¯¼å‡ºæ•°æ®'</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">$this</span>-&gt;tableHeader = $tableHeader;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;config[<span class="string">'column'</span>] = count($tableHeader);</span><br><span class="line">        <span class="keyword">$this</span>-&gt;tableDefaultData = $tableDefaultData;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºè¡¨æ ¼ createTable</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">createTable</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $spreadsheet = <span class="keyword">new</span> Spreadsheet();</span><br><span class="line">        $worksheet = $spreadsheet-&gt;getActiveSheet();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å±…ä¸­</span></span><br><span class="line">        $styleArray = [</span><br><span class="line">            <span class="string">'alignment'</span> =&gt; [</span><br><span class="line">                <span class="string">'horizontal'</span> =&gt; \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER,</span><br><span class="line">            ],</span><br><span class="line">        ];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è®¾ç½®åŸºæœ¬å±æ€§</span></span><br><span class="line">        $worksheet-&gt;setTitle(<span class="keyword">$this</span>-&gt;config[<span class="string">'title'</span>]);</span><br><span class="line">        $worksheet-&gt;getStyle(<span class="keyword">$this</span>-&gt;getColumn())-&gt;applyFromArray($styleArray)</span><br><span class="line">            -&gt;getFont()</span><br><span class="line">            -&gt;setBold(<span class="keyword">$this</span>-&gt;config[<span class="string">'bold'</span>])</span><br><span class="line">            -&gt;setName(<span class="string">'Verdana'</span>)</span><br><span class="line">            -&gt;setSize(<span class="keyword">$this</span>-&gt;config[<span class="string">'size'</span>]);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">$this</span>-&gt;tableHeader <span class="keyword">as</span> $index =&gt; $name) &#123;</span><br><span class="line">            $worksheet-&gt;setCellValue(<span class="keyword">$this</span>-&gt;cellIndex[$index] . <span class="string">'1'</span>, $name);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $baseRow = <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">$this</span>-&gt;tableDefaultData <span class="keyword">as</span> $index =&gt; $data) &#123;</span><br><span class="line">            $i = $index + $baseRow;</span><br><span class="line">            <span class="keyword">for</span> ($k = <span class="number">0</span>; $k &lt;= <span class="keyword">$this</span>-&gt;config[<span class="string">'column'</span>] - <span class="number">1</span>; $k++) &#123;</span><br><span class="line">                $item = $data[$k];</span><br><span class="line">                $worksheet-&gt;setCellValue(<span class="keyword">$this</span>-&gt;cellIndex[$k] . $i, <span class="string">' '</span> . $item);</span><br><span class="line">                <span class="comment">// ä¸­æ–‡è®¾ç½®è¡¨æ ¼å®½åº¦</span></span><br><span class="line">                <span class="keyword">if</span> (preg_match(<span class="string">"/[\x7f-\xff]/"</span>, $data[$k])) &#123;</span><br><span class="line">                    $worksheet-&gt;getColumnDimension(<span class="keyword">$this</span>-&gt;cellIndex[$k])-&gt;setWidth(strlen($item));</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">// éä¸­æ–‡è‡ªåŠ¨è®¾ç½®å®½åº¦</span></span><br><span class="line">                    $worksheet-&gt;getColumnDimension(<span class="keyword">$this</span>-&gt;cellIndex[$k])-&gt;setAutoSize(<span class="keyword">true</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        $worksheet-&gt;calculateColumnWidths();</span><br><span class="line">        <span class="keyword">self</span>::downloadExcel($spreadsheet, <span class="keyword">$this</span>-&gt;config[<span class="string">'name'</span>], <span class="string">'Xls'</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–‡ä»¶ä¸‹è½½ downloadExcel</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> data $spreadsheet</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> string $filename</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> string $format</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> void</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">downloadExcel</span><span class="params">($spreadsheet, $filename, $format)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// $formatåªèƒ½ä¸º Xlsx æˆ– Xls</span></span><br><span class="line">        <span class="keyword">if</span> ($format == <span class="string">'Xlsx'</span>) &#123;</span><br><span class="line">            header(<span class="string">'Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'</span>);</span><br><span class="line">        &#125; <span class="keyword">elseif</span> ($format == <span class="string">'Xls'</span>) &#123;</span><br><span class="line">            header(<span class="string">'Content-Type: application/vnd.ms-excel'</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        header(<span class="string">"Content-Disposition: attachment;filename="</span></span><br><span class="line">            . urlencode($filename) . <span class="string">'.'</span> . strtolower($format)); <span class="comment">//. date('Y-m-d')</span></span><br><span class="line">        header(<span class="string">'Cache-Control: max-age=0'</span>);</span><br><span class="line">        $objWriter = IOFactory::createWriter($spreadsheet, $format);</span><br><span class="line">        $objWriter-&gt;save(<span class="string">'php://output'</span>);</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">getColumn</span><span class="params">($row = <span class="number">1</span>)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $index = <span class="keyword">$this</span>-&gt;cellIndex[<span class="keyword">$this</span>-&gt;config[<span class="string">'column'</span>]];</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'A'</span> . $row . <span class="string">':'</span> . $index . $row;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">autoFitColumnWidthToContent</span><span class="params">($sheet, $fromCol, $toCol)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">empty</span>($toCol)) &#123; <span class="comment">//not defined the last column, set it the max one</span></span><br><span class="line">            $toCol = $sheet-&gt;getColumnDimension($sheet-&gt;getHighestColumn())-&gt;getColumnIndex();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> ($i = $fromCol; $i &lt;= $toCol; $i++) &#123;</span><br><span class="line">            $sheet-&gt;getColumnDimension($i)-&gt;setAutoSize(<span class="keyword">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        $sheet-&gt;calculateColumnWidths();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="ä½¿ç”¨æ–¹æ³•"><a href="#ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ–¹æ³•"></a>ä½¿ç”¨æ–¹æ³•</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">use</span> <span class="title">helper</span>\<span class="title">Export</span>;</span><br><span class="line">...</span><br><span class="line"><span class="comment">// è®¾ç½®è¡¨å¤´</span></span><br><span class="line">$export = <span class="keyword">new</span> Export(</span><br><span class="line">    [</span><br><span class="line">        <span class="string">'æµ‹è¯•æ ‡é¢˜'</span>,</span><br><span class="line">        <span class="string">'æµ‹è¯•æ ‡é¢˜2'</span>,</span><br><span class="line">        <span class="string">'æ—¶é—´'</span>,</span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        [<span class="string">'11111111111111'</span>, <span class="string">'æµ‹è¯•æ•°æ®2'</span>, <span class="string">'2020-04-30'</span>],</span><br><span class="line">        [<span class="string">'æµ‹è¯•æ•°æ®1-1'</span>, <span class="string">'æµ‹è¯•æ•°æ®2-2'</span>, <span class="string">'2020-04-30'</span>],</span><br><span class="line">    ]</span><br><span class="line">);</span><br><span class="line"><span class="keyword">echo</span> $export-&gt;createTable();</span><br><span class="line"><span class="keyword">exit</span>;</span><br></pre></td></tr></table></figure><h4 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h4><img src="/phpOffice-phpSpreadsheetå¯¼å‡ºexcel/img/3.gif">]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;åˆè¯†phpSpreadsheet&quot;&gt;&lt;a href=&quot;#åˆè¯†phpSpreadsheet&quot; class=&quot;headerlink&quot; title=&quot;åˆè¯†phpSpreadsheet&quot;&gt;&lt;/a&gt;åˆè¯†phpSpreadsheet&lt;/h4&gt;&lt;p&gt;&amp;emsp;PHPSpreadsheetæ˜¯ç”±è€å¤–ä½¿ç”¨çº¯PHPç¼–å†™çš„Excelæ–‡ä»¶å¤„ç†æ‰©å±•ï¼Œä»–ä½¿ç”¨çš„æ˜¯æœ€æ–°å†™æ³•ï¼Œç›¸æ¯”PHPExcel(å·²ä¸å†ç»´æŠ¤)æ€§èƒ½æå‡å·¨å¤§ï¼Œä½¿ç”¨æ–¹æ³•å’Œå‡½æ•°åŸºæœ¬ç›¸åŒï¼Œå¯ä»¥å®Œå…¨çš„æ›¿ä»£PHPExcelã€‚ä½¿ç”¨PhpSpreadsheetå¯ä»¥è½»æ¾è¯»å–å’Œå†™å…¥Excelæ–‡æ¡£ï¼Œæ”¯æŒExcelçš„æ‰€æœ‰æ“ä½œã€‚&lt;/p&gt;
&lt;h5 id=&quot;è½¯ä»¶ä¾èµ–&quot;&gt;&lt;a href=&quot;#è½¯ä»¶ä¾èµ–&quot; class=&quot;headerlink&quot; title=&quot;è½¯ä»¶ä¾èµ–&quot;&gt;&lt;/a&gt;è½¯ä»¶ä¾èµ–&lt;/h5&gt;&lt;ul&gt;
&lt;li&gt;PHP5.6æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œæ¨èPHP7&lt;/li&gt;
&lt;li&gt;php_zipæ‰©å±•&lt;/li&gt;
&lt;li&gt;php_gd2æ‰©å±•&lt;/li&gt;&lt;/ul&gt;
    
    </summary>
    
    
      <category term="phpæ‰©å±•ç±»" scheme="http://www.daichongweb.com/tags/php%E6%89%A9%E5%B1%95%E7%B1%BB/"/>
    
  </entry>
  
  <entry>
    <title>nginxè´Ÿè½½å‡è¡¡çš„å®ç°</title>
    <link href="http://www.daichongweb.com/nginx%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%9A%84%E5%AE%9E%E7%8E%B0/"/>
    <id>http://www.daichongweb.com/nginxè´Ÿè½½å‡è¡¡çš„å®ç°/</id>
    <published>2020-03-25T07:50:50.000Z</published>
    <updated>2020-08-19T03:46:29.188Z</updated>
    
    <content type="html"><![CDATA[<h4 id="è´Ÿè½½å‡è¡¡æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#è´Ÿè½½å‡è¡¡æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="è´Ÿè½½å‡è¡¡æ˜¯ä»€ä¹ˆï¼Ÿ"></a>è´Ÿè½½å‡è¡¡æ˜¯ä»€ä¹ˆï¼Ÿ</h4><p>&emsp;è´Ÿè½½å‡è¡¡å»ºç«‹åœ¨ç°æœ‰ç½‘ç»œç»“æ„ä¹‹ä¸Šï¼Œå®ƒæä¾›äº†ä¸€ç§å»‰ä»·æœ‰æ•ˆé€æ˜çš„æ–¹æ³•æ‰©å±•ç½‘ç»œè®¾å¤‡å’ŒæœåŠ¡å™¨çš„å¸¦å®½ã€å¢åŠ ååé‡ã€åŠ å¼ºç½‘ç»œæ•°æ®å¤„ç†èƒ½åŠ›ã€æé«˜ç½‘ç»œçš„çµæ´»æ€§å’Œå¯ç”¨æ€§ã€‚</p><p>&emsp;è´Ÿè½½å‡è¡¡ï¼ˆLoad Balanceï¼‰å…¶æ„æ€å°±æ˜¯åˆ†æ‘Šåˆ°å¤šä¸ªæ“ä½œå•å…ƒä¸Šè¿›è¡Œæ‰§è¡Œï¼Œä¾‹å¦‚WebæœåŠ¡å™¨ã€FTPæœåŠ¡å™¨ã€ä¼ä¸šå…³é”®åº”ç”¨æœåŠ¡å™¨å’Œå…¶å®ƒå…³é”®ä»»åŠ¡æœåŠ¡å™¨ç­‰ï¼Œä»è€Œå…±åŒå®Œæˆå·¥ä½œä»»åŠ¡ã€‚</p><h4 id="ä¸ºä»€ä¹ˆè¦åšè´Ÿè½½å‡è¡¡"><a href="#ä¸ºä»€ä¹ˆè¦åšè´Ÿè½½å‡è¡¡" class="headerlink" title="ä¸ºä»€ä¹ˆè¦åšè´Ÿè½½å‡è¡¡"></a>ä¸ºä»€ä¹ˆè¦åšè´Ÿè½½å‡è¡¡</h4><ul><li>æœåŠ¡å™¨æ€»æ˜¯å´©æºƒæ€ä¹ˆåŠï¼Ÿ</li><li>ä¸€å°æœåŠ¡å™¨æ‰›ä¸ä½å¤§é‡çš„å¹¶å‘æ€ä¹ˆåŠï¼Ÿ</li><li>â€¦â€¦</li></ul><p> &nbsp;æœ‰äº†è¿™äº›é—®é¢˜ï¼Œæˆ‘ç›¸ä¿¡ä½ ä¸€å®šä¼šç”¨å¾—åˆ°è¿™ä¸ªæŠ€æœ¯ã€‚æœ€è®©äººé«˜å…´çš„ä¸€ç‚¹æ˜¯ï¼šåªéœ€è¦ä½ æ‡‚ç‚¹nginxçš„é…ç½®å°±èƒ½å®Œç¾çš„é©¾é©­è´Ÿè½½å‡è¡¡çš„é…ç½®ï¼Œè‡³äºé…ç½®ä¹‹åå¯èƒ½å‡ºç°çš„é—®é¢˜ï¼Œå†æ…¢æ…¢å»ç ”ç©¶ä¹Ÿä¸è¿Ÿã€‚<br><a id="more"></a></p><h4 id="æ¶æ„å›¾"><a href="#æ¶æ„å›¾" class="headerlink" title="æ¶æ„å›¾"></a>æ¶æ„å›¾</h4><img src="/nginxè´Ÿè½½å‡è¡¡çš„å®ç°/img/1.png"><p>&emsp;ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬åˆ©ç”¨è´Ÿè½½å‡è¡¡å¯ä»¥å¾ˆå¥½çš„åº”å¯¹å¹¶å‘è¯·æ±‚è¿‡é«˜çš„æƒ…å†µï¼Œä½¿æ¯ä¸€å°æœåŠ¡å™¨å‘æŒ¥æœ€å¤§çš„æ•ˆç”¨ã€‚</p><h4 id="è´Ÿè½½å‡è¡¡çš„å®ç°æ–¹å¼"><a href="#è´Ÿè½½å‡è¡¡çš„å®ç°æ–¹å¼" class="headerlink" title="è´Ÿè½½å‡è¡¡çš„å®ç°æ–¹å¼"></a>è´Ÿè½½å‡è¡¡çš„å®ç°æ–¹å¼</h4><ul><li><p>è½®è¯¢(rr) ï¼šæŒ‰æ—¶é—´é¡ºåºé€ä¸€åˆ†é…åˆ°ä¸åŒçš„åç«¯æœåŠ¡å™¨(é»˜è®¤);</p></li><li><p>æƒé‡(weight)ï¼šåŠ æƒè½®è¯¢(wrr)ã€‚weightå€¼è¶Šå¤§ï¼Œåˆ†é…åˆ°çš„è®¿é—®ç‡è¶Šé«˜;</p></li><li><p>æºIPåœ°å€hashè°ƒåº¦æ–¹æ³•(ip_hash):å°†æ¯ä¸ªè¯·æ±‚æŒ‰è®¿é—®IPçš„hashå€¼æ¥åˆ†é…ï¼Œæ¥è‡ªåŒä¸€ä¸ªIPå›ºå®šè®¿é—®ä¸€ä¸ªåç«¯æœåŠ¡å™¨;</p></li><li><p>æœ€å°‘è¿æ¥æ•°(least_conn)ï¼šå½“serveræ‹¥æœ‰ä¸åŒçš„æƒé‡æ—¶ä¸ºwlcï¼Œå½“æ‰€æœ‰åç«¯ä¸»æœºï¼›è¿æ¥æ•°ç›¸åŒæ—¶ï¼Œåˆ™ä½¿ç”¨wrrï¼Œé€‚ç”¨äºé•¿è¿æ¥(keepalive_timeoutä¸ä¸º0);</p></li></ul><h4 id="å®æˆ˜é…ç½®"><a href="#å®æˆ˜é…ç½®" class="headerlink" title="å®æˆ˜é…ç½®"></a>å®æˆ˜é…ç½®</h4><p>&emsp;å‡†å¤‡ä¸‰å°æœåŠ¡å™¨ï¼šï¼ˆ1ï¼‰192.168.133.128ï¼ˆè°ƒåº¦å™¨ï¼‰ï¼ˆ2ï¼‰192.168.133.129ï¼ˆæœåŠ¡å™¨1ï¼‰ï¼ˆ3ï¼‰192.168.133.130ï¼ˆæœåŠ¡å™¨2ï¼‰<br>&emsp;åœ¨è°ƒåº¦æœåŠ¡å™¨ä¸­é…ç½®ï¼š<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">upstream 192.168.133.128&#123;</span><br><span class="line">    server 192.168.133.129:80 weight=1;</span><br><span class="line">    server 192.168.133.130:80 weight=1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">    listen       80;</span><br><span class="line">    server_name  localhost;</span><br><span class="line"></span><br><span class="line">    <span class="comment">#charset koi8-r;</span></span><br><span class="line">    <span class="comment">#access_log  /var/log/nginx/host.access.log  main;</span></span><br><span class="line"></span><br><span class="line">    client_max_body_size 50m;</span><br><span class="line">    client_body_buffer_size 256k;</span><br><span class="line"></span><br><span class="line">   location / &#123;</span><br><span class="line">       proxy_pass        http://192.168.133.128;</span><br><span class="line">       proxy_set_header X-Forwarded-For <span class="variable">$remote_addr</span>;</span><br><span class="line">       proxy_set_header Host <span class="variable">$host</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><p>&emsp;å…¶ä»–æœåŠ¡å™¨server_nameéƒ½é…ç½®æˆè‡ªå·±çš„IPå°±è¡Œã€‚åœ¨å„è‡ªçš„æœåŠ¡Htmlé‡Œå‘½åï¼ŒåŠ ä»¥åŒºåˆ†ã€‚</p><h4 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h4><img src="/nginxè´Ÿè½½å‡è¡¡çš„å®ç°/img/2.gif">]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;è´Ÿè½½å‡è¡¡æ˜¯ä»€ä¹ˆï¼Ÿ&quot;&gt;&lt;a href=&quot;#è´Ÿè½½å‡è¡¡æ˜¯ä»€ä¹ˆï¼Ÿ&quot; class=&quot;headerlink&quot; title=&quot;è´Ÿè½½å‡è¡¡æ˜¯ä»€ä¹ˆï¼Ÿ&quot;&gt;&lt;/a&gt;è´Ÿè½½å‡è¡¡æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/h4&gt;&lt;p&gt;&amp;emsp;è´Ÿè½½å‡è¡¡å»ºç«‹åœ¨ç°æœ‰ç½‘ç»œç»“æ„ä¹‹ä¸Šï¼Œå®ƒæä¾›äº†ä¸€ç§å»‰ä»·æœ‰æ•ˆé€æ˜çš„æ–¹æ³•æ‰©å±•ç½‘ç»œè®¾å¤‡å’ŒæœåŠ¡å™¨çš„å¸¦å®½ã€å¢åŠ ååé‡ã€åŠ å¼ºç½‘ç»œæ•°æ®å¤„ç†èƒ½åŠ›ã€æé«˜ç½‘ç»œçš„çµæ´»æ€§å’Œå¯ç”¨æ€§ã€‚&lt;/p&gt;
&lt;p&gt;&amp;emsp;è´Ÿè½½å‡è¡¡ï¼ˆLoad Balanceï¼‰å…¶æ„æ€å°±æ˜¯åˆ†æ‘Šåˆ°å¤šä¸ªæ“ä½œå•å…ƒä¸Šè¿›è¡Œæ‰§è¡Œï¼Œä¾‹å¦‚WebæœåŠ¡å™¨ã€FTPæœåŠ¡å™¨ã€ä¼ä¸šå…³é”®åº”ç”¨æœåŠ¡å™¨å’Œå…¶å®ƒå…³é”®ä»»åŠ¡æœåŠ¡å™¨ç­‰ï¼Œä»è€Œå…±åŒå®Œæˆå·¥ä½œä»»åŠ¡ã€‚&lt;/p&gt;
&lt;h4 id=&quot;ä¸ºä»€ä¹ˆè¦åšè´Ÿè½½å‡è¡¡&quot;&gt;&lt;a href=&quot;#ä¸ºä»€ä¹ˆè¦åšè´Ÿè½½å‡è¡¡&quot; class=&quot;headerlink&quot; title=&quot;ä¸ºä»€ä¹ˆè¦åšè´Ÿè½½å‡è¡¡&quot;&gt;&lt;/a&gt;ä¸ºä»€ä¹ˆè¦åšè´Ÿè½½å‡è¡¡&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;æœåŠ¡å™¨æ€»æ˜¯å´©æºƒæ€ä¹ˆåŠï¼Ÿ&lt;/li&gt;
&lt;li&gt;ä¸€å°æœåŠ¡å™¨æ‰›ä¸ä½å¤§é‡çš„å¹¶å‘æ€ä¹ˆåŠï¼Ÿ&lt;/li&gt;
&lt;li&gt;â€¦â€¦&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt; &amp;nbsp;æœ‰äº†è¿™äº›é—®é¢˜ï¼Œæˆ‘ç›¸ä¿¡ä½ ä¸€å®šä¼šç”¨å¾—åˆ°è¿™ä¸ªæŠ€æœ¯ã€‚æœ€è®©äººé«˜å…´çš„ä¸€ç‚¹æ˜¯ï¼šåªéœ€è¦ä½ æ‡‚ç‚¹nginxçš„é…ç½®å°±èƒ½å®Œç¾çš„é©¾é©­è´Ÿè½½å‡è¡¡çš„é…ç½®ï¼Œè‡³äºé…ç½®ä¹‹åå¯èƒ½å‡ºç°çš„é—®é¢˜ï¼Œå†æ…¢æ…¢å»ç ”ç©¶ä¹Ÿä¸è¿Ÿã€‚&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="nginx" scheme="http://www.daichongweb.com/tags/nginx/"/>
    
  </entry>
  
  <entry>
    <title>ç”¨æœ€å°‘çš„Sqlå®ç°ä¸€ä¸ªç‰¹æ®Šæ’è¡Œæ¦œ</title>
    <link href="http://www.daichongweb.com/%E7%94%A8%E6%9C%80%E5%B0%91%E7%9A%84Sql%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%89%B9%E6%AE%8A%E6%8E%92%E8%A1%8C%E6%A6%9C/"/>
    <id>http://www.daichongweb.com/ç”¨æœ€å°‘çš„Sqlå®ç°ä¸€ä¸ªç‰¹æ®Šæ’è¡Œæ¦œ/</id>
    <published>2020-01-21T00:24:28.000Z</published>
    <updated>2020-08-19T03:46:29.233Z</updated>
    
    <content type="html"><![CDATA[<h4 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h4><p>&emsp;è¯´èµ·æ’è¡Œæ¦œä¸Šä¸€ç¯‡å·²ç»ä»‹ç»è¿‡äº†ç”¨Rediså®ç°çš„æ–¹æ³•ï¼Œè€Œè¿™ç¯‡å®Œå…¨æ˜¯ç”¨Sqlæ¥å®ç°ï¼Œä¸ä½¿ç”¨ä»»ä½•ç¼“å­˜ã€‚</p><h4 id="éœ€æ±‚åŠŸèƒ½ï¼ˆ1ï¼‰"><a href="#éœ€æ±‚åŠŸèƒ½ï¼ˆ1ï¼‰" class="headerlink" title="éœ€æ±‚åŠŸèƒ½ï¼ˆ1ï¼‰"></a>éœ€æ±‚åŠŸèƒ½ï¼ˆ1ï¼‰</h4><p>&emsp;ç°æœ‰åä¸ªåŒå­¦ï¼Œå¹´é¾„åˆ†å¸ƒå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå‡è®¾ä½ æ˜¯<code>æˆ´ä¸ƒ</code>ï¼Œè¯·æ ¹æ®å¹´é¾„è·å¾—ä½ åœ¨è¿™åäººä¸­æ’ç¬¬å‡ ï¼ŸåŒæ—¶è¯·è·å¾—ä½ çš„å‰ä¸€åå’Œåä¸€åå„æ˜¯å“ªä¸€ä½åŒå­¦ï¼Ÿ</p><img src="/ç”¨æœ€å°‘çš„Sqlå®ç°ä¸€ä¸ªç‰¹æ®Šæ’è¡Œæ¦œ/img/1.png"><p>&emsp;è¿™ä¸ªé¢˜æ˜¯æˆ‘å»å¹´åœ¨ä¸€å®¶å…¬å¸è¢«é—®åˆ°çš„é¢è¯•é¢˜ã€‚æ ¹æ®ä¸Šå›¾åˆ†æï¼Œè·å–åˆ°è‡ªå·±çš„æ’åå¹¶ä¸æ˜¯éš¾äº‹ï¼Œé‚£å‰ä¸€åå’Œåä¸€åä¹Ÿéå¸¸ç®€å•äº†ã€‚<br><a id="more"></a></p><h5 id="è‡ªå·±çš„æ’å"><a href="#è‡ªå·±çš„æ’å" class="headerlink" title="è‡ªå·±çš„æ’å"></a>è‡ªå·±çš„æ’å</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// åŸç”Ÿå†™æ³•</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">from</span> <span class="string">`rank`</span> <span class="keyword">where</span> <span class="string">`age`</span> &gt; <span class="number">22</span> <span class="keyword">or</span> (<span class="string">`age`</span> = <span class="number">22</span> <span class="keyword">and</span> <span class="string">`created_at`</span> &gt; <span class="string">'2020-01-21 09:05:34'</span>);</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Laravelæ¡†æ¶å†™æ³•</span></span><br><span class="line">$my = DB::table(<span class="string">'rank'</span>)-&gt;where(<span class="string">'name'</span>, <span class="string">'æˆ´ä¸ƒ'</span>)-&gt;first();</span><br><span class="line">$rank = DB::table(<span class="string">'rank'</span>)-&gt;where(<span class="string">'age'</span>, <span class="string">'&gt;'</span>, $my-&gt;age)-&gt;orWhere(<span class="function"><span class="keyword">function</span> <span class="params">($query)</span> <span class="title">use</span> <span class="params">($my)</span> </span>&#123;</span><br><span class="line">    $query-&gt;where(<span class="string">'age'</span>, <span class="string">'='</span>, $my-&gt;age)-&gt;where(<span class="string">'created_at'</span>, <span class="string">'&gt;'</span>, $my-&gt;created_at);</span><br><span class="line">&#125;)-&gt;count();</span><br><span class="line">$myRank = $rank + <span class="number">1</span>;</span><br></pre></td></tr></table></figure><p>&emsp;è¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼šå¦‚æœä¸¤ä¸ªäººçš„å¹´é¾„ç›¸åŒï¼Œé‚£ä¹ˆå°±è¦æ¯”è¾ƒæ—¶é—´ã€‚æœ€ç»ˆå¾—åˆ°çš„æ˜¯å¹´é¾„å¤§äºè‡ªå·±äººæœ‰å¤šå°‘ä¸ªï¼Œ+1å°±æ˜¯è‡ªå·±çš„æ’åã€‚</p><h5 id="å‰ä¸€å"><a href="#å‰ä¸€å" class="headerlink" title="å‰ä¸€å"></a>å‰ä¸€å</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// é€šè¿‡ä¸Šé¢çš„Sqlå¾—çŸ¥å¹´é¾„å¤§äºè‡ªå·±çš„äººæ•°æ˜¯6äºº</span><br><span class="line">$rankNum = 6;</span><br><span class="line">$top = $rankNum - 1;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">rank</span> <span class="keyword">where</span> age &gt; <span class="number">22</span> <span class="keyword">order</span> <span class="keyword">by</span> age <span class="keyword">desc</span> <span class="keyword">limit</span> $top,<span class="number">1</span></span><br></pre></td></tr></table></figure><h5 id="åä¸€å"><a href="#åä¸€å" class="headerlink" title="åä¸€å"></a>åä¸€å</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="string">`rank`</span> <span class="keyword">where</span> <span class="string">`age`</span> &lt; <span class="number">22</span> <span class="keyword">or</span> (<span class="string">`age`</span> = <span class="number">22</span> <span class="keyword">and</span> <span class="string">`created_at`</span> &lt; <span class="string">'2020-01-21 09:05:34'</span>) <span class="keyword">order</span> <span class="keyword">by</span> age <span class="keyword">desc</span>,created_at <span class="keyword">desc</span> <span class="keyword">limit</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><p>&emsp;è¿™é‡Œå’ŒåŸå§‹Sqlä¸åŒçš„æ˜¯ï¼šå¹´é¾„æ˜¯<code>&lt;22</code>ï¼Œæ—¶é—´ä¹Ÿæ˜¯<code>&lt;è‡ªå·±çš„å‡ºç”Ÿæ—¶é—´</code>ã€‚</p><h4 id="éœ€æ±‚åŠŸèƒ½ï¼ˆ2ï¼‰"><a href="#éœ€æ±‚åŠŸèƒ½ï¼ˆ2ï¼‰" class="headerlink" title="éœ€æ±‚åŠŸèƒ½ï¼ˆ2ï¼‰"></a>éœ€æ±‚åŠŸèƒ½ï¼ˆ2ï¼‰</h4><p>&emsp;è¿˜æ˜¯è¿™åååŒå­¦ï¼Œå‡è®¾<code>æˆ´ä¸ƒ</code>åŒå­¦å°±æ˜¯æœ¬äººï¼Œç°éœ€è¦äº”ååŒå­¦çš„å¹´é¾„ä½œä¸ºå‚è€ƒï¼Œè¦æ±‚è¿™åˆ†åˆ«å¾—çŸ¥ä½ æœ¬äººçš„å‰ä¸¤ååŒå­¦å’Œåä¸¤ååŒå­¦éƒ½æ˜¯è°ï¼ˆäº”ååŒå­¦ä¸­å¿…é¡»åŒ…å«ä½ è‡ªå·±ï¼‰ï¼Ÿ</p><h5 id="ç‰¹æ®Šæƒ…å†µï¼š"><a href="#ç‰¹æ®Šæƒ…å†µï¼š" class="headerlink" title="ç‰¹æ®Šæƒ…å†µï¼š"></a>ç‰¹æ®Šæƒ…å†µï¼š</h5><p>&emsp;ï¼ˆ1ï¼‰å¦‚æœä½ æ˜¯ç¬¬ä¸€åï¼Œé‚£ä¹ˆå°±è·å¾—ä½ åé¢çš„å››ä½åŒå­¦ã€‚<br>&emsp;ï¼ˆ2ï¼‰å¦‚æœä½ æ˜¯ç¬¬äºŒåï¼Œé‚£ä¹ˆå°±è·å¾—ä½ å‰é¢çš„ä¸€å+åé¢çš„ä¸‰ååŒå­¦ã€‚<br>&emsp;ï¼ˆ3ï¼‰å¦‚æœä½ æ˜¯å€’æ•°ç¬¬ä¸€åï¼Œé‚£ä¹ˆå°±è·å¾—ä½ å‰é¢çš„å››ä½åŒå­¦ã€‚<br>&emsp;ï¼ˆ4ï¼‰å¦‚æœä½ æ˜¯å€’æ•°ç¬¬äºŒåï¼Œé‚£ä¹ˆå°±è·å¾—ä½ å‰é¢çš„ä¸‰å+åé¢çš„ä¸€ä½åŒå­¦ã€‚<br>&emsp;ï¼ˆ5ï¼‰å¯ä½¿ç”¨å…¶ä»–è¯­è¨€è¾…åŠ©è§£å†³é—®é¢˜ï¼Œä½†å°½å¯èƒ½çš„ç®€å•æ¸…æ™°ã€‚</p><h4 id="ç­”æ¡ˆ"><a href="#ç­”æ¡ˆ" class="headerlink" title="ç­”æ¡ˆ"></a>ç­”æ¡ˆ</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$myRank = $rank + <span class="number">1</span>;</span><br><span class="line">$total = Db::table(<span class="string">'rank'</span>)-&gt;count();</span><br><span class="line"><span class="comment">// å¦‚æœæ’åæ˜¯åœ¨å‰ä¸‰å</span></span><br><span class="line"><span class="keyword">if</span> ($myRank &lt;= <span class="number">3</span>) &#123;</span><br><span class="line">    select * from rank where <span class="number">1</span> order by age desc,created_at desc limit <span class="number">5</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (($total - $myRank) &lt;= <span class="number">2</span>) &#123; <span class="comment">// å€’æ•°ä¸¤å</span></span><br><span class="line">    $unRank = $total - $myRank + <span class="number">1</span>;</span><br><span class="line">    $offset = $myRank - <span class="number">6</span> + $unRank;</span><br><span class="line">    select * from rank where <span class="number">1</span> order by age desc,created_at desc limit $offset,<span class="number">5</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $offset = $myRank - <span class="number">3</span>;</span><br><span class="line">    select * from rank where <span class="number">1</span> order by age desc,created_at desc limit $offset,<span class="number">5</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;å¼•è¨€&quot;&gt;&lt;a href=&quot;#å¼•è¨€&quot; class=&quot;headerlink&quot; title=&quot;å¼•è¨€&quot;&gt;&lt;/a&gt;å¼•è¨€&lt;/h4&gt;&lt;p&gt;&amp;emsp;è¯´èµ·æ’è¡Œæ¦œä¸Šä¸€ç¯‡å·²ç»ä»‹ç»è¿‡äº†ç”¨Rediså®ç°çš„æ–¹æ³•ï¼Œè€Œè¿™ç¯‡å®Œå…¨æ˜¯ç”¨Sqlæ¥å®ç°ï¼Œä¸ä½¿ç”¨ä»»ä½•ç¼“å­˜ã€‚&lt;/p&gt;
&lt;h4 id=&quot;éœ€æ±‚åŠŸèƒ½ï¼ˆ1ï¼‰&quot;&gt;&lt;a href=&quot;#éœ€æ±‚åŠŸèƒ½ï¼ˆ1ï¼‰&quot; class=&quot;headerlink&quot; title=&quot;éœ€æ±‚åŠŸèƒ½ï¼ˆ1ï¼‰&quot;&gt;&lt;/a&gt;éœ€æ±‚åŠŸèƒ½ï¼ˆ1ï¼‰&lt;/h4&gt;&lt;p&gt;&amp;emsp;ç°æœ‰åä¸ªåŒå­¦ï¼Œå¹´é¾„åˆ†å¸ƒå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå‡è®¾ä½ æ˜¯&lt;code&gt;æˆ´ä¸ƒ&lt;/code&gt;ï¼Œè¯·æ ¹æ®å¹´é¾„è·å¾—ä½ åœ¨è¿™åäººä¸­æ’ç¬¬å‡ ï¼ŸåŒæ—¶è¯·è·å¾—ä½ çš„å‰ä¸€åå’Œåä¸€åå„æ˜¯å“ªä¸€ä½åŒå­¦ï¼Ÿ&lt;/p&gt;
&lt;img src=&quot;/ç”¨æœ€å°‘çš„Sqlå®ç°ä¸€ä¸ªç‰¹æ®Šæ’è¡Œæ¦œ/img/1.png&quot;&gt;
&lt;p&gt;&amp;emsp;è¿™ä¸ªé¢˜æ˜¯æˆ‘å»å¹´åœ¨ä¸€å®¶å…¬å¸è¢«é—®åˆ°çš„é¢è¯•é¢˜ã€‚æ ¹æ®ä¸Šå›¾åˆ†æï¼Œè·å–åˆ°è‡ªå·±çš„æ’åå¹¶ä¸æ˜¯éš¾äº‹ï¼Œé‚£å‰ä¸€åå’Œåä¸€åä¹Ÿéå¸¸ç®€å•äº†ã€‚&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="mysql" scheme="http://www.daichongweb.com/tags/mysql/"/>
    
  </entry>
  
  <entry>
    <title>php+rediså®ç°å®æ—¶æ’è¡Œæ¦œ</title>
    <link href="http://www.daichongweb.com/php-redis%E5%AE%9E%E7%8E%B0%E5%AE%9E%E6%97%B6%E6%8E%92%E8%A1%8C%E6%A6%9C/"/>
    <id>http://www.daichongweb.com/php-rediså®ç°å®æ—¶æ’è¡Œæ¦œ/</id>
    <published>2019-12-19T05:14:25.000Z</published>
    <updated>2020-08-19T03:46:29.193Z</updated>
    
    <content type="html"><![CDATA[<h4 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h4><p>&emsp;è¯´èµ·æ’è¡Œæ¦œå¤§å®¶è‚¯å®šä¸é™Œç”Ÿï¼Œåœ¨é¡¹ç›®å¼€å‘ä¸­æ’è¡Œæ¦œçš„è¿ç”¨éå¸¸çš„å¤šã€‚å¦‚ç‹è€…å†œè¯çš„å¤©æ¢¯æ’è¡Œæ¦œã€å•†åŸçš„é”€é‡æ’è¡Œæ¦œã€çƒ­å–æ¦œã€ç”¨æˆ·ç§¯åˆ†æ’è¡Œæ¦œç­‰ç­‰ã€‚ä¸ç®¡ä»–æ˜¯ä»€ä¹ˆç±»å‹çš„æ’è¡Œæ¦œï¼Œå…¶ä¸šåŠ¡é€»è¾‘ã€å®ç°æ–¹æ³•å‡ ä¹æ˜¯å®Œå…¨ç›¸åŒçš„ã€‚<br>&emsp;å¦‚è¿™æ ·çš„ä¸€ä¸ªæ‰‹æœºå’Œç¬”è®°æœ¬çš„é”€é‡æ’è¡Œæ¦œæ˜¯å¦‚ä½•å®ç°çš„å‘¢ï¼Ÿ<br><a id="more"></a></p><h4 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h4><img src="/php-rediså®ç°å®æ—¶æ’è¡Œæ¦œ/img/1.png"><h4 id="æ¦œå•å®ç°"><a href="#æ¦œå•å®ç°" class="headerlink" title="æ¦œå•å®ç°"></a>æ¦œå•å®ç°</h4><p>&emsp;å‡è®¾åšä¸€ä¸ªå¦‚ä¸Šå›¾ä¸€æ ·çš„æ’è¡Œæ¦œï¼Œè§„å®šæ¦œå•å¿…é¡»æ˜¯å®æ—¶æ›´æ–°çš„ï¼Œä½ ä¼šä½¿ç”¨ä»€ä¹ˆæŠ€æœ¯æ¥å®ç°å‘¢ï¼Ÿ</p><h5 id="æ–¹æ¡ˆä¸€"><a href="#æ–¹æ¡ˆä¸€" class="headerlink" title="æ–¹æ¡ˆä¸€"></a>æ–¹æ¡ˆä¸€</h5><p>&emsp;åœ¨æ•°æ®åº“æ–°å»ºä¸€å¼ æ•°æ®è¡¨ï¼Œé€šè¿‡ä¸‹å•äº‹ä»¶é’©å­æ¥æ›´æ–°è¿™å¼ è¡¨çš„æ•°æ®ï¼Œè®°å½•é”€é‡æƒ…å†µã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">id</span>,<span class="keyword">name</span>,image <span class="keyword">from</span> goods <span class="keyword">left</span> <span class="keyword">join</span> goods_top <span class="keyword">on</span> goods.id=goods_top.goods_id <span class="keyword">where</span> sales &gt; <span class="number">0</span> <span class="keyword">order</span> <span class="keyword">by</span> sales <span class="keyword">desc</span> <span class="keyword">limit</span> <span class="number">10</span>;</span><br></pre></td></tr></table></figure></p><p>&emsp;æœ€å¸¸è§ã€æœ€ç®€å•çš„å†™æ³•è«è¿‡äºæ­¤ï¼Œä½†è¿™ä¸ªå†™æ³•æœ‰ä¸€ä¸ªéå¸¸ä¸¥é‡çš„é—®é¢˜ã€‚å‡è®¾<code>goods</code>ä¸­æ•°æ®è§„æ¨¡æå¤§ï¼Œè®°å½•è¡¨<code>goods_top</code>è¡¨ä¸­æ•°æ®è§„æ¨¡ä¹Ÿä¸å°ï¼Œåœ¨æ¯æ¬¡æŸ¥è¯¢çš„æ€§èƒ½æ¶ˆè€—æ— ç–‘æ˜¯å¾ˆå¤§çš„ï¼Œåœ¨æç«¯çš„æƒ…å†µä¸‹ç”šè‡³å¯èƒ½ä¼šå‡ºç°è¯·æ±‚è¶…æ—¶çš„æƒ…å†µã€‚</p><p>&emsp;è¿™ä¸ªæ–¹æ¡ˆåœ¨å®é™…çš„é¡¹ç›®è¿ç”¨ä¸­ä¹Ÿå¾ˆå°‘å‡ºç°ï¼Œé™¤éä½ èƒ½ç¡®å®šæ•°æ®è¡¨è§„æ¨¡ä¸€å®šä¼šéå¸¸çš„å°ï¼Œæˆ–è€…ä½ æ ¹æœ¬ä¸è€ƒè™‘ä»€ä¹ˆæ€§èƒ½çš„æƒ…å†µä¸‹æ‰ä¼šä½¿ç”¨ã€‚</p><h5 id="æ–¹æ¡ˆäºŒ"><a href="#æ–¹æ¡ˆäºŒ" class="headerlink" title="æ–¹æ¡ˆäºŒ"></a>æ–¹æ¡ˆäºŒ</h5><p>&emsp;ä½¿ç”¨<code>redis</code>çš„<code>æœ‰åºé›†åˆ(zset)</code>æ¥å®ç°å®æ—¶æ’è¡Œæ¦œã€‚<em style="font-size:12px;">å…³äºredisæœ‰åºé›†åˆçš„ç›¸å…³ä»‹ç»ã€åŸç†ä»€ä¹ˆçš„å¤§å®¶è‡ªè¡Œç™¾åº¦</em></p><p>&emsp;(1)<code>Redis</code> æœ‰åºé›†åˆå’Œé›†åˆä¸€æ ·ä¹Ÿæ˜¯<code>string</code>ç±»å‹å…ƒç´ çš„é›†åˆ,ä¸”ä¸å…è®¸é‡å¤çš„æˆå‘˜ã€‚<br>&emsp;(2)ä¸åŒçš„æ˜¯æ¯ä¸ªå…ƒç´ éƒ½ä¼šå…³è”ä¸€ä¸ªdoubleç±»å‹çš„åˆ†æ•°ã€‚redisæ­£æ˜¯é€šè¿‡åˆ†æ•°æ¥ä¸ºé›†åˆä¸­çš„æˆå‘˜è¿›è¡Œä»å°åˆ°å¤§çš„æ’åºã€‚<br>&emsp;(3)æœ‰åºé›†åˆçš„æˆå‘˜æ˜¯å”¯ä¸€çš„,ä½†åˆ†æ•°(score)å´å¯ä»¥é‡å¤ã€‚<br>&emsp;(4)é›†åˆæ˜¯é€šè¿‡å“ˆå¸Œè¡¨å®ç°çš„ï¼Œæ‰€ä»¥æ·»åŠ ï¼Œåˆ é™¤ï¼ŒæŸ¥æ‰¾çš„å¤æ‚åº¦éƒ½æ˜¯O(1)ã€‚ é›†åˆä¸­æœ€å¤§çš„æˆå‘˜æ•°ä¸º 232 - 1 (4294967295, æ¯ä¸ªé›†åˆå¯å­˜å‚¨40å¤šäº¿ä¸ªæˆå‘˜)ã€‚</p><p>&emsp;ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹å•äº‹ä»¶é’©å­åˆ›å»ºä¸€ä¸ª<code>zseté›†åˆ</code>ï¼Œæˆ‘ä»¬é€šè¿‡<code>value</code>æ¥åŒºåˆ†æ˜¯å“ªä¸ªå•†å“ï¼Œé€šè¿‡<code>score</code>æ¥æ’åã€‚</p><img src="/php-rediså®ç°å®æ—¶æ’è¡Œæ¦œ/img/2.png"><h5 id="å…·ä½“ä»£ç "><a href="#å…·ä½“ä»£ç " class="headerlink" title="å…·ä½“ä»£ç "></a>å…·ä½“ä»£ç </h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Support</span>\<span class="title">Facades</span>\<span class="title">Redis</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å•†å“é”€é‡æ’è¡Œæ¦œ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Rank</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">// key</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">key</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $activeActivityId = Main::info();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"goods_top"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¢åŠ é”€é‡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">add</span><span class="params">($id, $number)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Redis::zIncrBy(<span class="keyword">self</span>::key(), $number, $id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–é”€é‡</span></span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">get</span><span class="params">($id)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Redis::zScore(<span class="keyword">self</span>::key(), $id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–æˆå‘˜æ’å-æ­£åº</span></span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getRank</span><span class="params">($id)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Redis::zrevrank(<span class="keyword">self</span>::key(), $id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é€šè¿‡æ’åè·å–æˆå‘˜</span></span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getRevRange</span><span class="params">($start, $stop)</span>: <span class="title">array</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Redis::zRevRange(<span class="keyword">self</span>::key(), $start, $stop);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="å¦‚ä½•ä½¿ç”¨"><a href="#å¦‚ä½•ä½¿ç”¨" class="headerlink" title="å¦‚ä½•ä½¿ç”¨"></a>å¦‚ä½•ä½¿ç”¨</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Rank::add(<span class="number">1008</span>,<span class="number">10</span>); <span class="comment">// å•†å“IDä¸º1008çš„é”€é‡å¢åŠ 10</span></span><br><span class="line">Rank::get(<span class="number">1008</span>); <span class="comment">// è·å–å•†å“IDä¸º1008çš„é”€é‡</span></span><br><span class="line">Rank::getRank(<span class="number">1008</span>); <span class="comment">// è·å–å•†å“IDä¸º1008çš„æ’å</span></span><br><span class="line">Rank::getRevRange(<span class="number">0</span>,<span class="number">9</span>); <span class="comment">// è·å–æ’åå‰åçš„å•†å“ID,è¿”å›æ•°ç»„</span></span><br></pre></td></tr></table></figure><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>&emsp;å®ç°æ’è¡Œæ¦œçš„æ–¹å¼æœ‰å¾ˆå¤šï¼Œå¤§å®¶æ ¹æ®å…·ä½“éœ€æ±‚å’Œç°æœ‰æŠ€æœ¯æ¥ç¡®å®šå®ç°æ–¹æ¡ˆã€‚ä¸è¦è¿‡åˆ†çš„è¿½æ±‚æ€§èƒ½æˆ–è€…æ˜¯å¼€å‘é€Ÿåº¦ï¼Œæ¬²é€Ÿåˆ™ä¸è¾¾ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;ä»‹ç»&quot;&gt;&lt;a href=&quot;#ä»‹ç»&quot; class=&quot;headerlink&quot; title=&quot;ä»‹ç»&quot;&gt;&lt;/a&gt;ä»‹ç»&lt;/h4&gt;&lt;p&gt;&amp;emsp;è¯´èµ·æ’è¡Œæ¦œå¤§å®¶è‚¯å®šä¸é™Œç”Ÿï¼Œåœ¨é¡¹ç›®å¼€å‘ä¸­æ’è¡Œæ¦œçš„è¿ç”¨éå¸¸çš„å¤šã€‚å¦‚ç‹è€…å†œè¯çš„å¤©æ¢¯æ’è¡Œæ¦œã€å•†åŸçš„é”€é‡æ’è¡Œæ¦œã€çƒ­å–æ¦œã€ç”¨æˆ·ç§¯åˆ†æ’è¡Œæ¦œç­‰ç­‰ã€‚ä¸ç®¡ä»–æ˜¯ä»€ä¹ˆç±»å‹çš„æ’è¡Œæ¦œï¼Œå…¶ä¸šåŠ¡é€»è¾‘ã€å®ç°æ–¹æ³•å‡ ä¹æ˜¯å®Œå…¨ç›¸åŒçš„ã€‚&lt;br&gt;&amp;emsp;å¦‚è¿™æ ·çš„ä¸€ä¸ªæ‰‹æœºå’Œç¬”è®°æœ¬çš„é”€é‡æ’è¡Œæ¦œæ˜¯å¦‚ä½•å®ç°çš„å‘¢ï¼Ÿ&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="php" scheme="http://www.daichongweb.com/tags/php/"/>
    
  </entry>
  
  <entry>
    <title>php7.4é¢„åŠ è½½ä¸swooleå¸¸é©»å†…å­˜æœ‰ä½•åŒºåˆ«ï¼Ÿ</title>
    <link href="http://www.daichongweb.com/php7-4%E9%A2%84%E5%8A%A0%E8%BD%BD%E4%B8%8Eswoole%E5%B8%B8%E9%A9%BB%E5%86%85%E5%AD%98%E6%9C%89%E4%BD%95%E5%8C%BA%E5%88%AB%EF%BC%9F/"/>
    <id>http://www.daichongweb.com/php7-4é¢„åŠ è½½ä¸swooleå¸¸é©»å†…å­˜æœ‰ä½•åŒºåˆ«ï¼Ÿ/</id>
    <published>2019-12-14T01:52:57.000Z</published>
    <updated>2020-08-19T03:46:29.195Z</updated>
    
    <content type="html"><![CDATA[<h4 id="é‡å¤§æ–°é—»"><a href="#é‡å¤§æ–°é—»" class="headerlink" title="é‡å¤§æ–°é—»"></a>é‡å¤§æ–°é—»</h4><img src="/php7-4é¢„åŠ è½½ä¸swooleå¸¸é©»å†…å­˜æœ‰ä½•åŒºåˆ«ï¼Ÿ/img/1.png"><p>php7.4åœ¨2019/11/28æ—¥å‘å¸ƒï¼<br><a id="more"></a><br>å…¶ä¸­RFC: Preloadingï¼ˆé¢„åŠ è½½ï¼‰æœ€å¼•äººç©ç›®ã€‚è¿™ä¸€æ–°ç‰¹æ€§çš„è¯ç”Ÿæ ‡å¿—ç€phpä½œä¸ºè§£é‡Šå‹è¯­è¨€åœ¨æ€§èƒ½ç“¶é¢ˆä¸Šå†æ¬¡çªç ´ã€‚</p><p>æ ¹æ®å„å¤§ç½‘å‹çš„æµ‹è¯•ç»Ÿè®¡ï¼Œphp7.4ä¸php7.0ç›¸æ¯”æå‡å°†è¿‘10%ã€‚</p><h4 id="ç‰¹æ€§ä»‹ç»"><a href="#ç‰¹æ€§ä»‹ç»" class="headerlink" title="ç‰¹æ€§ä»‹ç»"></a>ç‰¹æ€§ä»‹ç»</h4><h5 id="phpç”Ÿå‘½å‘¨æœŸ"><a href="#phpç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="phpç”Ÿå‘½å‘¨æœŸ"></a>phpç”Ÿå‘½å‘¨æœŸ</h5><img src="/php7-4é¢„åŠ è½½ä¸swooleå¸¸é©»å†…å­˜æœ‰ä½•åŒºåˆ«ï¼Ÿ/img/3.png"><p>æ¯æ¬¡è¯·æ±‚phpéƒ½ä¼šä»0åˆ°1é‡å¤ä¸Šå›¾æ‰€ç¤ºçš„æ“ä½œï¼Œæ¯æ¬¡å¸¦æ¥çš„å†…å­˜ã€IOæ–¹é¢çš„æ¶ˆè€—æ— ç–‘æ˜¯å¾ˆå¤§çš„ã€‚</p><h5 id="é¢„åŠ è½½"><a href="#é¢„åŠ è½½" class="headerlink" title="é¢„åŠ è½½"></a>é¢„åŠ è½½</h5><img src="/php7-4é¢„åŠ è½½ä¸swooleå¸¸é©»å†…å­˜æœ‰ä½•åŒºåˆ«ï¼Ÿ/img/2.png" title="ç½‘å›¾"><p>åœ¨é¢„åŠ è½½çš„ç‰¹æ€§ä¸‹ï¼Œphpä¼šå½“é¢„åŠ è½½å®Œæˆåçš„è¯·æ±‚ç›´æ¥ä¼šå‘½ä¸­ç¼“å­˜ï¼Œçœä¸‹äº†ç¼–è¯‘ã€è¯­æ³•è§£æã€è¯­æ³•åˆ†æã€ç±»åº“å¼•å…¥ç­‰ç­‰æ“ä½œã€‚</p><p>è¿™é‡Œä½ ä¼šå‘ç°æ€ä¹ˆå’Œswooleçš„å¸¸é©»å†…å­˜æœ‰ç‚¹åƒï¼Ÿ</p><p>ä¸è¿‡è¯´å®è¯ï¼Œåœ¨æ²¡æœ‰çœŸæ­£ä½¿ç”¨çš„æƒ…å†µä¸‹è¿˜çœŸæ²¡æ³•åˆ¤æ–­ä¸¤è€…çš„åŒºåˆ«ã€‚</p><p>å…³äºæ›´è¯¦ç»†çš„é¢„åŠ è½½ä½¿ç”¨å¤§å®¶å¯ä»¥çœ‹è¿™é‡Œï¼š<a href="https://blog.csdn.net/qmhball/article/details/103503939" target="_blank" rel="noopener">php7.4 preload(é¢„åŠ è½½)</a></p><p>æ¬¢è¿å¤§å®¶æ¥è®¨è®ºæœ‰å…³äºé¢„åŠ è½½å’Œå¸¸é©»å†…å­˜çš„åŒºåˆ«åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ</p>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;é‡å¤§æ–°é—»&quot;&gt;&lt;a href=&quot;#é‡å¤§æ–°é—»&quot; class=&quot;headerlink&quot; title=&quot;é‡å¤§æ–°é—»&quot;&gt;&lt;/a&gt;é‡å¤§æ–°é—»&lt;/h4&gt;&lt;img src=&quot;/php7-4é¢„åŠ è½½ä¸swooleå¸¸é©»å†…å­˜æœ‰ä½•åŒºåˆ«ï¼Ÿ/img/1.png&quot;&gt;
&lt;p&gt;php7.4åœ¨2019/11/28æ—¥å‘å¸ƒï¼&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="php" scheme="http://www.daichongweb.com/tags/php/"/>
    
  </entry>
  
  <entry>
    <title>php+element+aliyunOsså®ç°å•å›¾webç›´ä¼ </title>
    <link href="http://www.daichongweb.com/php-element-aliyunOss%E5%AE%9E%E7%8E%B0%E5%8D%95%E5%9B%BEweb%E7%9B%B4%E4%BC%A0/"/>
    <id>http://www.daichongweb.com/php-element-aliyunOsså®ç°å•å›¾webç›´ä¼ /</id>
    <published>2019-12-07T09:45:43.000Z</published>
    <updated>2020-08-19T03:46:29.189Z</updated>
    
    <content type="html"><![CDATA[<h4 id="ä¸šåŠ¡é€»è¾‘"><a href="#ä¸šåŠ¡é€»è¾‘" class="headerlink" title="ä¸šåŠ¡é€»è¾‘"></a>ä¸šåŠ¡é€»è¾‘</h4><h5 id="åŸæœ‰ä¸šåŠ¡"><a href="#åŸæœ‰ä¸šåŠ¡" class="headerlink" title="åŸæœ‰ä¸šåŠ¡"></a>åŸæœ‰ä¸šåŠ¡</h5><img src="/php-element-aliyunOsså®ç°å•å›¾webç›´ä¼ /img/1.png"><a id="more"></a><p>å’Œæ•°æ®ç›´ä¼ åˆ° OSS ç›¸æ¯”ï¼Œä»¥ä¸Šæ–¹æ³•æœ‰ä¸‰ä¸ªç¼ºç‚¹ï¼š</p><ul><li>ä¸Šä¼ æ…¢ï¼šç”¨æˆ·æ•°æ®éœ€å…ˆä¸Šä¼ åˆ°åº”ç”¨æœåŠ¡å™¨ï¼Œä¹‹åå†ä¸Šä¼ åˆ°OSSã€‚ç½‘ç»œä¼ è¾“æ—¶é—´æ¯”ç›´ä¼ åˆ°OSSå¤šä¸€å€ã€‚å¦‚æœç”¨æˆ·æ•°æ®ä¸é€šè¿‡åº”ç”¨æœåŠ¡å™¨ä¸­è½¬ï¼Œè€Œæ˜¯ç›´ä¼ åˆ°OSSï¼Œé€Ÿåº¦å°†å¤§å¤§æå‡ã€‚è€Œä¸”OSSé‡‡ç”¨BGPå¸¦å®½ï¼Œèƒ½ä¿è¯å„åœ°å„è¿è¥å•†ä¹‹é—´çš„ä¼ è¾“é€Ÿåº¦ã€‚</li><li>æ‰©å±•æ€§å·®ï¼šå¦‚æœåç»­ç”¨æˆ·å¤šäº†ï¼Œåº”ç”¨æœåŠ¡å™¨ä¼šæˆä¸ºç“¶é¢ˆã€‚</li><li>è´¹ç”¨é«˜ï¼šéœ€è¦å‡†å¤‡å¤šå°åº”ç”¨æœåŠ¡å™¨ã€‚ç”±äºOSSä¸Šä¼ æµé‡æ˜¯å…è´¹çš„ï¼Œå¦‚æœæ•°æ®ç›´ä¼ åˆ°OSSï¼Œä¸é€šè¿‡åº”ç”¨æœåŠ¡å™¨ï¼Œé‚£ä¹ˆå°†èƒ½çœä¸‹å‡ å°åº”ç”¨æœåŠ¡å™¨ã€‚</li></ul><h5 id="ä»£æ›¿ä¸šåŠ¡"><a href="#ä»£æ›¿ä¸šåŠ¡" class="headerlink" title="ä»£æ›¿ä¸šåŠ¡"></a>ä»£æ›¿ä¸šåŠ¡</h5><img src="/php-element-aliyunOsså®ç°å•å›¾webç›´ä¼ /img/2.png"><p>ä½¿ç”¨Oss webç›´ä¼ ï¼Œèƒ½æœ‰æ•ˆçš„è§£å†³ä¸Šä¼ é€Ÿåº¦è¿‡æ…¢çš„é—®é¢˜ã€‚</p><h4 id="å®è·µ"><a href="#å®è·µ" class="headerlink" title="å®è·µ"></a>å®è·µ</h4><h5 id="phpåç«¯ç­¾åä»£ç "><a href="#phpåç«¯ç­¾åä»£ç " class="headerlink" title="phpåç«¯ç­¾åä»£ç "></a>phpåç«¯ç­¾åä»£ç </h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é˜¿é‡ŒOssä¸Šä¼ éªŒç­¾ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OssPolicy</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span>  <span class="function"><span class="keyword">function</span> <span class="title">gmtIso8601</span><span class="params">($time)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $dtStr = date(<span class="string">"c"</span>, $time);</span><br><span class="line">        $mydatetime = <span class="keyword">new</span> DateTime($dtStr);</span><br><span class="line">        $expiration = $mydatetime-&gt;format(DateTime::ISO8601);</span><br><span class="line">        $pos = strpos($expiration, <span class="string">'+'</span>);</span><br><span class="line">        $expiration = substr($expiration, <span class="number">0</span>, $pos);</span><br><span class="line">        <span class="keyword">return</span> $expiration . <span class="string">"Z"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–ç­¾å</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span>  <span class="function"><span class="keyword">function</span> <span class="title">policy</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $id = Config(<span class="string">'aliyun.webOss.accessKeyId'</span>); <span class="comment">// oss accessKeyId</span></span><br><span class="line">        $key = Config(<span class="string">'aliyun.webOss.accessKeySecret'</span>); <span class="comment">// oss accessKeySecret</span></span><br><span class="line">        $host = Config(<span class="string">'aliyun.webOss.host'</span>); <span class="comment">// oss ä¸Šä¼ åœ°å€</span></span><br><span class="line">        $callbackUrl = Config(<span class="string">'aliyun.webOss.callbackUrl'</span>);<span class="comment">// å›è°ƒåœ°å€ è¿™ä¸ªå¯ä»¥å¿½ç•¥</span></span><br><span class="line">        $dir =  Config(<span class="string">'aliyun.webOss.dir'</span>); <span class="comment">// å­˜æ”¾çš„æ–‡ä»¶å¤¹</span></span><br><span class="line"></span><br><span class="line">        $callback_param = <span class="keyword">array</span>(</span><br><span class="line">            <span class="string">'callbackUrl'</span> =&gt; $callbackUrl,</span><br><span class="line">            <span class="string">'callbackBody'</span> =&gt; <span class="string">'filename=$&#123;object&#125;&amp;size=$&#123;size&#125;&amp;mimeType=$&#123;mimeType&#125;&amp;height=$&#123;imageInfo.height&#125;&amp;width=$&#123;imageInfo.width&#125;'</span>,</span><br><span class="line">            <span class="string">'callbackBodyType'</span> =&gt; <span class="string">"application/x-www-form-urlencoded"</span></span><br><span class="line">        );</span><br><span class="line">        $callback_string = json_encode($callback_param);</span><br><span class="line">        $base64_callback_body = base64_encode($callback_string);</span><br><span class="line">        $now = time();</span><br><span class="line">        $expire = <span class="number">30</span>;</span><br><span class="line">        $end = $now + $expire;</span><br><span class="line">        $expiration = <span class="keyword">$this</span>-&gt;gmtIso8601($end);</span><br><span class="line"></span><br><span class="line">        $condition = <span class="keyword">array</span>(<span class="number">0</span> =&gt; <span class="string">'content-length-range'</span>, <span class="number">1</span> =&gt; <span class="number">0</span>, <span class="number">2</span> =&gt; <span class="number">1048576000</span>);</span><br><span class="line">        $conditions[] = $condition;</span><br><span class="line"></span><br><span class="line">        $start = <span class="keyword">array</span>(<span class="number">0</span> =&gt; <span class="string">'starts-with'</span>, <span class="number">1</span> =&gt; <span class="string">'$key'</span>, <span class="number">2</span> =&gt; $dir);</span><br><span class="line">        $conditions[] = $start;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        $arr = <span class="keyword">array</span>(<span class="string">'expiration'</span> =&gt; $expiration, <span class="string">'conditions'</span> =&gt; $conditions);</span><br><span class="line">        $policy = json_encode($arr);</span><br><span class="line">        $base64_policy = base64_encode($policy);</span><br><span class="line">        $string_to_sign = $base64_policy;</span><br><span class="line">        $signature = base64_encode(hash_hmac(<span class="string">'sha1'</span>, $string_to_sign, $key, <span class="keyword">true</span>));</span><br><span class="line"></span><br><span class="line">        $response = <span class="keyword">array</span>();</span><br><span class="line">        $response[<span class="string">'accessid'</span>] = $id;</span><br><span class="line">        $response[<span class="string">'host'</span>] = $host;</span><br><span class="line">        $response[<span class="string">'policy'</span>] = $base64_policy;</span><br><span class="line">        $response[<span class="string">'signature'</span>] = $signature;</span><br><span class="line">        $response[<span class="string">'expire'</span>] = $end;</span><br><span class="line">        $response[<span class="string">'callback'</span>] = $base64_callback_body;</span><br><span class="line">        $response[<span class="string">'dir'</span>] = $dir;</span><br><span class="line">        <span class="keyword">return</span> $response;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="å°è£…ç»„ä»¶-ossSingleUpload-vue"><a href="#å°è£…ç»„ä»¶-ossSingleUpload-vue" class="headerlink" title="å°è£…ç»„ä»¶ ossSingleUpload.vue"></a>å°è£…ç»„ä»¶ ossSingleUpload.vue</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;el-upload</span><br><span class="line">      list-type=<span class="string">"picture-card"</span></span><br><span class="line">      <span class="class"><span class="keyword">class</span></span>=<span class="string">"avatar-uploader"</span></span><br><span class="line">      action=<span class="string">"http://daichongwbe.oss-cn-beijing.aliyuncs.com"</span> <span class="comment">// ä¸Šä¼ åœ°å€</span></span><br><span class="line">      :data=<span class="string">"dataObj"</span></span><br><span class="line">      accept=<span class="string">".jpeg, .png, .jpg"</span> <span class="comment">// å…è®¸ä¸Šä¼ çš„æ–‡ä»¶</span></span><br><span class="line">      :multiple=<span class="string">"false"</span> <span class="comment">// ç¦æ­¢å¤šå›¾ä¸Šä¼ </span></span><br><span class="line">      :before-upload=<span class="string">"beforeUpload"</span> <span class="comment">// ä¸Šä¼ å‰å›è°ƒ</span></span><br><span class="line">      :on-success=<span class="string">"handleUploadSuccess"</span> <span class="comment">// ä¸Šä¼ æˆåŠŸåå›è°ƒ</span></span><br><span class="line">      :limit=<span class="string">"limit"</span> <span class="comment">// é™åˆ¶ä¸Šä¼ æ•°é‡</span></span><br><span class="line">      :show-file-list=<span class="string">"false"</span> <span class="comment">// ç¦æ­¢åˆ—è¡¨å±•ç¤º</span></span><br><span class="line">      ref=<span class="string">"upload"</span></span><br><span class="line">    &gt;</span><br><span class="line">      &lt;img v-<span class="keyword">if</span>=<span class="string">"imageUrl"</span> :src=<span class="string">"imageUrl"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"avatar"</span> /&gt;</span><br><span class="line">      &lt;i v-<span class="keyword">else</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"el-icon-plus avatar-uploader-icon"</span>&gt;&lt;<span class="regexp">/i&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>el-upload&gt;</span><br><span class="line">  &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">import</span> &#123; getPolicy &#125; <span class="keyword">from</span> <span class="string">"@/api/oss/token"</span>; <span class="comment">// åç«¯éªŒç­¾æ¥å£</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  name: <span class="string">"ossSingleUpload"</span>, <span class="comment">//ç»„ä»¶å‘½å</span></span><br><span class="line">  props: &#123;</span><br><span class="line">    limit: <span class="built_in">Number</span>, <span class="comment">// å‚æ•°</span></span><br><span class="line">    imgCover: <span class="built_in">String</span> <span class="comment">// å‚æ•°</span></span><br><span class="line">  &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      dataObj: &#123;</span><br><span class="line">        policy: <span class="string">""</span>,</span><br><span class="line">        signature: <span class="string">""</span>,</span><br><span class="line">        key: <span class="string">""</span>,</span><br><span class="line">        ossaccessKeyId: <span class="string">""</span>,</span><br><span class="line">        dir: <span class="string">""</span>,</span><br><span class="line">        host: <span class="string">""</span>,</span><br><span class="line">        callback: <span class="string">""</span></span><br><span class="line">      &#125;,</span><br><span class="line">      imageUrl: <span class="string">""</span></span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  created() &#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">this</span>.imageUrl = <span class="keyword">this</span>.imgCover;</span><br><span class="line">    &#125;, <span class="number">500</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    emitInput(val) &#123; <span class="comment">// ç»„ä»¶äº¤äº’</span></span><br><span class="line">      <span class="keyword">this</span>.$emit(<span class="string">"input"</span>, val);</span><br><span class="line">    &#125;,</span><br><span class="line">    beforeUpload(file) &#123; <span class="comment">// ä¸Šä¼ å‰é’©å­</span></span><br><span class="line">      <span class="keyword">let</span> _self = <span class="keyword">this</span>;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        getPolicy()</span><br><span class="line">          .then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">            _self.dataObj.policy = response.data.policy;</span><br><span class="line">            _self.dataObj.signature = response.data.signature;</span><br><span class="line">            _self.dataObj.ossaccessKeyId = response.data.accessid;</span><br><span class="line">            _self.dataObj.key = response.data.dir + <span class="string">"$&#123;filename&#125;"</span>;</span><br><span class="line">            _self.dataObj.dir = response.data.dir;</span><br><span class="line">            _self.dataObj.host = response.data.host;</span><br><span class="line">            _self.dataObj.callback = response.data.callback;</span><br><span class="line">            resolve(<span class="literal">true</span>);</span><br><span class="line">          &#125;)</span><br><span class="line">          .catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(err);</span><br><span class="line">            reject(<span class="literal">false</span>);</span><br><span class="line">          &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    handleUploadSuccess(res, file) &#123; <span class="comment">// ä¸Šä¼ æˆåŠŸå</span></span><br><span class="line">       <span class="comment">// æ¸…é™¤ä¸Šæ¬¡çš„ä¸Šä¼ è®°å½•ï¼Œè¿™é‡Œå¦‚æœä¸æ¸…é™¤ä¼šå¯¼è‡´ç¬¬äºŒæ¬¡ä¸Šä¼ æ— æ•ˆã€‚</span></span><br><span class="line">      <span class="keyword">this</span>.$refs.upload.clearFiles(); </span><br><span class="line">       <span class="comment">// ç»„è£…å›¾ç‰‡è·¯å¾„ï¼Œè¿™é‡Œæ ¹æ®ä¸šåŠ¡éœ€è¦æ¥ã€‚</span></span><br><span class="line">      <span class="keyword">this</span>.imageUrl = <span class="keyword">this</span>.dataObj.host + <span class="string">"/"</span> + <span class="keyword">this</span>.dataObj.dir + file.name; </span><br><span class="line">      <span class="comment">// ç»„ä»¶äº¤äº’ï¼ŒæŠŠå›¾ç‰‡è·¯å¾„å‘é€ç»™é¡µé¢</span></span><br><span class="line">      <span class="keyword">this</span>.$emit(<span class="string">"getMessage"</span>, <span class="keyword">this</span>.imageUrl); </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.avatar-uploader</span> <span class="selector-class">.el-upload</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> dashed <span class="number">#d9d9d9</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">6px</span>;</span><br><span class="line">  <span class="attribute">cursor</span>: pointer;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.avatar-uploader</span> <span class="selector-class">.el-upload</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">border-color</span>: <span class="number">#409eff</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.avatar-uploader-icon</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">28px</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#8c939d</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.avatar</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="é¡µé¢è°ƒç”¨"><a href="#é¡µé¢è°ƒç”¨" class="headerlink" title="é¡µé¢è°ƒç”¨"></a>é¡µé¢è°ƒç”¨</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"app-container"</span>&gt;</span><br><span class="line">    &lt;oss-single-upload @getMessage=<span class="string">"coverImg"</span> :imgCover=<span class="string">"imgCover"</span> :limit=<span class="string">"1"</span>&gt;&lt;<span class="regexp">/oss-single-upload&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>div&gt;</span><br><span class="line">&lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;script&gt;</span></span><br><span class="line"><span class="regexp">import ossSingleUpload from "@/</span>components/Upload/ossSingleUpload<span class="string">"; // å¼•å…¥ç»„ä»¶</span></span><br><span class="line"><span class="string">export default &#123;</span></span><br><span class="line"><span class="string">  components: &#123; ossSingleUpload &#125;,</span></span><br><span class="line"><span class="string">  data() &#123;</span></span><br><span class="line"><span class="string">    return &#123;</span></span><br><span class="line"><span class="string">      imgCover:"</span><span class="string">"</span></span><br><span class="line"><span class="string">    &#125;;</span></span><br><span class="line"><span class="string">  &#125;,</span></span><br><span class="line"><span class="string">  methods: &#123;</span></span><br><span class="line"><span class="string">    coverImg(imgUrl) &#123;</span></span><br><span class="line"><span class="string">      console.log(imgUrl); //å¾—åˆ°çš„ä¸Šä¼ å›¾ç‰‡è·¯å¾„</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;;</span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><h4 id="è¯·æ±‚ç»“æœ"><a href="#è¯·æ±‚ç»“æœ" class="headerlink" title="è¯·æ±‚ç»“æœ"></a>è¯·æ±‚ç»“æœ</h4><img src="/php-element-aliyunOsså®ç°å•å›¾webç›´ä¼ /img/3.png"><p>åœ¨callbackurlä¸ºç©ºæˆ–è€…callbackurlæ–‡ä»¶å†…å®¹é”™è¯¯çš„æƒ…å†µä¸‹ï¼Œè¿™é‡Œæ˜¯æ²¡æœ‰è¿”å›å€¼çš„ã€‚</p><img src="/php-element-aliyunOsså®ç°å•å›¾webç›´ä¼ /img/4.png"><h4 id="æ•ˆæœå±•ç¤º"><a href="#æ•ˆæœå±•ç¤º" class="headerlink" title="æ•ˆæœå±•ç¤º"></a>æ•ˆæœå±•ç¤º</h4><img src="/php-element-aliyunOsså®ç°å•å›¾webç›´ä¼ /img/5.gif"><h4 id="githubä»“åº“"><a href="#githubä»“åº“" class="headerlink" title="githubä»“åº“"></a>githubä»“åº“</h4><p><a href="https://github.com/DaiChongyu/osswebupload" target="_blank" rel="noopener">ç‚¹å‡»æŸ¥çœ‹æºä»£ç </a></p>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;ä¸šåŠ¡é€»è¾‘&quot;&gt;&lt;a href=&quot;#ä¸šåŠ¡é€»è¾‘&quot; class=&quot;headerlink&quot; title=&quot;ä¸šåŠ¡é€»è¾‘&quot;&gt;&lt;/a&gt;ä¸šåŠ¡é€»è¾‘&lt;/h4&gt;&lt;h5 id=&quot;åŸæœ‰ä¸šåŠ¡&quot;&gt;&lt;a href=&quot;#åŸæœ‰ä¸šåŠ¡&quot; class=&quot;headerlink&quot; title=&quot;åŸæœ‰ä¸šåŠ¡&quot;&gt;&lt;/a&gt;åŸæœ‰ä¸šåŠ¡&lt;/h5&gt;&lt;img src=&quot;/php-element-aliyunOsså®ç°å•å›¾webç›´ä¼ /img/1.png&quot;&gt;
    
    </summary>
    
    
      <category term="vue" scheme="http://www.daichongweb.com/tags/vue/"/>
    
  </entry>
  
  <entry>
    <title>Laravelæ¶ˆæ¯é˜Ÿåˆ—</title>
    <link href="http://www.daichongweb.com/Laravel%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/"/>
    <id>http://www.daichongweb.com/Laravelæ¶ˆæ¯é˜Ÿåˆ—/</id>
    <published>2019-12-05T02:56:23.000Z</published>
    <updated>2020-08-19T03:46:29.129Z</updated>
    
    <content type="html"><![CDATA[<h4 id="æ€ç»´å¯¼å›¾"><a href="#æ€ç»´å¯¼å›¾" class="headerlink" title="æ€ç»´å¯¼å›¾"></a>æ€ç»´å¯¼å›¾</h4><img src="/Laravelæ¶ˆæ¯é˜Ÿåˆ—/img/2.png"><a id="more"></a><h4 id="æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMQï¼‰"><a href="#æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMQï¼‰" class="headerlink" title="æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMQï¼‰"></a>æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMQï¼‰</h4><h5 id="ä»€ä¹ˆæ˜¯æ¶ˆæ¯é˜Ÿåˆ—-MQ"><a href="#ä»€ä¹ˆæ˜¯æ¶ˆæ¯é˜Ÿåˆ—-MQ" class="headerlink" title="ä»€ä¹ˆæ˜¯æ¶ˆæ¯é˜Ÿåˆ—(MQ)"></a>ä»€ä¹ˆæ˜¯æ¶ˆæ¯é˜Ÿåˆ—(MQ)</h5><p>å…³äºæ¶ˆæ¯é˜Ÿåˆ—å¤§å®¶è‚¯å®šéƒ½ä¸é™Œç”Ÿï¼ŒåŸºæœ¬ä¸Šæ¯ä¸ªé¡¹ç›®ä¸­éƒ½ä¼šä½¿ç”¨åˆ°çš„æŠ€æœ¯ï¼Œåœ¨æˆ‘å‰å‡ æœŸçš„åšæ–‡ä¸­ä¹Ÿæœ‰ä»‹ç»ã€‚</p><p>&emsp;æ¶ˆæ¯é˜Ÿåˆ—æœ¬è´¨å°±æ˜¯é€»è¾‘æ‰§è¡Œé¡ºåºï¼Œé˜Ÿåˆ—å°±å¦‚åŒä¸€æ‘ç¢—å †æ”¾åœ¨ä¸€èµ·ï¼Œä½ æ¯æ”¾ä¸€ä¸ªç¢—éƒ½ä¼šæ”¾åœ¨è¿™èºç¢—çš„æœ€ä¸Šé¢ï¼Œå½“ä½ æ‹¿ç¢—çš„æ—¶å€™ä¹Ÿæ˜¯åªèƒ½ä»æœ€ä¸Šé¢æ‹¿ã€‚è¿™ä¸ªå¦‚åŒé˜Ÿåˆ—çš„æ¶ˆè´¹ç‰¹æ€§ï¼ˆé˜Ÿåˆ—çš„ç‰¹æ€§æ˜¯å…ˆè¿›å…ˆå‡ºï¼Œå…ˆè¿›åå‡ºï¼Œé“ç†æ˜¯ä¸€æ ·çš„ï¼‰ã€‚<br><img src="/Laravelæ¶ˆæ¯é˜Ÿåˆ—/img/1.png"></p><h5 id="ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—ï¼Ÿ"></a>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—ï¼Ÿ</h5><ul><li>æé«˜ç³»ç»Ÿæ€§èƒ½ï¼ˆå‰Šå³°ï¼Œå‡å°‘å“åº”æ—¶é—´ï¼‰ã€‚<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># å‡è®¾ä½ æœ‰ä¸€ä¸ªè¿™æ ·çš„æ¥å£</span><br><span class="line"># æ–°ç”¨æˆ·æ³¨å†Œå‘é€é‚®ä»¶éªŒè¯ç </span><br><span class="line">public function SendMailCode(Request $request)&#123;</span><br><span class="line">    $mail = $request-&gt;input(&apos;mail);</span><br><span class="line">    SendReminderEmail::dispatch($mail); // æŠŠé‚®ç®±åŠ å…¥é˜Ÿåˆ—</span><br><span class="line">    return &apos;éªŒè¯ç å‘é€æˆåŠŸï¼Œè¯·æ³¨æ„æŸ¥æ”¶ï¼&apos;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p>&emsp;å‡è®¾æ³¨å†Œæ¥å£çš„å¹¶å‘åœ¨1ç§’100ï¼Œåœ¨ä½¿ç”¨é˜Ÿåˆ—çš„æƒ…å†µä¸‹å‘é€é‚®ä»¶è¿™ä¸ªæ“ä½œæ˜¯å¼‚æ­¥çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å½“ç¬¬100åç”¨æˆ·ç‚¹å‡»è·å–éªŒè¯ç åç«‹åˆ»å°±èƒ½è·å¾—å“åº”ï¼Œæ— éœ€ç­‰å¾…å‰99åæ‰€æœ‰é‚®ä»¶å‘é€æˆåŠŸåæ‰èƒ½å¾—åˆ°ç›¸åº”ï¼Œè¿™å°±æ˜¯ä¸é˜»å¡ã€‚<br>å½“<code>SendReminderEmail::dispatch($mail)</code>æ‰§è¡Œä¹‹åç«‹åˆ»å°±ä¼šæ‰§è¡Œ <code>return &#39;éªŒè¯ç å‘é€æˆåŠŸï¼Œè¯·æ³¨æ„æŸ¥æ”¶ï¼&#39;</code>ï¼Œæ§åˆ¶å™¨ä¸éœ€è¦çŸ¥é“é‚®ä»¶æ˜¯å¦å‘é€æˆåŠŸï¼Œå‡å°‘äº†é˜»å¡çš„ç­‰å¾…æ—¶é—´ã€‚</p><ul><li>é™ä½ç³»ç»Ÿçš„è€¦åˆæ€§ã€‚<br>ä¼ ç»Ÿå†™æ³•<img src="/Laravelæ¶ˆæ¯é˜Ÿåˆ—/img/3.png">æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMQï¼‰å†™æ³•<img src="/Laravelæ¶ˆæ¯é˜Ÿåˆ—/img/4.png"><h5 id="æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMQï¼‰çš„ä¼˜ç¼ºç‚¹"><a href="#æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMQï¼‰çš„ä¼˜ç¼ºç‚¹" class="headerlink" title="æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMQï¼‰çš„ä¼˜ç¼ºç‚¹"></a>æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMQï¼‰çš„ä¼˜ç¼ºç‚¹</h5></li><li>ä¼˜ç‚¹ï¼šä¸Šè¾¹å·²ç»è®²è¿‡äº†ã€‚</li><li>ç¼ºç‚¹ï¼š<br>&emsp; (1)ç³»ç»Ÿå¯ç”¨æ€§é™ä½:å¯ä»¥çœ‹å‡ºå¼•å…¥äº†MQä¹‹åï¼Œå¦‚æœMQæŒ‚äº†ç›¸å½“äºæ•´ä¸ªæ—¥å¿—ç³»ç»Ÿä¹Ÿéšä¹‹å´©æºƒã€‚<br>&emsp; (2)ç³»ç»Ÿå¤æ‚æ€§æé«˜:å¼•å…¥MQå¢åŠ äº†ç»´æŠ¤ç³»ç»Ÿçš„å·¥ä½œé‡ï¼Œå‡ºç°é—®é¢˜çš„å¯èƒ½æ€§ä¼šæ›´é«˜ã€‚<br>&emsp; (3)ä¸€è‡´æ€§é—®é¢˜ã€‚</li></ul><h4 id="é˜Ÿåˆ—çš„åº”ç”¨"><a href="#é˜Ÿåˆ—çš„åº”ç”¨" class="headerlink" title="é˜Ÿåˆ—çš„åº”ç”¨"></a>é˜Ÿåˆ—çš„åº”ç”¨</h4><p>&emsp;Laravelä¸­çš„æ¶ˆæ¯é˜Ÿåˆ—å°±éå¸¸ç®€å•äº†ï¼Œä»–å¯ä»¥è®¾ç½®é©±åŠ¨å’Œæ‰§è¡Œæ–¹å¼ã€‚</p><h5 id="å®‰è£…æ‰©å±•"><a href="#å®‰è£…æ‰©å±•" class="headerlink" title="å®‰è£…æ‰©å±•"></a>å®‰è£…æ‰©å±•</h5><ul><li>aws/aws-sdk-php ~3.0</li><li>pda/pheanstalk ~3.0</li><li>predis/predis ~1.0</li></ul><h5 id="ç”Ÿæˆä»»åŠ¡ç±»"><a href="#ç”Ÿæˆä»»åŠ¡ç±»" class="headerlink" title="ç”Ÿæˆä»»åŠ¡ç±»"></a>ç”Ÿæˆä»»åŠ¡ç±»</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php artisan make:job SendReminderEmail</span><br></pre></td></tr></table></figure><h5 id="ä»»åŠ¡ç±»ç»“æ„"><a href="#ä»»åŠ¡ç±»ç»“æ„" class="headerlink" title="ä»»åŠ¡ç±»ç»“æ„"></a>ä»»åŠ¡ç±»ç»“æ„</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">App</span>\<span class="title">Jobs</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Bus</span>\<span class="title">Queueable</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Contracts</span>\<span class="title">Queue</span>\<span class="title">ShouldQueue</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Foundation</span>\<span class="title">Bus</span>\<span class="title">Dispatchable</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Queue</span>\<span class="title">InteractsWithQueue</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Queue</span>\<span class="title">SerializesModels</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SendReminderEmail</span> <span class="keyword">implements</span> <span class="title">ShouldQueue</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">Dispatchable</span>, <span class="title">InteractsWithQueue</span>, <span class="title">Queueable</span>, <span class="title">SerializesModels</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> $id; <span class="comment">// æ¥æ”¶å¤–éƒ¨ä¼ å…¥çš„å‚æ•°</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Create a new job instance.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> void</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($id)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;id = $id; <span class="comment">// æ¥æ”¶å¤–éƒ¨ä¼ å…¥çš„å‚æ•°</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Execute the job.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> void</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">handle</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'jobsss'</span> . <span class="keyword">$this</span>-&gt;id;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="åŠ å…¥é˜Ÿåˆ—"><a href="#åŠ å…¥é˜Ÿåˆ—" class="headerlink" title="åŠ å…¥é˜Ÿåˆ—"></a>åŠ å…¥é˜Ÿåˆ—</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> <span class="title">SendReminderEmail</span>;</span><br><span class="line">SendReminderEmail::dispatch($id); <span class="comment">// åŠ å…¥é˜Ÿåˆ—</span></span><br><span class="line">ehco <span class="number">1</span>;</span><br></pre></td></tr></table></figure><h5 id="æµ‹è¯•ç»“æœ"><a href="#æµ‹è¯•ç»“æœ" class="headerlink" title="æµ‹è¯•ç»“æœ"></a>æµ‹è¯•ç»“æœ</h5><p>&emsp;ï¼ˆ1ï¼‰å½“æˆ‘æœªå¼€å¯æ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡çš„æƒ…å†µä¸‹ï¼Œç›´æ¥è¯·æ±‚æ¥å£ï¼Œä¼šè¿”å›1ã€‚<br>&emsp;ï¼ˆ2ï¼‰å¼€å¯æ¶ˆæ¯é˜Ÿåˆ—<br><img src="/Laravelæ¶ˆæ¯é˜Ÿåˆ—/img/5.png"></p><h4 id="æ¶ˆæ¯é˜Ÿåˆ—çš„é€‰æ‹©"><a href="#æ¶ˆæ¯é˜Ÿåˆ—çš„é€‰æ‹©" class="headerlink" title="æ¶ˆæ¯é˜Ÿåˆ—çš„é€‰æ‹©"></a>æ¶ˆæ¯é˜Ÿåˆ—çš„é€‰æ‹©</h4><p>&emsp;ä¸€èˆ¬æƒ…å†µä¸‹å¤§éƒ¨åˆ†ä¸šåŠ¡éƒ½ä½¿ç”¨çš„æ˜¯redisçš„æ¶ˆæ¯é˜Ÿåˆ—ã€‚åŠ å…¥ä½ ä»¬å…¬å¸ä¸šåŠ¡é‡éå¸¸å¤§ï¼Œå‡ åƒä¸‡ç”šè‡³å‡ äº¿å°±å¿…é¡»è€ƒè™‘ä½¿ç”¨å…¶ä»–çš„MQå·¥å…·ã€‚å¦‚<code>ActiveMQ</code>ã€<code>RabbitMQ</code>ã€<code>RocketMQ</code>ã€<code>Kafka</code>ã€‚</p><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>&emsp;Laravelçš„æ¶ˆæ¯é˜Ÿåˆ—åº”ç”¨æ¯”è¾ƒç®€å•ä¸”éå¸¸çš„å¥½ç”¨ï¼Œå»ºè®®å¤§å®¶å¯ä»¥å°è¯•ä¸€ä¸‹ã€‚å…·ä½“å¯ä»¥çœ‹<a href="https://learnku.com/docs/laravel/6.x/queues/5168" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;æ€ç»´å¯¼å›¾&quot;&gt;&lt;a href=&quot;#æ€ç»´å¯¼å›¾&quot; class=&quot;headerlink&quot; title=&quot;æ€ç»´å¯¼å›¾&quot;&gt;&lt;/a&gt;æ€ç»´å¯¼å›¾&lt;/h4&gt;&lt;img src=&quot;/Laravelæ¶ˆæ¯é˜Ÿåˆ—/img/2.png&quot;&gt;
    
    </summary>
    
    
      <category term="laravel" scheme="http://www.daichongweb.com/tags/laravel/"/>
    
  </entry>
  
  <entry>
    <title>æ¶æ„ä¹‹è·¯-mysqlä¸»ä»å¤åˆ¶é…ç½®ç¯‡</title>
    <link href="http://www.daichongweb.com/%E6%9E%B6%E6%9E%84%E4%B9%8B%E8%B7%AF-mysql%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E9%85%8D%E7%BD%AE%E7%AF%87/"/>
    <id>http://www.daichongweb.com/æ¶æ„ä¹‹è·¯-mysqlä¸»ä»å¤åˆ¶é…ç½®ç¯‡/</id>
    <published>2019-11-12T05:09:52.000Z</published>
    <updated>2020-08-19T03:46:29.229Z</updated>
    
    <content type="html"><![CDATA[<h4 id="å‰ç¯‡å›å¿†"><a href="#å‰ç¯‡å›å¿†" class="headerlink" title="å‰ç¯‡å›å¿†"></a>å‰ç¯‡å›å¿†</h4><p>ä¸Šä¸€ç¯‡ä»‹ç»äº†ä¸»ä»å¤åˆ¶çš„æ­å»ºçš„åŸºç¡€æµç¨‹ï¼Œä¸ºè¿™ç¯‡çš„é…ç½®åšäº†é“ºå«ã€‚ä¾¿äºç†è§£æ˜¯è¿™ç¯‡æœ€å¤§çš„äº®ç‚¹ï¼Œè¯´å®è¯ç»è¿‡äº²æ‰‹å°è¯•äº†ä¸»ä»å¤åˆ¶ä¹‹åï¼Œæ„Ÿè§‰è¿™ä¸ªä¸œè¥¿ç¡®å®ä¸éš¾ï¼Œå°±ç®€å•çš„æ”¹å‡ ä¸ªé…ç½®å°±å¯ä»¥æå®šï¼Œä½†æ˜¯ä½œä¸ºé«˜çº§ç¨‹åºä¼˜åŒ–çš„ä¸€éƒ¨åˆ†ï¼Œå­¦ä¹ è¿˜æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚<br><a id="more"></a></p><h4 id="é…ç½®ä»‹ç»"><a href="#é…ç½®ä»‹ç»" class="headerlink" title="é…ç½®ä»‹ç»"></a>é…ç½®ä»‹ç»</h4><h5 id="ç¡®è®¤ç¯å¢ƒ"><a href="#ç¡®è®¤ç¯å¢ƒ" class="headerlink" title="ç¡®è®¤ç¯å¢ƒ"></a>ç¡®è®¤ç¯å¢ƒ</h5><p>1.æœåŠ¡å™¨1å·ï¼š192.168.22.130ï¼ˆä¸»åº“æœåŠ¡å™¨ï¼‰<br><img src="/æ¶æ„ä¹‹è·¯-mysqlä¸»ä»å¤åˆ¶é…ç½®ç¯‡/img/1.png"><br>2.æœåŠ¡å™¨2å·ï¼š192.168.22.128ï¼ˆä»åº“æœåŠ¡å™¨ï¼‰<br><img src="/æ¶æ„ä¹‹è·¯-mysqlä¸»ä»å¤åˆ¶é…ç½®ç¯‡/img/2.png"></p><h5 id="ä¸»åº“é…ç½®"><a href="#ä¸»åº“é…ç½®" class="headerlink" title="ä¸»åº“é…ç½®"></a>ä¸»åº“é…ç½®</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/my.cnf</span><br><span class="line"><span class="meta">#</span><span class="bash"> é…ç½®ä¸»åº“æ ‡è¯†ï¼ˆè¿™é‡Œæ•°å­—éšæ„ï¼Œä½†æ˜¯ä¸€å®šè¦æ¯”ä»åº“é…ç½®çš„æ•°å­—å¤§ï¼Œå¿…é¡»æ˜¯æ•°å­—ï¼‰</span></span><br><span class="line">server_id=1</span><br><span class="line"><span class="meta">#</span><span class="bash"> å¼€å¯æ—¥å¿—åŠŸèƒ½&amp;é…ç½®æ—¥å¿—æ–‡ä»¶</span></span><br><span class="line">log_bin=master_log</span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¿å­˜é€€å‡º&amp;é‡å¯mysqlæœåŠ¡</span></span><br><span class="line">systemctl restart mysqld</span><br></pre></td></tr></table></figure><img src="/æ¶æ„ä¹‹è·¯-mysqlä¸»ä»å¤åˆ¶é…ç½®ç¯‡/img/3.png"><h5 id="é…ç½®ä»åº“è¿æ¥ç”¨æˆ·"><a href="#é…ç½®ä»åº“è¿æ¥ç”¨æˆ·" class="headerlink" title="é…ç½®ä»åº“è¿æ¥ç”¨æˆ·"></a>é…ç½®ä»åº“è¿æ¥ç”¨æˆ·</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç™»é™†mysql</span></span><br><span class="line">mysql -uroot -p</span><br><span class="line"><span class="comment"># è¿›å…¥mysqlåº“</span></span><br><span class="line">use mysql</span><br><span class="line"><span class="comment"># æ–°å¢ä¸€ä¸ªç”¨æˆ·ï¼Œå¹¶ä¸”ç»‘å®šè¿™ä¸ªç”¨æˆ·åªèƒ½ä»192.168.22.128è¿™ä¸ªIPè®¿é—®</span></span><br><span class="line">grant all privileges on *.* to <span class="string">'slave'</span>@<span class="string">'192.168.22.128'</span> identified by <span class="string">'slave123'</span> with grant option;</span><br><span class="line"><span class="comment"># åˆ·æ–°æƒé™</span></span><br><span class="line">flush privileges;</span><br><span class="line"><span class="comment"># è¿™é‡Œè¦æ³¨æ„ï¼ŒçœŸå®çš„æ­£å¼ç¯å¢ƒé…ç½®éœ€è¦è§„å®šä»åº“çš„è¿æ¥IPï¼Œä¸èƒ½è®¾ç½®ä¸º*ã€‚</span></span><br><span class="line"><span class="comment"># å¯†ç ä¸èƒ½è®¾ç½®è¿‡äºç®€å•ï¼Œæœ€å°‘æ˜¯å­—æ¯å’Œæ•°å­—ç»„åˆçš„6ä½ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚</span></span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹ä¸»åº“çŠ¶æ€<code>show master status</code><br><img src="/æ¶æ„ä¹‹è·¯-mysqlä¸»ä»å¤åˆ¶é…ç½®ç¯‡/img/4.png"><br>è¿™é‡Œçš„<code>File</code>å°±æ˜¯ä¸»åº“çš„<code>binlog</code>æ–‡ä»¶ã€‚</p><h5 id="ä»åº“é…ç½®"><a href="#ä»åº“é…ç½®" class="headerlink" title="ä»åº“é…ç½®"></a>ä»åº“é…ç½®</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/my.cnf</span><br><span class="line"><span class="comment"># è¿™é‡Œåªéœ€è¦é…ç½®ä¸€ä¸ªæ ‡è¯†å°±è¡Œ(ä¸€å®šè¦æ¯”ä¸»åº“çš„æ ‡è¯†æ•°å­—å°)</span></span><br><span class="line">server_id=2</span><br><span class="line"><span class="comment"># é‡å¯mysqlæœåŠ¡</span></span><br><span class="line">systemctl restart mysqld</span><br><span class="line"><span class="comment"># å…³é—­slave</span></span><br><span class="line">stop slave</span><br><span class="line"><span class="comment"># ç»™ä»åº“é…ç½®ä¸»åº“å‚æ•°</span></span><br><span class="line">mysql&gt; change master to</span><br><span class="line">-&gt; master_host=<span class="string">"ipåœ°å€"</span>ï¼Œ</span><br><span class="line">-&gt; master_user=<span class="string">"æˆæƒæ—¶æŒ‡å®šçš„ç”¨æˆ·å"</span>ï¼Œ</span><br><span class="line">-&gt; master_password=<span class="string">"ç”¨æˆ·å¯†ç "</span>ï¼Œ</span><br><span class="line">-&gt; master_log_file=<span class="string">"binlogæ—¥å¿—"</span>ï¼Œ</span><br><span class="line">-&gt; master_log_pos=åç§»é‡ï¼›</span><br><span class="line"><span class="comment"># é‡å¯ä»åº“æœåŠ¡</span></span><br><span class="line">start slave</span><br><span class="line"><span class="comment"># æµ‹è¯•æ˜¯å¦æ­£å¸¸è¿æ¥</span></span><br><span class="line">show slave status \G;</span><br><span class="line"><span class="comment"># å¦‚æœæŠ¥é”™error connecting to master 'repluse@192.168.22.130:3306' - retry-time: 60 retries:1</span></span><br><span class="line"><span class="comment"># è¯·æ£€æŸ¥å¯†ç æ˜¯ä¸æ˜¯é…ç½®é”™äº†</span></span><br></pre></td></tr></table></figure><h5 id="æœ€åæµ‹è¯•åŒæ­¥"><a href="#æœ€åæµ‹è¯•åŒæ­¥" class="headerlink" title="æœ€åæµ‹è¯•åŒæ­¥"></a>æœ€åæµ‹è¯•åŒæ­¥</h5><p>å†ä¸»åº“åˆ›å»ºä¸€ä¸ªæ•°æ®è¡¨ï¼Œç„¶ååˆ·æ–°ä»åº“çœ‹çœ‹æ˜¯å¦åŒæ­¥æˆåŠŸã€‚<br><img src="/æ¶æ„ä¹‹è·¯-mysqlä¸»ä»å¤åˆ¶é…ç½®ç¯‡/img/5.gif"></p><h5 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h5><p>æ€»ä½“æµç¨‹ä¸‹æ¥å¾ˆç®€å•ã€æµç¨‹ä¹Ÿä¸å¤æ‚ã€å‡ºç°å¥‡æ€ªé—®é¢˜çš„å‡ ç‡å°ã€‚<br>å¦‚æœåœ¨é…ç½®ä¸­é‡åˆ°é—®é¢˜ï¼Œå¯åœ¨è¯„è®ºåŒºæé—®ï¼Œæˆ‘ä¼šç¬¬ä¸€æ—¶é—´å›å¤ã€‚<br><strong>é¢„å‘Šï¼šä¸‹ä¸€ç¯‡æ˜¯è¯»å†™åˆ†ç¦»çš„é…ç½®</strong></p>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;å‰ç¯‡å›å¿†&quot;&gt;&lt;a href=&quot;#å‰ç¯‡å›å¿†&quot; class=&quot;headerlink&quot; title=&quot;å‰ç¯‡å›å¿†&quot;&gt;&lt;/a&gt;å‰ç¯‡å›å¿†&lt;/h4&gt;&lt;p&gt;ä¸Šä¸€ç¯‡ä»‹ç»äº†ä¸»ä»å¤åˆ¶çš„æ­å»ºçš„åŸºç¡€æµç¨‹ï¼Œä¸ºè¿™ç¯‡çš„é…ç½®åšäº†é“ºå«ã€‚ä¾¿äºç†è§£æ˜¯è¿™ç¯‡æœ€å¤§çš„äº®ç‚¹ï¼Œè¯´å®è¯ç»è¿‡äº²æ‰‹å°è¯•äº†ä¸»ä»å¤åˆ¶ä¹‹åï¼Œæ„Ÿè§‰è¿™ä¸ªä¸œè¥¿ç¡®å®ä¸éš¾ï¼Œå°±ç®€å•çš„æ”¹å‡ ä¸ªé…ç½®å°±å¯ä»¥æå®šï¼Œä½†æ˜¯ä½œä¸ºé«˜çº§ç¨‹åºä¼˜åŒ–çš„ä¸€éƒ¨åˆ†ï¼Œå­¦ä¹ è¿˜æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="æ¶æ„" scheme="http://www.daichongweb.com/tags/%E6%9E%B6%E6%9E%84/"/>
    
  </entry>
  
  <entry>
    <title>æ¶æ„ä¹‹è·¯-mysqlä¸»ä»å¤åˆ¶åŸºç¡€æ­å»ºç¯‡</title>
    <link href="http://www.daichongweb.com/%E6%9E%B6%E6%9E%84%E4%B9%8B%E8%B7%AF-mysql%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E5%9F%BA%E7%A1%80%E6%90%AD%E5%BB%BA%E7%AF%87/"/>
    <id>http://www.daichongweb.com/æ¶æ„ä¹‹è·¯-mysqlä¸»ä»å¤åˆ¶åŸºç¡€æ­å»ºç¯‡/</id>
    <published>2019-11-12T02:18:09.000Z</published>
    <updated>2020-08-19T03:46:29.225Z</updated>
    
    <content type="html"><![CDATA[<h4 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h4><p>æœ¬æ–‡ä»‹ç»çš„æ˜¯åœ¨è™šæ‹Ÿæœºä¸Šæ­å»ºï¼Œå®é™…æƒ…å†µå…¶å®å’ŒçœŸæ­£çš„çº¿ä¸Šç¯å¢ƒä¸€æ¯›ä¸€æ ·ï¼Œä½¿ç”¨çš„ç³»ç»Ÿæ˜¯Centos 7ã€‚</p><h4 id="ä»€ä¹ˆæ˜¯ä¸»ä»å¤åˆ¶ï¼ŸåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯ä¸»ä»å¤åˆ¶ï¼ŸåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ä¸»ä»å¤åˆ¶ï¼ŸåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ä¸»ä»å¤åˆ¶ï¼ŸåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</h4><p>ç­”ï¼šç®€å•ç‚¹ç†è§£ï¼Œä¸»ä»å¤åˆ¶å…¶å®å°±æ˜¯ä¸¤ä¸ªæ•°æ®åº“æ•°æ®çš„é¡¹ç›®å¤‡ä»½è¿‡ç¨‹ã€‚å…¶åŸç†å°±æ˜¯ä¸»åº“äº§ç”Ÿçš„æ“ä½œéƒ½ä¼šç”Ÿæˆ<code>binlog</code>ä¼ å…¥ä»åº“ï¼Œä»åº“é€šè¿‡<code>I/O</code>çº¿ç¨‹æŠŠ<code>binlog</code>å†™å…¥<code>relaylog</code>ï¼Œç„¶åä»åº“åˆ›å»º<code>I/O</code>çº¿ç¨‹æ‰§è¡Œ<code>relaylog</code>è¿›è¡Œæ•°æ®å¤‡ä»½ã€‚<br><a id="more"></a></p><h4 id="æµç¨‹å›¾"><a href="#æµç¨‹å›¾" class="headerlink" title="æµç¨‹å›¾"></a>æµç¨‹å›¾</h4><img src="/æ¶æ„ä¹‹è·¯-mysqlä¸»ä»å¤åˆ¶åŸºç¡€æ­å»ºç¯‡/img/1.png"><h4 id="ä¸ºä»€ä¹ˆè¦åšä¸»ä»å¤åˆ¶ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆè¦åšä¸»ä»å¤åˆ¶ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆè¦åšä¸»ä»å¤åˆ¶ï¼Ÿ"></a>ä¸ºä»€ä¹ˆè¦åšä¸»ä»å¤åˆ¶ï¼Ÿ</h4><p>ç­”ï¼šä¸€æ–¹é¢æ˜¯ä¸ºäº†å¤‡ä»½æ•°æ®ï¼Œé˜²æ­¢æ•°æ®ä¸¢å¤±å’Œç ´åï¼Œå¦ä¸€æ–¹é¢æ˜¯ä¸ºè¯»å†™åˆ†ç¦»åšé“ºå«ã€‚</p><h4 id="æ­å»ºæ­¥éª¤"><a href="#æ­å»ºæ­¥éª¤" class="headerlink" title="æ­å»ºæ­¥éª¤"></a>æ­å»ºæ­¥éª¤</h4><h5 id="æ–°å»ºè™šæ‹Ÿæœº"><a href="#æ–°å»ºè™šæ‹Ÿæœº" class="headerlink" title="æ–°å»ºè™šæ‹Ÿæœº"></a>æ–°å»ºè™šæ‹Ÿæœº</h5><p>é¦–å…ˆåœ¨æœ¬åœ°å®‰è£…è™šæ‹Ÿæœºï¼Œæˆ‘ä¸ªäººæ¯”è¾ƒæ¨è <code>VMware Workstation Pro</code>ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æ˜¯ä½¿ç”¨å…¶ä»–çš„ã€‚<br>è™šæ‹Ÿæœºçš„å®‰è£…å°±ä¸åšä»‹ç»äº†ï¼Œæ— ééƒ½æ˜¯ä¸‹ä¸€æ­¥ä¸‹ä¸€æ­¥ã€‚å®‰è£…å¥½ä¹‹ååœ¨éœ€è¦ä¸‹è½½å¯¹ç”¨çš„ç³»ç»Ÿé•œåƒï¼Œå› ä¸ºæœ¬æ–‡ä¸»è¦æ˜¯åœ¨<code>Centos</code>ä¸Šåšæ¼”ç¤ºï¼Œæ‰€ä»¥æˆ‘å°±ä¸‹è½½äº†<code>Centos</code>çš„é•œåƒï¼Œä½†æ˜¯æ— æ³•åˆ†äº«ç»™å¤§å®¶ï¼Œå› ä¸ºå¤ªå¤§äº†ï¼Œè¶³è¶³<code>4G</code>ã€‚</p><p>å®‰è£…å¥½ä¹‹åæ–°å»ºä¸¤ä¸ªè™šæ‹Ÿæœº(æ€ä¹ˆæ–°å»ºè™šæ‹Ÿæœºå°±ä¸åšä»‹ç»äº†):<br><img src="/æ¶æ„ä¹‹è·¯-mysqlä¸»ä»å¤åˆ¶åŸºç¡€æ­å»ºç¯‡/img/2.png"></p><h5 id="å®‰è£…mysql"><a href="#å®‰è£…mysql" class="headerlink" title="å®‰è£…mysql"></a>å®‰è£…mysql</h5><p>æ³¨æ„ï¼šå°½é‡ä¸¤ä¸ªè™šæ‹Ÿæœºä¸Šçš„mysqlç‰ˆæœ¬ä¿æŒä¸€ç›´ï¼Œé¿å…å‡ºç°ä¸å¯é¢„çŸ¥çš„é”™è¯¯ã€‚<br>æˆ‘å®‰è£…çš„ç‰ˆæœ¬æ˜¯5.7.<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> è¿›å…¥</span></span><br><span class="line">cd /usr/local/src</span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¸‹è½½rpmåŒ…</span></span><br><span class="line">wget https://dev.mysql.com/get/mysql57-community-release-el7-11.noarch.rpm</span><br><span class="line"><span class="meta">#</span><span class="bash"> å®‰è£…rpm</span></span><br><span class="line">rpm -ivh mysql57-community-release-el7-11.noarch.rpm</span><br><span class="line"><span class="meta">#</span><span class="bash"> å®‰è£… mysql-server</span></span><br><span class="line">yum install -y mysql-server</span><br><span class="line"><span class="meta">#</span><span class="bash"> å¯åŠ¨ </span></span><br><span class="line">systemctl start mysqld</span><br><span class="line"><span class="meta">#</span><span class="bash"> è®¾ç½®å¼€æœºè‡ªå¯</span></span><br><span class="line">systemctl enable mysqld</span><br><span class="line"><span class="meta">#</span><span class="bash"> ç™»é™†mysql</span></span><br><span class="line">mysql -uroot -p</span><br></pre></td></tr></table></figure></p><p>å› ä¸º5.7ä¹‹åçš„ç‰ˆæœ¬éƒ½æ˜¯ç¦æ­¢åŒ¿åç™»é™†çš„ï¼Œä½ å¯ä»¥é€šè¿‡æŸ¥çœ‹å¯†ç å¹¶ç™»é™†ï¼Œç„¶åä¿®æ”¹å¯†ç ï¼Œæˆ–è€…ç›´æ¥ä¿®æ”¹<code>my.cnf</code>æ¥ç¦æ­¢ç™»é™†éªŒè¯ã€‚<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /var/log/mysqld.log|grep 'A temporary password'</span><br></pre></td></tr></table></figure></p><p>å› ä¸ºç³»ç»Ÿç»™æˆ‘çš„é»˜è®¤å¯†ç å«æœ‰ä¸€äº›ç‰¹æ®Šç¬¦å·ï¼Œæˆ‘æ²¡æ³•è¾“å…¥ï¼Œæˆ‘åªèƒ½ä½¿ç”¨ç¬¬äºŒç§æ–¹æ³•ï¼š<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">vi \etc\my.cnf</span><br><span class="line"><span class="meta">#</span><span class="bash"> åœ¨æœ€åå¢åŠ ä¸€è¡Œ</span></span><br><span class="line">skip-grant-tables=1</span><br><span class="line"><span class="meta">#</span><span class="bash"> ç™»é™†mysqlï¼Œåˆ·æ–°æƒé™</span></span><br><span class="line">flush privileges;</span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¿®æ”¹å¯†ç </span></span><br><span class="line">use mysql;</span><br><span class="line">update user set password='password' where user='root'ï¼›</span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¿®æ”¹æˆåŠŸåå†æ¬¡åˆ·æ–°æƒé™</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æœ€åé‡å¯ä¸€ä¸‹mysqlæœåŠ¡</span></span><br></pre></td></tr></table></figure></p><h5 id="æœ¬åœ°è¿æ¥è™šæ‹Ÿæœºä¸Šçš„mysql"><a href="#æœ¬åœ°è¿æ¥è™šæ‹Ÿæœºä¸Šçš„mysql" class="headerlink" title="æœ¬åœ°è¿æ¥è™šæ‹Ÿæœºä¸Šçš„mysql"></a>æœ¬åœ°è¿æ¥è™šæ‹Ÿæœºä¸Šçš„mysql</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹IP</span></span><br><span class="line">ifconfig</span><br><span class="line"><span class="meta">#</span><span class="bash"> åœ¨æœ¬åœ°Cmdä¸­pingè¿™ä¸ªIP</span></span><br></pre></td></tr></table></figure><h5 id="ä½¿ç”¨telnetæµ‹è¯•mysqlè¿æ¥çŠ¶æ€"><a href="#ä½¿ç”¨telnetæµ‹è¯•mysqlè¿æ¥çŠ¶æ€" class="headerlink" title="ä½¿ç”¨telnetæµ‹è¯•mysqlè¿æ¥çŠ¶æ€"></a>ä½¿ç”¨telnetæµ‹è¯•mysqlè¿æ¥çŠ¶æ€</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">telnet 192.168.22.130 3360</span><br></pre></td></tr></table></figure><h5 id="é”™è¯¯çš„æƒ…å†µï¼ˆå› æˆ‘è¿™é‡Œæ˜¯å¥½çš„ï¼Œæ‰€ä»¥æˆ‘æŠŠ3306å¡«æˆäº†3360ï¼‰"><a href="#é”™è¯¯çš„æƒ…å†µï¼ˆå› æˆ‘è¿™é‡Œæ˜¯å¥½çš„ï¼Œæ‰€ä»¥æˆ‘æŠŠ3306å¡«æˆäº†3360ï¼‰" class="headerlink" title="é”™è¯¯çš„æƒ…å†µï¼ˆå› æˆ‘è¿™é‡Œæ˜¯å¥½çš„ï¼Œæ‰€ä»¥æˆ‘æŠŠ3306å¡«æˆäº†3360ï¼‰"></a>é”™è¯¯çš„æƒ…å†µï¼ˆå› æˆ‘è¿™é‡Œæ˜¯å¥½çš„ï¼Œæ‰€ä»¥æˆ‘æŠŠ3306å¡«æˆäº†3360ï¼‰</h5><img src="/æ¶æ„ä¹‹è·¯-mysqlä¸»ä»å¤åˆ¶åŸºç¡€æ­å»ºç¯‡/img/3.png"><h5 id="æ£€æŸ¥è™šæ‹Ÿæœºæ˜¯å¦å®‰è£…äº†iptables"><a href="#æ£€æŸ¥è™šæ‹Ÿæœºæ˜¯å¦å®‰è£…äº†iptables" class="headerlink" title="æ£€æŸ¥è™šæ‹Ÿæœºæ˜¯å¦å®‰è£…äº†iptables"></a>æ£€æŸ¥è™šæ‹Ÿæœºæ˜¯å¦å®‰è£…äº†iptables</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> å…³é—­é˜²ç«å¢™</span></span><br><span class="line">systemctl stop firewalld</span><br><span class="line"><span class="meta">#</span><span class="bash"> ç¦æ­¢é˜²ç«å¢™</span></span><br><span class="line">systemctl mask firewalld</span><br><span class="line"><span class="meta">#</span><span class="bash"> ç¦æ­¢å¼€æœºå¯åŠ¨</span></span><br><span class="line">systemctl disable firewalld</span><br><span class="line"><span class="meta">#</span><span class="bash"> å¦‚æœå®åœ¨ä¸è¡Œï¼Œè¿˜è¦æŠŠselinuxå…³é—­</span></span><br><span class="line">vi /etc/selinux/config</span><br><span class="line">SELINUX=disabled</span><br></pre></td></tr></table></figure><img src="/æ¶æ„ä¹‹è·¯-mysqlä¸»ä»å¤åˆ¶åŸºç¡€æ­å»ºç¯‡/img/4.png"><img src="/æ¶æ„ä¹‹è·¯-mysqlä¸»ä»å¤åˆ¶åŸºç¡€æ­å»ºç¯‡/img/5.png"><p>å†æ¬¡ä½¿ç”¨<code>telnet 192.168.22.130 3306</code>è¿˜æ˜¯æŠ¥é”™ä¸Šè¾¹å›¾ç‰‡æ‰€ç¤ºæ—¶ã€‚</p><h5 id="é…ç½®æƒé™"><a href="#é…ç½®æƒé™" class="headerlink" title="é…ç½®æƒé™"></a>é…ç½®æƒé™</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> åˆ›å»ºä¸€ä¸ªç”¨æˆ·</span></span><br><span class="line">GRANT ALL PRIVILEGES ON *.* TO 'daichong'@'%' IDENTIFIED BY 'daichong' WITH GRANT OPTION;</span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ·æ–°æƒé™</span></span><br><span class="line">FLUSH PRIVILEGES;</span><br><span class="line"><span class="meta">#</span><span class="bash"> è¿™é‡Œæ³¨æ„çœŸå®çº¿ä¸Šæƒ…å†µæƒé™ä¸èƒ½è¿™ä¹ˆå¼€</span></span><br></pre></td></tr></table></figure><img src="/æ¶æ„ä¹‹è·¯-mysqlä¸»ä»å¤åˆ¶åŸºç¡€æ­å»ºç¯‡/img/6.png"><p>å‡ºç°è¿™ä¸ªè¯´æ˜å·²ç»æˆåŠŸäº†</p><h5 id="ä½¿ç”¨navicatè¿æ¥"><a href="#ä½¿ç”¨navicatè¿æ¥" class="headerlink" title="ä½¿ç”¨navicatè¿æ¥"></a>ä½¿ç”¨navicatè¿æ¥</h5><img src="/æ¶æ„ä¹‹è·¯-mysqlä¸»ä»å¤åˆ¶åŸºç¡€æ­å»ºç¯‡/img/7.png"><p>åˆ°è¿™é‡ŒåŸºç¡€çš„å®‰è£…å·²ç»å®Œæˆäº†ï¼Œå¦‚æœé‡åˆ°é—®é¢˜å¯åœ¨è¯„è®ºä¸­æé—®ï¼Œä¸‹ä¸€ç¯‡ä»‹ç»ä¸»ä»å¤åˆ¶å¦‚ä½•é…ç½®ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;å¼•è¨€&quot;&gt;&lt;a href=&quot;#å¼•è¨€&quot; class=&quot;headerlink&quot; title=&quot;å¼•è¨€&quot;&gt;&lt;/a&gt;å¼•è¨€&lt;/h4&gt;&lt;p&gt;æœ¬æ–‡ä»‹ç»çš„æ˜¯åœ¨è™šæ‹Ÿæœºä¸Šæ­å»ºï¼Œå®é™…æƒ…å†µå…¶å®å’ŒçœŸæ­£çš„çº¿ä¸Šç¯å¢ƒä¸€æ¯›ä¸€æ ·ï¼Œä½¿ç”¨çš„ç³»ç»Ÿæ˜¯Centos 7ã€‚&lt;/p&gt;
&lt;h4 id=&quot;ä»€ä¹ˆæ˜¯ä¸»ä»å¤åˆ¶ï¼ŸåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ&quot;&gt;&lt;a href=&quot;#ä»€ä¹ˆæ˜¯ä¸»ä»å¤åˆ¶ï¼ŸåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ&quot; class=&quot;headerlink&quot; title=&quot;ä»€ä¹ˆæ˜¯ä¸»ä»å¤åˆ¶ï¼ŸåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ&quot;&gt;&lt;/a&gt;ä»€ä¹ˆæ˜¯ä¸»ä»å¤åˆ¶ï¼ŸåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/h4&gt;&lt;p&gt;ç­”ï¼šç®€å•ç‚¹ç†è§£ï¼Œä¸»ä»å¤åˆ¶å…¶å®å°±æ˜¯ä¸¤ä¸ªæ•°æ®åº“æ•°æ®çš„é¡¹ç›®å¤‡ä»½è¿‡ç¨‹ã€‚å…¶åŸç†å°±æ˜¯ä¸»åº“äº§ç”Ÿçš„æ“ä½œéƒ½ä¼šç”Ÿæˆ&lt;code&gt;binlog&lt;/code&gt;ä¼ å…¥ä»åº“ï¼Œä»åº“é€šè¿‡&lt;code&gt;I/O&lt;/code&gt;çº¿ç¨‹æŠŠ&lt;code&gt;binlog&lt;/code&gt;å†™å…¥&lt;code&gt;relaylog&lt;/code&gt;ï¼Œç„¶åä»åº“åˆ›å»º&lt;code&gt;I/O&lt;/code&gt;çº¿ç¨‹æ‰§è¡Œ&lt;code&gt;relaylog&lt;/code&gt;è¿›è¡Œæ•°æ®å¤‡ä»½ã€‚&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="æ¶æ„" scheme="http://www.daichongweb.com/tags/%E6%9E%B6%E6%9E%84/"/>
    
  </entry>
  
  <entry>
    <title>laravelæ¨¡å‹å…³è”æŸ¥è¯¢ä¸JOINå“ªä¸ªæ€§èƒ½å¥½</title>
    <link href="http://www.daichongweb.com/laravel%E6%A8%A1%E5%9E%8B%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2%E4%B8%8EJOIN%E5%93%AA%E4%B8%AA%E6%80%A7%E8%83%BD%E5%A5%BD/"/>
    <id>http://www.daichongweb.com/laravelæ¨¡å‹å…³è”æŸ¥è¯¢ä¸JOINå“ªä¸ªæ€§èƒ½å¥½/</id>
    <published>2019-11-08T08:34:03.000Z</published>
    <updated>2020-08-19T03:46:29.181Z</updated>
    
    <content type="html"><![CDATA[<p><strong>åˆå­¦Laravel</strong></p><p>æœ€è¿‘æ¥æ‰‹ä¸€ä¸ªæ–°é¡¹ç›®ï¼Œæ•´ä¸ªé¡¹ç›®å®Œå…¨çœ‹ä¸åˆ°<code>left join</code>è¿™æ ·çš„å†™æ³•ï¼Œæˆ‘æ‰“å°äº†æ¨¡å‹å…³è”æŸ¥è¯¢åçš„<code>sql</code>åå‘ç°è·Ÿå¸¸æœ‰çš„æŸ¥è¯¢å†™æ³•å®Œå…¨ä¸åŒã€‚<br>åŸè°…æˆ‘ä¸€ç›´æ˜¯ä¸ªç å†œï¼Œå‡ ä¹æ²¡è§è¿‡è¿™æ ·çš„å†™æ³•ï¼Œä¸€ç›´æƒ³å¯¹æ¯”ä¸€ä¸‹è¿™æ ·çš„å†™æ³•å’Œå¸¸ç”¨çš„å†™æ³•æ€§èƒ½æ–¹é¢åˆ°åº•æœ‰ä»€ä¹ˆå·®åˆ«ã€‚<br><a id="more"></a><br><strong>ä¸€ä¸ªå°æ —å­</strong></p><p>æ¨¡å‹å…³è”ç”Ÿæˆçš„sql<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="string">`comment`</span> <span class="keyword">where</span> <span class="keyword">exists</span> (<span class="keyword">select</span> * <span class="keyword">from</span> <span class="string">`post_comment`</span> <span class="keyword">where</span> <span class="string">`comment`</span>.<span class="string">`id`</span> = <span class="string">`post_comment`</span>.<span class="string">`comment_id`</span> <span class="keyword">and</span> <span class="string">`post_id`</span> = ?)</span><br></pre></td></tr></table></figure></p><p>å¸¸ç”¨æŸ¥è¯¢<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="string">`comment`</span>.id,<span class="string">`comment`</span>.info,<span class="string">`comment`</span>.user_id <span class="keyword">from</span> <span class="string">`comment`</span> <span class="keyword">left</span> <span class="keyword">join</span> post_comment <span class="keyword">on</span> <span class="string">`comment`</span>.id = <span class="string">`post_comment`</span>.comment_id <span class="keyword">where</span> post_comment.post_id = ?</span><br></pre></td></tr></table></figure></p><p>å•ä»<code>sql</code>ä¸Šçœ‹åŒºåˆ«è¿˜æ˜¯æŒºå¤§çš„ï¼Œå†åšç å†œçš„æœŸé—´ï¼Œæœ€å¸¸å¬åˆ°çš„å°±æ˜¯é“¾è¡¨æŸ¥è¯¢æ€§èƒ½ä¸å¥½ã€‚ä½†æ˜¯è¿˜çœŸä¸èƒ½ç¡®å®šè¿™ä¸¤ä¸ª<code>sql</code>åˆ°åº•å“ªä¸ªæ€§èƒ½å¥½ä¸€ç‚¹ï¼Œæ²¡åŠæ³•åªèƒ½æµ‹è¯•ä¸€ä¸‹ã€‚</p><h3 id="posts-Tables"><a href="#posts-Tables" class="headerlink" title="posts Tables"></a>posts Tables</h3><table><thead><tr><th style="text-align:left">id</th><th style="text-align:center">title</th><th style="text-align:right">time</th></tr></thead><tbody><tr><td style="text-align:left">1</td><td style="text-align:center">æ¨¡å‹å…³è”æŸ¥è¯¢</td><td style="text-align:right">2019-11-08</td></tr><tr><td style="text-align:left">2</td><td style="text-align:center">left join æŸ¥è¯¢</td><td style="text-align:right">2019-11-08</td></tr></tbody></table><h3 id="comment-Tables"><a href="#comment-Tables" class="headerlink" title="comment Tables"></a>comment Tables</h3><table><thead><tr><th style="text-align:left">id</th><th style="text-align:center">info</th><th style="text-align:right">time</th></tr></thead><tbody><tr><td style="text-align:left">1</td><td style="text-align:center">æ¨¡å‹å…³è”æŸ¥è¯¢çš„æ€§èƒ½å¥½</td><td style="text-align:right">2019-11-08</td></tr><tr><td style="text-align:left">2</td><td style="text-align:center">left join æŸ¥è¯¢çš„æ€§èƒ½å¥½</td><td style="text-align:right">2019-11-08</td></tr><tr><td style="text-align:left">3</td><td style="text-align:center">ä¸¤ä¸ªéƒ½æŒºå¥½</td><td style="text-align:right">2019-11-08</td></tr></tbody></table><h3 id="post-comment-Tables"><a href="#post-comment-Tables" class="headerlink" title="post_comment Tables"></a>post_comment Tables</h3><table><thead><tr><th style="text-align:left">id</th><th style="text-align:center">post_id</th><th style="text-align:right">comment_id</th></tr></thead><tbody><tr><td style="text-align:left">1</td><td style="text-align:center">1</td><td style="text-align:right">1</td></tr><tr><td style="text-align:left">2</td><td style="text-align:center">2</td><td style="text-align:right">2</td></tr><tr><td style="text-align:left">3</td><td style="text-align:center">3</td><td style="text-align:right">2</td></tr></tbody></table><p>ä¸ºäº†é¿å…äº‰è®®ï¼Œæˆ‘æ·»åŠ äº†ä¸€äº›æ¯”è¾ƒåˆç†çš„æ•°æ®ã€‚</p><h4 id="æ•°æ®é‡"><a href="#æ•°æ®é‡" class="headerlink" title="æ•°æ®é‡"></a>æ•°æ®é‡</h4><table><thead><tr><th style="text-align:left">posts</th><th style="text-align:center">comment</th><th style="text-align:right">post_comment</th></tr></thead><tbody><tr><td style="text-align:left">29999æ¡</td><td style="text-align:center">29999æ¡</td><td style="text-align:right">29999æ¡</td></tr></tbody></table><h4 id="ä¸‹é¢ä½¿ç”¨EXPLAINè¿›è¡Œåˆ†æ"><a href="#ä¸‹é¢ä½¿ç”¨EXPLAINè¿›è¡Œåˆ†æ" class="headerlink" title="ä¸‹é¢ä½¿ç”¨EXPLAINè¿›è¡Œåˆ†æ"></a>ä¸‹é¢ä½¿ç”¨EXPLAINè¿›è¡Œåˆ†æ</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">select</span> * <span class="keyword">from</span> <span class="string">`comment`</span> <span class="keyword">where</span> <span class="keyword">exists</span> (<span class="keyword">select</span> * <span class="keyword">from</span> <span class="string">`post_comment`</span> <span class="keyword">where</span> <span class="string">`comment`</span>.<span class="string">`id`</span> = <span class="string">`post_comment`</span>.<span class="string">`comment_id`</span> <span class="keyword">and</span> <span class="string">`post_id`</span> = <span class="number">2</span>)</span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:center">select_type</th><th style="text-align:right">table</th><th style="text-align:right">partitions</th><th style="text-align:right">type</th></tr></thead><tbody><tr><td style="text-align:center">PRIMARY</td><td style="text-align:right">comment</td><td style="text-align:right">NULL</td><td style="text-align:right">ALL</td></tr><tr><td style="text-align:center">DEPENDENT SUBQUERY</td><td style="text-align:right">post_comment</td><td style="text-align:right">NULL</td><td style="text-align:right">ref</td></tr></tbody></table><table><thead><tr><th style="text-align:right">possible_keys</th><th style="text-align:right">key</th><th style="text-align:right">key_len</th><th style="text-align:right">ref</th></tr></thead><tbody><tr><td style="text-align:right">NULL</td><td style="text-align:right">NULL</td><td style="text-align:right">NULL</td><td style="text-align:right">NULL</td></tr><tr><td style="text-align:right">post_id,comment_id</td><td style="text-align:right">post_id</td><td style="text-align:right">5</td><td style="text-align:right">const</td></tr></tbody></table><table><thead><tr><th style="text-align:right">rows</th><th style="text-align:right">filtered</th><th style="text-align:right">Extra</th></tr></thead><tbody><tr><td style="text-align:right">29999</td><td style="text-align:right">100.00</td><td style="text-align:right">Using where</td></tr><tr><td style="text-align:right">1</td><td style="text-align:right">10.00</td><td style="text-align:right">Using where</td></tr></tbody></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> <span class="string">`comment`</span>.id,<span class="string">`comment`</span>.info,<span class="string">`comment`</span>.user_id <span class="keyword">from</span> <span class="string">`comment`</span> <span class="keyword">left</span> <span class="keyword">join</span> post_comment <span class="keyword">on</span> <span class="string">`comment`</span>.id = <span class="string">`post_comment`</span>.comment_id <span class="keyword">where</span> post_comment.post_id = <span class="number">2</span></span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:left">select_type</th><th style="text-align:center">table</th><th style="text-align:right">partitions</th></tr></thead><tbody><tr><td style="text-align:left">SIMPLE</td><td style="text-align:center">post_comment</td><td style="text-align:right">NULL</td></tr><tr><td style="text-align:left">SIMPLE</td><td style="text-align:center">comment</td><td style="text-align:right">NULL</td></tr></tbody></table><table><thead><tr><th style="text-align:right">type</th><th style="text-align:right">possible_keys</th><th style="text-align:right">key</th><th style="text-align:right">key_len</th></tr></thead><tbody><tr><td style="text-align:right">ref</td><td style="text-align:right">post_id,comment_id</td><td style="text-align:right">post_id</td><td style="text-align:right">5</td></tr><tr><td style="text-align:right">eq_ref</td><td style="text-align:right">PRIMARY</td><td style="text-align:right">PRIMARY</td><td style="text-align:right">4</td></tr></tbody></table><table><thead><tr><th style="text-align:right">ref</th><th style="text-align:right">rows</th><th style="text-align:right">filtered</th><th style="text-align:right">Extra</th></tr></thead><tbody><tr><td style="text-align:right">const</td><td style="text-align:right">1</td><td style="text-align:right">100.00</td><td style="text-align:right">Using where</td></tr><tr><td style="text-align:right">test.post_comment.comment_id</td><td style="text-align:right">1</td><td style="text-align:right">100.00</td><td style="text-align:right">NULL</td></tr></tbody></table><p>ä»ä¸Šè¾¹çš„<code>EXPLAIN</code>ç»“æœæ¥çœ‹ï¼Œ<code>left join</code>æ¯”æ¨¡å‹å…³è”çš„å†™æ³•æ•ˆç‡é«˜å¤ªå¤šäº†ï¼Œä¹‹åæˆ‘åœ¨<code>laravel</code>ç¤¾åŒºä¹Ÿå‘å¸ƒäº†ç›¸å…³çš„æé—®ï¼Œå¾—åˆ°çš„ç»“è®ºæ˜¯<code>æ•°æ®é‡å¤§çš„æ—¶å€™ç”¨JOINï¼Œæ•°æ®é‡å°çš„æ—¶å€™ç”¨æ¨¡å‹</code>ã€‚</p><p>ä»å¾—çš„çš„ç»“è®ºæ¥çœ‹ï¼Œæ¨¡å‹å¹¶é€‚åˆå¤§æ•°æ®æŸ¥è¯¢ï¼Œä½†æ˜¯å¯¹ä¸€äº›æ–°å¢ã€ä¿®æ”¹ã€åˆ é™¤æ“ä½œæä¾›äº†å¾ˆå¥½çš„æ•ˆæœï¼</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;åˆå­¦Laravel&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æœ€è¿‘æ¥æ‰‹ä¸€ä¸ªæ–°é¡¹ç›®ï¼Œæ•´ä¸ªé¡¹ç›®å®Œå…¨çœ‹ä¸åˆ°&lt;code&gt;left join&lt;/code&gt;è¿™æ ·çš„å†™æ³•ï¼Œæˆ‘æ‰“å°äº†æ¨¡å‹å…³è”æŸ¥è¯¢åçš„&lt;code&gt;sql&lt;/code&gt;åå‘ç°è·Ÿå¸¸æœ‰çš„æŸ¥è¯¢å†™æ³•å®Œå…¨ä¸åŒã€‚&lt;br&gt;åŸè°…æˆ‘ä¸€ç›´æ˜¯ä¸ªç å†œï¼Œå‡ ä¹æ²¡è§è¿‡è¿™æ ·çš„å†™æ³•ï¼Œä¸€ç›´æƒ³å¯¹æ¯”ä¸€ä¸‹è¿™æ ·çš„å†™æ³•å’Œå¸¸ç”¨çš„å†™æ³•æ€§èƒ½æ–¹é¢åˆ°åº•æœ‰ä»€ä¹ˆå·®åˆ«ã€‚&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="laravel" scheme="http://www.daichongweb.com/tags/laravel/"/>
    
  </entry>
  
  <entry>
    <title>laravelæ¨¡å‹å…³è”</title>
    <link href="http://www.daichongweb.com/laravel%E6%A8%A1%E5%9E%8B%E5%85%B3%E8%81%94/"/>
    <id>http://www.daichongweb.com/laravelæ¨¡å‹å…³è”/</id>
    <published>2019-11-06T09:30:11.000Z</published>
    <updated>2020-08-19T03:46:29.181Z</updated>
    
    <content type="html"><![CDATA[<p><b>ä¸€å¯¹ä¸€</b></p><p>&emsp;ä»€ä¹ˆæ˜¯ä¸€å¯¹å¤šï¼Ÿ</p><p>&emsp;åœ¨ç¨‹åºè§’åº¦è®²ï¼šä¸€å¯¹å¤šåŸºæœ¬ä¸Šéƒ½æ˜¯ç”¨æ¥æè¿°ä¸¤ä¸ªæ•°æ®è¡¨ä¹‹é—´çš„å…³ç³»ã€‚</p><p>&emsp;å‡è®¾ç°æœ‰ä¸¤ä¸ªæ•°æ®è¡¨ï¼šï¼ˆ1ï¼‰æ–‡ç« è¡¨posts ï¼ˆ2ï¼‰è¯„è®ºè¡¨commentã€‚ä¸€ä¸ªæ–‡ç« å¯ä»¥æœ‰å¤šä¸ªè¯„è®ºï¼Œä½†ä¸€ä¸ªè¯„è®ºåªèƒ½å±äºä¸€ä¸ªæ–‡ç« ï¼Œç›¸å¯¹äºè¯„è®ºæ¥è¯´å®ƒä¸æ–‡ç« çš„å…³ç³»æ˜¯å¤šå¯¹ä¸€ï¼Œç›¸å¯¹ä¸æ–‡ç« æ¥è¯´å®ƒä¸è¯„è®ºçš„å…³ç³»æ˜¯ä¸€å¯¹å¤šï¼Œè¿™ä¹Ÿå°±æ˜¯laravelé‡Œåå‘å…³è”çš„åŸºç¡€ã€‚</p><p><em>æ–‡ç« è¡¨posts</em></p><table><th>id</th><th>title</th><th>time</th><tr><td>1</td><td>ä»€ä¹ˆæ˜¯ä¸€å¯¹ä¸€ï¼Ÿ</td><td>2019-11-07</td></tr><tr><td>2</td><td>ä»€ä¹ˆæ˜¯ä¸€å¯¹å¤šï¼Ÿ</td><td>2019-11-08</td></tr><tr><td>3</td><td>ä»€ä¹ˆæ˜¯å¤šå¯¹å¤šï¼Ÿ</td><td>2019-11-06</td></tr></table><br><a id="more"></a><br><br><em>è¯„è®ºè¡¨comment</em><br><br><table><th>id</th><th>info</th><th>user_id</th><tr><td>1</td><td>æˆ‘çŸ¥é“ä»€ä¹ˆæ˜¯ä¸€å¯¹ä¸€ã€‚</td><td>10086</td></tr><tr><td>2</td><td>æˆ‘çŸ¥é“ä»€ä¹ˆæ˜¯ä¸€å¯¹å¤šã€‚</td><td>10085</td></tr><tr><td>3</td><td>æˆ‘çŸ¥é“ä»€ä¹ˆæ˜¯å¤šå¯¹å¤šã€‚</td><td>10084</td></tr><td>4</td><td>è¿™è°ä¸çŸ¥é“å•Šï¼</td><td>10084</td></table><p><em>ä¸­é—´è¡¨posts_commentï¼ˆä¹Ÿå¯ä»¥å«åšå…³ç³»è¡¨ï¼‰</em></p><table><th>id</th><th>post_id</th><th>comment_id</th><tr><td>1</td><td>1</td><td>1</td></tr><tr><td>2</td><td>2</td><td>2</td></tr><tr><td>3</td><td>3</td><td>3</td></tr><tr><td>4</td><td>3</td><td>4</td></tr></table><p>&emsp;ä»è¡¨çš„ç»“æ„å¯ä»¥çœ‹å‡ºæ¥ï¼ŒID=1ã€2çš„æ–‡ç« åªæœ‰ä¸€æ¡è¯„è®ºï¼ŒID=3çš„æ–‡ç« æœ‰ä¸¤æ¡è¯„è®ºã€‚</p><p>&emsp;é‚£ä¹ˆè¿™æ˜¯è¦æœ‰ä¸ªä¸šåŠ¡ï¼Œå·²çŸ¥æ–‡ç« çš„ID=3ï¼Œè¯·ä½¿ç”¨laravelçš„æ¨¡å‹å…³è”æ‰¾å‡ºè¯¥æ–‡ç« ä¸‹çš„æ‰€æœ‰è¯„è®ºã€‚</p><p>&emsp;é¦–å…ˆç¡®è®¤ä¸¤ä¸ªè¡¨ä¹‹é—´çš„å…³ç³»ï¼Œä¸€ä¸ªè¯„è®ºåœ¨ä¸­é—´è¡¨åªæœ‰ä¸€æ¡æ•°æ®ï¼Œä¸­é—´è¡¨é‡Œçš„comment_idè‚¯å®šæ˜¯å”¯ä¸€çš„ï¼Œä¸å¯èƒ½å‡ºç°ä¸€ä¸ªè¯„è®ºåŒæ—¶å±äºä¸¤ä¸ªæ–‡ç« ï¼Œæ‰€ä»¥å®ƒä»¬ä¹‹é—´çš„å…³ç³»æ˜¯<em>ä¸€å¯¹ä¸€</em>ã€‚<a>ä½†æ˜¯ï¼Œä½ ä¼šå‘ç°ä½¿ç”¨hasMany(å¤šå¯¹å¤š)å…³è”æ–¹æ³•è·å–çš„æ•°æ®å±…ç„¶æ˜¯ä¸€æ ·çš„</a>ã€‚</p><figure class="highlight plain"><figcaption><span>æ¨¡å‹å…³è”</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># ä¸€å¯¹å¤šå†™æ³•</span><br><span class="line">public function comments()</span><br><span class="line">&#123;</span><br><span class="line">    return $this-&gt;hasMany(&apos;App\Models\PostComment&apos;, &apos;comment_id&apos;, &apos;id&apos;);</span><br><span class="line">&#125;</span><br><span class="line"># ä¸€å¯¹ä¸€å†™æ³•</span><br><span class="line">public function comment()</span><br><span class="line">&#123;</span><br><span class="line">    return $this-&gt;hasOne(&apos;App\Models\PostComment&apos;, &apos;comment_id&apos;, &apos;id&apos;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><figcaption><span>æŸ¥è¯¢å†™æ³•ä½¿ç”¨ï¼ˆwithï¼‰</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public function list()</span><br><span class="line">&#123;</span><br><span class="line">    $postId = 3;</span><br><span class="line">    $data = \App\Models\Comment::with(&apos;comments&apos;)-&gt;whereHas(&quot;comments&quot;, function ($query) use ($postId) &#123;</span><br><span class="line">        return $query-&gt;where(&quot;post_id&quot;, $postId);</span><br><span class="line">    &#125;)-&gt;get();</span><br><span class="line">    dump($data-&gt;toArray());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><figcaption><span>è·å–çš„æ•°æ®ç»“æœï¼ˆä½¿ç”¨withï¼‰</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"># with(&apos;comments);</span><br><span class="line">array:2 [â–¼</span><br><span class="line">  0 =&gt; array:4 [â–¼</span><br><span class="line">    &quot;id&quot; =&gt; 3</span><br><span class="line">    &quot;info&quot; =&gt; &quot;\tæˆ‘çŸ¥é“ä»€ä¹ˆæ˜¯å¤šå¯¹å¤š&quot;</span><br><span class="line">    &quot;user_id&quot; =&gt; 10084</span><br><span class="line">    &quot;comments&quot; =&gt; array:1 [â–¼</span><br><span class="line">      0 =&gt; array:3 [â–¼</span><br><span class="line">        &quot;id&quot; =&gt; 3</span><br><span class="line">        &quot;post_id&quot; =&gt; 3</span><br><span class="line">        &quot;comment_id&quot; =&gt; 3</span><br><span class="line">      ]</span><br><span class="line">    ]</span><br><span class="line">  ]</span><br><span class="line">  1 =&gt; array:4 [â–¼</span><br><span class="line">    &quot;id&quot; =&gt; 4</span><br><span class="line">    &quot;info&quot; =&gt; &quot;è¿™è°ä¸çŸ¥é“å•Šï¼&quot;</span><br><span class="line">    &quot;user_id&quot; =&gt; 10084</span><br><span class="line">    &quot;comments&quot; =&gt; array:1 [â–¼</span><br><span class="line">      0 =&gt; array:3 [â–¼</span><br><span class="line">        &quot;id&quot; =&gt; 4</span><br><span class="line">        &quot;post_id&quot; =&gt; 3</span><br><span class="line">        &quot;comment_id&quot; =&gt; 4</span><br><span class="line">      ]</span><br><span class="line">    ]</span><br><span class="line">  ]</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"># with(&apos;comment);</span><br><span class="line">array:2 [â–¼</span><br><span class="line">  0 =&gt; array:4 [â–¼</span><br><span class="line">    &quot;id&quot; =&gt; 3</span><br><span class="line">    &quot;info&quot; =&gt; &quot;\tæˆ‘çŸ¥é“ä»€ä¹ˆæ˜¯å¤šå¯¹å¤š&quot;</span><br><span class="line">    &quot;user_id&quot; =&gt; 10084</span><br><span class="line">    &quot;comment&quot; =&gt; array:3 [â–¼</span><br><span class="line">      &quot;id&quot; =&gt; 3</span><br><span class="line">      &quot;post_id&quot; =&gt; 3</span><br><span class="line">      &quot;comment_id&quot; =&gt; 3</span><br><span class="line">    ]</span><br><span class="line">  ]</span><br><span class="line">  1 =&gt; array:4 [â–¼</span><br><span class="line">    &quot;id&quot; =&gt; 4</span><br><span class="line">    &quot;info&quot; =&gt; &quot;è¿™è°ä¸çŸ¥é“å•Šï¼&quot;</span><br><span class="line">    &quot;user_id&quot; =&gt; 10084</span><br><span class="line">    &quot;comment&quot; =&gt; array:3 [â–¼</span><br><span class="line">      &quot;id&quot; =&gt; 4</span><br><span class="line">      &quot;post_id&quot; =&gt; 3</span><br><span class="line">      &quot;comment_id&quot; =&gt; 4</span><br><span class="line">    ]</span><br><span class="line">  ]</span><br><span class="line">]</span><br></pre></td></tr></table></figure><figure class="highlight plain"><figcaption><span>æ‰§è¡Œçš„SQLï¼ˆä½¿ç”¨withï¼‰</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># ä¸¤æ¬¡sqlæ˜¯ä¸€æ ·çš„</span><br><span class="line">array:2 [â–¼</span><br><span class="line">  0 =&gt; array:3 [â–¼</span><br><span class="line">    &quot;query&quot; =&gt; &quot;select * from `comment` where exists (select * from `post_comment` where `comment`.`id` = `post_comment`.`comment_id` and `post_id` = ?)&quot;</span><br><span class="line">    &quot;bindings&quot; =&gt; array:1 [â–¶]</span><br><span class="line">    &quot;time&quot; =&gt; 12.67</span><br><span class="line">  ]</span><br><span class="line">  1 =&gt; array:3 [â–¼</span><br><span class="line">    &quot;query&quot; =&gt; &quot;select * from `post_comment` where `post_comment`.`comment_id` in (3, 4)&quot;</span><br><span class="line">    &quot;bindings&quot; =&gt; []</span><br><span class="line">    &quot;time&quot; =&gt; 0.21</span><br><span class="line">  ]</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>&emsp;æˆ‘ä»¬åˆ†æä¸€ä¸‹laravelåº•å±‚çš„å¤„ç†é€»è¾‘ï¼Œä»ä¸Šè¾¹çš„sqlå¯ä»¥çœ‹å‡ºä½¿ç”¨æ¨¡å‹å…³è”ç¬¬ä¸€æ­¥ä¼šä½¿ç”¨ä¸€ä¸ªåµŒå¥—æŸ¥è¯¢æ‰¾å‡ºcommentåœ¨post_commenté‡Œå­˜åœ¨çš„ç»“æœé›†ï¼Œæœ€ç»ˆçš„å¾—åˆ°çš„ç»“æœæ˜¯3ã€4ã€‚éšåä¼šåšä¸€ä¸ªINæŸ¥è¯¢å¾—åˆ°æœ€ç»ˆcomment.id=3ã€4çš„æ•°æ®æœ€ååˆå¹¶æˆç»“æœé›†è¿”å›ã€‚</p><figure class="highlight plain"><figcaption><span>æŸ¥è¯¢å†™æ³•ä½¿ç”¨ï¼ˆä¸ä½¿ç”¨withï¼‰</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public function list()</span><br><span class="line">&#123;</span><br><span class="line">    $postId = 3;</span><br><span class="line"></span><br><span class="line">    $data = \App\Models\Comment::whereHas(&quot;comment&quot;, function ($query) use ($postId) &#123;</span><br><span class="line">        return $query-&gt;where(&quot;post_id&quot;, $postId);</span><br><span class="line">    &#125;)-&gt;get();</span><br><span class="line">    dump($data-&gt;toArray());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><figcaption><span>æ‰§è¡Œçš„SQLï¼ˆä¸ä½¿ç”¨withï¼‰</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># ä¸¤æ¬¡æ‰§è¡Œsqlä¹Ÿæ˜¯ä¸€æ ·çš„</span><br><span class="line">array:1 [â–¼</span><br><span class="line">  0 =&gt; array:3 [â–¼</span><br><span class="line">    &quot;query&quot; =&gt; &quot;select * from `comment` where exists (select * from `post_comment` where `comment`.`id` = `post_comment`.`comment_id` and `post_id` = ?)&quot;</span><br><span class="line">    &quot;bindings&quot; =&gt; array:1 [â–¶]</span><br><span class="line">    &quot;time&quot; =&gt; 2.82</span><br><span class="line">  ]</span><br><span class="line">]</span><br></pre></td></tr></table></figure><figure class="highlight plain"><figcaption><span>æŸ¥è¯¢çš„ç»“æœï¼ˆä¸ä½¿ç”¨withï¼‰</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># å¾—åˆ°çš„ç»“æœä¹Ÿæ˜¯ä¸€æ ·çš„</span><br><span class="line">array:2 [â–¼</span><br><span class="line">  0 =&gt; array:3 [â–¼</span><br><span class="line">    &quot;id&quot; =&gt; 3</span><br><span class="line">    &quot;info&quot; =&gt; &quot;\tæˆ‘çŸ¥é“ä»€ä¹ˆæ˜¯å¤šå¯¹å¤š&quot;</span><br><span class="line">    &quot;user_id&quot; =&gt; 10084</span><br><span class="line">  ]</span><br><span class="line">  1 =&gt; array:3 [â–¼</span><br><span class="line">    &quot;id&quot; =&gt; 4</span><br><span class="line">    &quot;info&quot; =&gt; &quot;è¿™è°ä¸çŸ¥é“å•Šï¼&quot;</span><br><span class="line">    &quot;user_id&quot; =&gt; 10084</span><br><span class="line">  ]</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>&emsp;ä¸¤ç§å†™æ³•çš„ç«¯å¼‚æƒ³å¿…å¤§å®¶éƒ½èƒ½çœ‹å¾—å‡ºæ¥ï¼Œå°±ä¸å†ä»‹ç»äº†ã€‚</p><p><b>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ¨¡å‹å…³è”å‘¢ï¼Ÿ</b></p><p>&emsp;å‡è®¾æŸä¸€ä¸ªæ–‡ç« è¢«è¯„è®ºäº†ï¼Œåœ¨ä¸ä½¿ç”¨æ¨¡å‹å…³è”çš„æƒ…å†µä¸‹éœ€è¦è¿™æ ·å†™ï¼š</p><figure class="highlight plain"><figcaption><span>æ™®é€šå†™æ³•</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$mode = new \App\Models\Comment();</span><br><span class="line">$mode-&gt;info = &apos;æµ‹è¯•&apos;;</span><br><span class="line">$mode-&gt;user_id = 11;</span><br><span class="line">$mode-&gt;save();</span><br><span class="line"></span><br><span class="line">\App\Models\PostComment::create([</span><br><span class="line">  &apos;post_id&apos; =&gt; 3,</span><br><span class="line">  &apos;comment_id&apos; =&gt; $mode-&gt;id</span><br><span class="line">]);</span><br></pre></td></tr></table></figure><figure class="highlight plain"><figcaption><span>æ¨¡å‹å…³è”å†™æ³•</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$mode = new \App\Models\Comment();</span><br><span class="line">$mode-&gt;info = &apos;æµ‹è¯•&apos;;</span><br><span class="line">$mode-&gt;user_id = 11;</span><br><span class="line">$mode-&gt;save();</span><br><span class="line"></span><br><span class="line">$mode-&gt;comment()-&gt;create([</span><br><span class="line">    &apos;post_id&apos; =&gt; 3,</span><br><span class="line">]);</span><br></pre></td></tr></table></figure><p>&emsp;è€Œä¸”æˆ‘çš„å…¬å¸æœ‰è§„å®šä¸èƒ½ä½¿ç”¨left joinå†™æ³•ï¼Œè€Œä¸”æ¨¡å‹ä¸­ä¸å…è®¸å†™æœ‰å…³ä¸šåŠ¡çš„ä»£ç ï¼Œè¿™æ ·å¤§å¤§é™åˆ¶äº†éšå¿ƒæ‰€æ¬²å¼€å‘ï¼Œé™ä½äº†é¡¹ç›®çš„ç»´æŠ¤æˆæœ¬ã€‚å¹¶ä¸”åœ¨ä½¿ç”¨æ¨¡å‹å…³è”åï¼Œä¸€åˆ‡çš„ä»£ç å˜å¾—ç®€å•äº†ï¼Œå¯è¯»æ€§æé«˜ï¼Œå€’æ˜¯æ€§èƒ½è¿™å—æˆ‘æ²¡æœ‰çœŸæ­£çš„æµ‹è¯•è¿‡ï¼Œä¹‹åè‚¯å®šä¼šç ”ç©¶ä¸€ä¸‹ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;b&gt;ä¸€å¯¹ä¸€&lt;/b&gt;&lt;/p&gt;
&lt;p&gt;&amp;emsp;ä»€ä¹ˆæ˜¯ä¸€å¯¹å¤šï¼Ÿ&lt;/p&gt;
&lt;p&gt;&amp;emsp;åœ¨ç¨‹åºè§’åº¦è®²ï¼šä¸€å¯¹å¤šåŸºæœ¬ä¸Šéƒ½æ˜¯ç”¨æ¥æè¿°ä¸¤ä¸ªæ•°æ®è¡¨ä¹‹é—´çš„å…³ç³»ã€‚&lt;/p&gt;
&lt;p&gt;&amp;emsp;å‡è®¾ç°æœ‰ä¸¤ä¸ªæ•°æ®è¡¨ï¼šï¼ˆ1ï¼‰æ–‡ç« è¡¨posts ï¼ˆ2ï¼‰è¯„è®ºè¡¨commentã€‚ä¸€ä¸ªæ–‡ç« å¯ä»¥æœ‰å¤šä¸ªè¯„è®ºï¼Œä½†ä¸€ä¸ªè¯„è®ºåªèƒ½å±äºä¸€ä¸ªæ–‡ç« ï¼Œç›¸å¯¹äºè¯„è®ºæ¥è¯´å®ƒä¸æ–‡ç« çš„å…³ç³»æ˜¯å¤šå¯¹ä¸€ï¼Œç›¸å¯¹ä¸æ–‡ç« æ¥è¯´å®ƒä¸è¯„è®ºçš„å…³ç³»æ˜¯ä¸€å¯¹å¤šï¼Œè¿™ä¹Ÿå°±æ˜¯laravelé‡Œåå‘å…³è”çš„åŸºç¡€ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;æ–‡ç« è¡¨posts&lt;/em&gt;&lt;/p&gt;
&lt;table&gt;&lt;th&gt;id&lt;/th&gt;&lt;th&gt;title&lt;/th&gt;&lt;th&gt;time&lt;/th&gt;&lt;tr&gt;&lt;td&gt;1&lt;/td&gt;&lt;td&gt;ä»€ä¹ˆæ˜¯ä¸€å¯¹ä¸€ï¼Ÿ&lt;/td&gt;&lt;td&gt;2019-11-07&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;2&lt;/td&gt;&lt;td&gt;ä»€ä¹ˆæ˜¯ä¸€å¯¹å¤šï¼Ÿ&lt;/td&gt;&lt;td&gt;2019-11-08&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;3&lt;/td&gt;&lt;td&gt;ä»€ä¹ˆæ˜¯å¤šå¯¹å¤šï¼Ÿ&lt;/td&gt;&lt;td&gt;2019-11-06&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="laravel" scheme="http://www.daichongweb.com/tags/laravel/"/>
    
  </entry>
  
  <entry>
    <title>vue+elementå®æˆ˜ï¼ˆå…¥é—¨ç¯‡ ä¸€ï¼‰</title>
    <link href="http://www.daichongweb.com/vue-element%E5%AE%9E%E6%88%98%EF%BC%88%E5%85%A5%E9%97%A8%E7%AF%87%EF%BC%89/"/>
    <id>http://www.daichongweb.com/vue-elementå®æˆ˜ï¼ˆå…¥é—¨ç¯‡ï¼‰/</id>
    <published>2019-11-03T05:12:51.000Z</published>
    <updated>2020-08-19T03:46:29.213Z</updated>
    
    <content type="html"><![CDATA[<p><b>æˆ‘ä¸ºä»€ä¹ˆä¼šå­¦vueï¼Ÿ</b></p><p>&emsp;å­¦Vueä¹‹å‰ä¸€ç›´è§‰å¾—å®ƒå¥½éš¾ï¼Œé¦–å…ˆæºä»£ç çœ‹ä¸æ‡‚ï¼Œå¯¹äºæˆ‘ä¸€ä¸ªä¸»è¦æ˜¯åšPHPåç«¯æ¥è¯´ï¼Œçœ‹è§é‚£äº›importè¿˜æœ‰å“ªäº›èŠ±é‡Œèƒ¡å“¨çš„è¯­æ³•ï¼ŒçœŸçš„æ˜¯å¤ªéš¾çœ‹æ‡‚äº†ã€‚<br><img src="/vue-elementå®æˆ˜ï¼ˆå…¥é—¨ç¯‡ï¼‰/img/vue.jpg"><br>&emsp;åæ¥åœ¨æœºç¼˜å·§åˆçš„è¿›äº†ä¸€å®¶åå°æ˜¯ç”¨vue+elementæ­å»ºçš„å…¬å¸ï¼Œå› ä¸ºå…¬å¸çš„å‰ç«¯å°±ä¸€ä¸ªï¼Œå…³é”®è¿˜æ˜¯ä¸ªå¦¹å­ï¼Œä¹Ÿä¸å¥½æ„ç»™å¥¹å¢åŠ å·¥ä½œé‡ï¼ŒåŸºæœ¬ä¸Šç®¡ç†åå°çš„åç«¯ä»£ç å’Œå‰ç«¯ä»£ç éƒ½éœ€è¦æˆ‘æ¥å†™ã€‚</p><p>&emsp;å¥½åœ¨æ¡†æ¶å·²ç»æ­å»ºå¥½äº†ï¼Œæˆ‘åªéœ€è¦å†™ä¸€äº›æ•°æ®äº¤äº’å’Œæ•°æ®æ¸²æŸ“ã€‚</p><p>&emsp;æ›´æ·±å…¥çš„äº†è§£Vueçš„è®¾è®¡æ€æƒ³ç‚¹å‡»è¿™é‡Œï¼š <a href="https://cn.vuejs.org/" target="_blank" rel="noopener">Vueå®˜ç½‘</a>ã€<a href="https://www.cnblogs.com/baiyang2292/p/11172675.html" target="_blank" rel="noopener">Vueè®¾è®¡æ€æƒ³</a>ã€‚<br><a id="more"></a></p><p><b>vueåˆ°åº•éš¾ä¸éš¾ï¼Ÿ</b></p><p>&emsp;ä»æˆ‘çœŸæ­£æ¥è§¦vueæ¥è¯´ï¼Œæƒ³çœŸæ­£æŠŠvueæ‘¸é€ç¡®å®å¾ˆéš¾ï¼Œä½†æ˜¯åªæƒ³å­¦ä¼šæ€ä¹ˆç”¨vueæ­å»ºåå°ç®¡ç†ç³»ç»Ÿè¿™å€’ä¸éš¾ã€‚</p><p>&emsp;å½“ç„¶è¿™éœ€è¦ä½ æœ‰ç‚¹å‰ç«¯çš„åŸºç¡€ï¼ˆhtml\css\jsï¼‰ï¼Œåœ¨æ²¡æœ‰å‰ç«¯çš„åŸºç¡€æƒ…å†µä¸‹ï¼Œå…¥é—¨vueç¡®å®æœ‰ç‚¹éš¾ã€‚</p><p><b>æœ‰ä¸€å®šå‰ç«¯çš„åŸºç¡€çš„æƒ…å†µä¸‹ï¼Œæ€ä¹ˆå¿«é€Ÿçš„å…¥é—¨vueï¼Ÿ</b></p><p>&emsp;é¦–å…ˆä½ è¦çŸ¥é“vue+elementUiæˆ–è€…å…¶ä»–uiå¼€å‘çš„æ ¸å¿ƒæ˜¯ä»€ä¹ˆï¼Ÿ</p><p>&emsp;ç®€å•çš„ä¸¾ä¸ªæ —å­ï¼š</p><figure class="highlight js"><figcaption><span>å°æ —å­</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;el-table :data=<span class="string">"tableData"</span>&gt;</span><br><span class="line">      &lt;el-table-column prop=<span class="string">"date"</span> label=<span class="string">"æ—¥æœŸ"</span>&gt;&lt;<span class="regexp">/el-table-column&gt;</span></span><br><span class="line"><span class="regexp">      &lt;el-table-column prop="name" label="å§“å"&gt;&lt;/</span>el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=<span class="string">"address"</span> label=<span class="string">"åœ°å€"</span>&gt;&lt;<span class="regexp">/el-table-column&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>el-table&gt;</span><br><span class="line">  &lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp">  &lt;script&gt;</span></span><br><span class="line"><span class="regexp">    export default &#123;</span></span><br><span class="line"><span class="regexp">      data() &#123;</span></span><br><span class="line"><span class="regexp">        return &#123;</span></span><br><span class="line"><span class="regexp">          tableData: [&#123;</span></span><br><span class="line"><span class="regexp">            date: '2016-05-02',</span></span><br><span class="line"><span class="regexp">            name: 'ç‹å°è™',</span></span><br><span class="line"><span class="regexp">            address: 'ä¸Šæµ·å¸‚æ™®é™€åŒºé‡‘æ²™æ±Ÿè·¯ 1518 å¼„'</span></span><br><span class="line"><span class="regexp">          &#125;, &#123;</span></span><br><span class="line"><span class="regexp">            date: '2016-05-04',</span></span><br><span class="line"><span class="regexp">            name: 'ç‹å°è™',</span></span><br><span class="line"><span class="regexp">            address: 'ä¸Šæµ·å¸‚æ™®é™€åŒºé‡‘æ²™æ±Ÿè·¯ 1517 å¼„'</span></span><br><span class="line"><span class="regexp">          &#125;, &#123;</span></span><br><span class="line"><span class="regexp">            date: '2016-05-01',</span></span><br><span class="line"><span class="regexp">            name: 'ç‹å°è™',</span></span><br><span class="line"><span class="regexp">            address: 'ä¸Šæµ·å¸‚æ™®é™€åŒºé‡‘æ²™æ±Ÿè·¯ 1519 å¼„'</span></span><br><span class="line"><span class="regexp">          &#125;, &#123;</span></span><br><span class="line"><span class="regexp">            date: '2016-05-03',</span></span><br><span class="line"><span class="regexp">            name: 'ç‹å°è™',</span></span><br><span class="line"><span class="regexp">            address: 'ä¸Šæµ·å¸‚æ™®é™€åŒºé‡‘æ²™æ±Ÿè·¯ 1516 å¼„'</span></span><br><span class="line"><span class="regexp">          &#125;]</span></span><br><span class="line"><span class="regexp">        &#125;</span></span><br><span class="line"><span class="regexp">      &#125;</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>script&gt;</span><br></pre></td></tr></table></figure><img src="/vue-elementå®æˆ˜ï¼ˆå…¥é—¨ç¯‡ï¼‰/img/table.png"><p>&emsp;ä»ä»£ç å¯ä»¥çœ‹å‡ºTableçš„æ•°æ®æ¥æºæ˜¯Jsé‡ŒtableDataæ•°ç»„ï¼Œå®ƒä»¬æ˜¯é€šè¿‡Vueçš„ç‰¹æ€§åŒå‘ç»‘å®šæ¥å®ç°çš„<a>:data=â€tableDataâ€</a>ï¼Œå­—æ®µé€šè¿‡<a>:prop=â€å­—æ®µåâ€</a>ã€‚</p><p>&emsp;é‚£ä¹ˆåœ¨çœŸå®æ•°æ®äº¤äº’çš„æƒ…å†µä¸‹å°±è¿™ä¹ˆå†™ï¼š</p><figure class="highlight js"><figcaption><span>å°æ —å­</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">      data() &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          tableData: []</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      created() &#123; <span class="comment">// é¡µé¢åˆ›å»ºåæ‰§è¡Œ</span></span><br><span class="line">        <span class="keyword">this</span>.getList(); <span class="comment">// æŸ¥è¯¢æ•°æ®</span></span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123; <span class="comment">// æ–¹æ³•é›†åˆ</span></span><br><span class="line">        getList()&#123;</span><br><span class="line">          axios(&#123; <span class="comment">// é¦–é€‰ä½ è¦å®‰è£… axios</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â method:<span class="string">'get'</span>,</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â url:<span class="string">'è¯·æ±‚åœ°å€'</span></span><br><span class="line">Â  Â  Â  Â  Â  &#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">resp</span>)</span>&#123;</span><br><span class="line">              <span class="comment">// è¯·æ±‚æˆåŠŸï¼ŒæŠŠæ•°æ®èµ‹å€¼ç»™tableData</span></span><br><span class="line">              <span class="keyword">this</span>.tableData = resp.data</span><br><span class="line">Â  Â  Â  Â  Â  &#125;).catch(<span class="function"><span class="params">resp</span> =&gt;</span> &#123;</span><br><span class="line">              <span class="comment">// è¯·æ±‚å¤±è´¥</span></span><br><span class="line">Â  Â  Â  Â  Â  &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><p>&emsp;å°±è¿™ä¹ˆç®€å•ï¼Œvue+element+axiosæ•°æ®äº¤äº’å’Œæ¸²æŸ“å·²ç»å®Œæˆäº†ï¼</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;b&gt;æˆ‘ä¸ºä»€ä¹ˆä¼šå­¦vueï¼Ÿ&lt;/b&gt;&lt;/p&gt;
&lt;p&gt;&amp;emsp;å­¦Vueä¹‹å‰ä¸€ç›´è§‰å¾—å®ƒå¥½éš¾ï¼Œé¦–å…ˆæºä»£ç çœ‹ä¸æ‡‚ï¼Œå¯¹äºæˆ‘ä¸€ä¸ªä¸»è¦æ˜¯åšPHPåç«¯æ¥è¯´ï¼Œçœ‹è§é‚£äº›importè¿˜æœ‰å“ªäº›èŠ±é‡Œèƒ¡å“¨çš„è¯­æ³•ï¼ŒçœŸçš„æ˜¯å¤ªéš¾çœ‹æ‡‚äº†ã€‚&lt;br&gt;&lt;img src=&quot;/vue-elementå®æˆ˜ï¼ˆå…¥é—¨ç¯‡ï¼‰/img/vue.jpg&quot;&gt;&lt;br&gt;&amp;emsp;åæ¥åœ¨æœºç¼˜å·§åˆçš„è¿›äº†ä¸€å®¶åå°æ˜¯ç”¨vue+elementæ­å»ºçš„å…¬å¸ï¼Œå› ä¸ºå…¬å¸çš„å‰ç«¯å°±ä¸€ä¸ªï¼Œå…³é”®è¿˜æ˜¯ä¸ªå¦¹å­ï¼Œä¹Ÿä¸å¥½æ„ç»™å¥¹å¢åŠ å·¥ä½œé‡ï¼ŒåŸºæœ¬ä¸Šç®¡ç†åå°çš„åç«¯ä»£ç å’Œå‰ç«¯ä»£ç éƒ½éœ€è¦æˆ‘æ¥å†™ã€‚&lt;/p&gt;
&lt;p&gt;&amp;emsp;å¥½åœ¨æ¡†æ¶å·²ç»æ­å»ºå¥½äº†ï¼Œæˆ‘åªéœ€è¦å†™ä¸€äº›æ•°æ®äº¤äº’å’Œæ•°æ®æ¸²æŸ“ã€‚&lt;/p&gt;
&lt;p&gt;&amp;emsp;æ›´æ·±å…¥çš„äº†è§£Vueçš„è®¾è®¡æ€æƒ³ç‚¹å‡»è¿™é‡Œï¼š &lt;a href=&quot;https://cn.vuejs.org/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Vueå®˜ç½‘&lt;/a&gt;ã€&lt;a href=&quot;https://www.cnblogs.com/baiyang2292/p/11172675.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Vueè®¾è®¡æ€æƒ³&lt;/a&gt;ã€‚&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="vue" scheme="http://www.daichongweb.com/tags/vue/"/>
    
  </entry>
  
  <entry>
    <title>Navicat Premium 12.1å®‰è£…ä¸æ¿€æ´»</title>
    <link href="http://www.daichongweb.com/Navicat-Premium-12-1%E5%AE%89%E8%A3%85%E4%B8%8E%E6%BF%80%E6%B4%BB/"/>
    <id>http://www.daichongweb.com/Navicat-Premium-12-1å®‰è£…ä¸æ¿€æ´»/</id>
    <published>2019-09-28T09:45:15.000Z</published>
    <updated>2020-08-19T03:47:24.060Z</updated>
    
    <content type="html"><![CDATA[<p><b>å‰è¨€</b></p><p>&emsp;<a>ï¼ˆ1ï¼‰å³å°†å›½åº†ï¼Œåœ¨æˆ‘å›è€å®¶ä¹‹å‰ç»™å¤§å®¶åˆ†äº«ä¸€æ³¢ç¦åˆ©ï¼</a></p><p>&emsp;ï¼ˆ2ï¼‰åç«¯å¼€å‘ç¦»ä¸å¼€æ•°æ®åº“çš„ç®¡ç†ï¼Œä¸ºäº†æ›´åŠ æ–¹ä¾¿çš„ç®¡ç†æ•°æ®ï¼Œç»å¸¸ä¼šä½¿ç”¨ä¸€äº›æ•°æ®åº“ç®¡ç†å·¥ã€‚å¦‚<a href="https://www.phpmyadmin.net" target="_blank" rel="noopener">phpMyAdmin</a>ã€<a href="https://www.webyog.com/" target="_blank" rel="noopener">SQLyog</a>ã€<a href="https://dev.mysql.com/downloads/workbench/" target="_blank" rel="noopener">Workbench</a>ã€ <a href="https://www.navicat.com.cn/" target="_blank" rel="noopener">Navicat</a>ç­‰ç­‰ã€‚</p><p>&emsp;ï¼ˆ3ï¼‰ä½†æˆ‘ä¸ªäººè§‰å¾—ä»UIã€åŠŸèƒ½ä¸Šæ¥è¯´æœ€ä¼˜çš„æ˜¯<a>Navicat</a>ã€‚</p><p>&emsp;ï¼ˆ4ï¼‰å…·ä½“çš„åŠŸèƒ½å°±ä¸åšä»‹ç»äº†ï¼Œæœ¬ç¯‡å°±æ•™å¤§å®¶æ€ä¹ˆç ´è§£ä½¿ç”¨æœ€æ–°ç‰ˆçš„<a>Navicat</a>ï¼Œè€Œä¸”æ˜¯ç ´è§£å®˜æ–¹ç‰ˆçš„å“¦ï¼Œç»å¯¹ä¸æ˜¯é‚£ç§ä»ä¹±ä¸ƒå…«ç³Ÿçš„ç½‘ç«™ä¸Šä¸‹è½½æ¥çš„ã€‚</p><p>&emsp;ï¼ˆ5ï¼‰å®‰å…¨å¯é ï¼Œå¥½ç”¨ï¼Œ<a>å®˜æ–¹æ”¶è´¹3ä¸ªæœˆ1699äººæ°‘å¸</a>ï¼Œé©¬ä¸Šèƒ½å…è´¹ç”¨åˆ°ä»–ï¼Œæƒ³æƒ³å°±è§‰å¾—å…´å¥‹ã€‚<br><a id="more"></a></p><p><b>ä¸‹è½½&amp;å®‰è£…</b></p><p>&emsp;ï¼ˆ1ï¼‰å®˜æ–¹æœ€æ–°ç‰ˆä¸‹è½½åœ°å€:<a href="https://www.navicat.com.cn/download/navicat-premium" target="_blank" rel="noopener">Navicat Premium 12.1</a>ã€‚</p><p>&emsp;ï¼ˆ2ï¼‰æ³¨å†Œæœºä¸‹è½½åœ°å€ï¼š <a href="https://pan.baidu.com/s/1ADnw3MrVnzV4j1-MTLv1qg" target="_blank" rel="noopener">Navicatæ³¨å†Œæœº</a>ã€‚</p><p><b>ç ´è§£</b></p><p>&emsp;ï¼ˆ2ï¼‰<a>Navicat Premium 12.1</a>å®‰è£…æ­¥éª¤å°±ä¸ä»‹ç»äº†ï¼Œç›´æ¥éƒ½nextå°±å¥½äº†ã€‚</p><p>&emsp;ï¼ˆ3ï¼‰å®‰è£…æ³¨å†Œæœºï¼ˆæŠŠæ€æ¯’è½¯ä»¶å…¨éƒ¨é€€å‡ºï¼‰ã€‚</p><p>&emsp;ï¼ˆ4ï¼‰é€‰æ‹©ä½ å¯¹åº”çš„ç‰ˆæœ¬ä¿¡æ¯å’Œè¯­è¨€ã€‚</p><img src="/Navicat-Premium-12-1å®‰è£…ä¸æ¿€æ´»/img/p.png"><p>&emsp;ï¼ˆ5ï¼‰ç‚¹å‡»Patché€‰æ‹©Navicatå®‰è£…ç›®å½•ä¸‹çš„navicat.exeã€‚</p><img src="/Navicat-Premium-12-1å®‰è£…ä¸æ¿€æ´»/img/p1.png"><p>&emsp;ï¼ˆ6ï¼‰ç‚¹å‡»Generateç”Ÿæˆæ³¨å†Œç ã€‚</p><img src="/Navicat-Premium-12-1å®‰è£…ä¸æ¿€æ´»/img/p2.png"><p>&emsp;ï¼ˆ7ï¼‰æŠŠæ³¨å†Œç å¤åˆ¶åˆ°è½¯ä»¶ä¸­ï¼Œç‚¹å‡»æ¿€æ´»ï¼Œè¿™é‡Œä¼šæç¤ºæ¿€æ´»å¤±è´¥ï¼Œç„¶åå’±ä»¬ç‚¹å‡»æ‰‹åŠ¨æ¿€æ´»ã€‚</p><img src="/Navicat-Premium-12-1å®‰è£…ä¸æ¿€æ´»/img/p4.png"><p>&emsp;ï¼ˆ8ï¼‰æŠŠè¯·æ±‚ç å¤åˆ¶åˆ°æ³¨å†Œæœºä¸­ï¼Œå¦‚ä¸‹é¢çš„ä½ç½®ï¼Œç„¶åç‚¹å‡»Generateï¼ŒæŠŠè¿”å›çš„æ¿€æ´»ç å†å¤åˆ¶å›è½¯ä»¶ä¸­ï¼Œç‚¹å‡»æ¿€æ´»ã€‚</p><img src="/Navicat-Premium-12-1å®‰è£…ä¸æ¿€æ´»/img/p5.png"><p>&emsp;ï¼ˆ9ï¼‰æ¿€æ´»æˆåŠŸã€‚</p><img src="/Navicat-Premium-12-1å®‰è£…ä¸æ¿€æ´»/img/p6.png"><p><b>æœ€å</b></p><p>&emsp;ç„¶åå°±å°½æƒ…çš„ä½¿ç”¨å§ï¼ï¼ï¼ï¼å“ˆå“ˆå“ˆã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;b&gt;å‰è¨€&lt;/b&gt;&lt;/p&gt;
&lt;p&gt;&amp;emsp;&lt;a&gt;ï¼ˆ1ï¼‰å³å°†å›½åº†ï¼Œåœ¨æˆ‘å›è€å®¶ä¹‹å‰ç»™å¤§å®¶åˆ†äº«ä¸€æ³¢ç¦åˆ©ï¼&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&amp;emsp;ï¼ˆ2ï¼‰åç«¯å¼€å‘ç¦»ä¸å¼€æ•°æ®åº“çš„ç®¡ç†ï¼Œä¸ºäº†æ›´åŠ æ–¹ä¾¿çš„ç®¡ç†æ•°æ®ï¼Œç»å¸¸ä¼šä½¿ç”¨ä¸€äº›æ•°æ®åº“ç®¡ç†å·¥ã€‚å¦‚&lt;a href=&quot;https://www.phpmyadmin.net&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;phpMyAdmin&lt;/a&gt;ã€&lt;a href=&quot;https://www.webyog.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;SQLyog&lt;/a&gt;ã€&lt;a href=&quot;https://dev.mysql.com/downloads/workbench/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Workbench&lt;/a&gt;ã€ &lt;a href=&quot;https://www.navicat.com.cn/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Navicat&lt;/a&gt;ç­‰ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;&amp;emsp;ï¼ˆ3ï¼‰ä½†æˆ‘ä¸ªäººè§‰å¾—ä»UIã€åŠŸèƒ½ä¸Šæ¥è¯´æœ€ä¼˜çš„æ˜¯&lt;a&gt;Navicat&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&amp;emsp;ï¼ˆ4ï¼‰å…·ä½“çš„åŠŸèƒ½å°±ä¸åšä»‹ç»äº†ï¼Œæœ¬ç¯‡å°±æ•™å¤§å®¶æ€ä¹ˆç ´è§£ä½¿ç”¨æœ€æ–°ç‰ˆçš„&lt;a&gt;Navicat&lt;/a&gt;ï¼Œè€Œä¸”æ˜¯ç ´è§£å®˜æ–¹ç‰ˆçš„å“¦ï¼Œç»å¯¹ä¸æ˜¯é‚£ç§ä»ä¹±ä¸ƒå…«ç³Ÿçš„ç½‘ç«™ä¸Šä¸‹è½½æ¥çš„ã€‚&lt;/p&gt;
&lt;p&gt;&amp;emsp;ï¼ˆ5ï¼‰å®‰å…¨å¯é ï¼Œå¥½ç”¨ï¼Œ&lt;a&gt;å®˜æ–¹æ”¶è´¹3ä¸ªæœˆ1699äººæ°‘å¸&lt;/a&gt;ï¼Œé©¬ä¸Šèƒ½å…è´¹ç”¨åˆ°ä»–ï¼Œæƒ³æƒ³å°±è§‰å¾—å…´å¥‹ã€‚&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="å¼€å‘å·¥å…·" scheme="http://www.daichongweb.com/tags/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
  <entry>
    <title>swoole+websocketå®ç°èŠå¤©å®¤åŠŸèƒ½</title>
    <link href="http://www.daichongweb.com/swoole+websocket%E5%AE%9E%E7%8E%B0%E8%81%8A%E5%A4%A9%E5%AE%A4%E5%8A%9F%E8%83%BD/"/>
    <id>http://www.daichongweb.com/swoole+websocketå®ç°èŠå¤©å®¤åŠŸèƒ½/</id>
    <published>2019-09-25T02:43:15.000Z</published>
    <updated>2020-08-19T03:46:29.213Z</updated>
    
    <content type="html"><![CDATA[<p><b>åŸºç¡€ä»‹ç»</b></p><p>&emsp;ï¼ˆ1ï¼‰<a href="https://baike.baidu.com/item/Swoole/3707136?fr=aladdin" target="_blank" rel="noopener">Swoole</a>æ˜¯ä¸€ä¸ªé¢å‘ç”Ÿäº§ç¯å¢ƒçš„ PHP å¼‚æ­¥ç½‘ç»œé€šä¿¡å¼•æ“ï¼Œä½¿ PHP å¼€å‘äººå‘˜å¯ä»¥ç¼–å†™é«˜æ€§èƒ½çš„å¼‚æ­¥å¹¶å‘ TCPã€UDPã€Unix Socketã€HTTPï¼ŒWebSocket æœåŠ¡ã€‚Swoole å¯ä»¥å¹¿æ³›åº”ç”¨äºäº’è”ç½‘ã€ç§»åŠ¨é€šä¿¡ã€ä¼ä¸šè½¯ä»¶ã€äº‘è®¡ç®—ã€ç½‘ç»œæ¸¸æˆã€ç‰©è”ç½‘ï¼ˆIOTï¼‰ã€è½¦è”ç½‘ã€æ™ºèƒ½å®¶å±…ç­‰é¢†åŸŸã€‚ ä½¿ç”¨ PHP + Swoole ä½œä¸ºç½‘ç»œé€šä¿¡æ¡†æ¶ï¼Œå¯ä»¥ä½¿ä¼ä¸š IT ç ”å‘å›¢é˜Ÿçš„æ•ˆç‡å¤§å¤§æå‡ã€‚â€”<em>ç™¾åº¦ç™¾ç§‘</em></p><p>&emsp;ï¼ˆ2ï¼‰<a href="https://baike.baidu.com/item/WebSocket/1953845?fr=aladdin" target="_blank" rel="noopener">WebSocket</a>æ˜¯ä¸€ç§åœ¨å•ä¸ªTCPè¿æ¥ä¸Šè¿›è¡Œå…¨åŒå·¥é€šä¿¡çš„åè®®ã€‚WebSocketé€šä¿¡åè®®äº2011å¹´è¢«IETFå®šä¸ºæ ‡å‡†RFC 6455ï¼Œå¹¶ç”±RFC7936è¡¥å……è§„èŒƒã€‚WebSocket APIä¹Ÿè¢«W3Cå®šä¸ºæ ‡å‡†ã€‚<br>WebSocketä½¿å¾—å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„æ•°æ®äº¤æ¢å˜å¾—æ›´åŠ ç®€å•ï¼Œå…è®¸æœåŠ¡ç«¯ä¸»åŠ¨å‘å®¢æˆ·ç«¯æ¨é€æ•°æ®ã€‚åœ¨WebSocket APIä¸­ï¼Œæµè§ˆå™¨å’ŒæœåŠ¡å™¨åªéœ€è¦å®Œæˆä¸€æ¬¡æ¡æ‰‹ï¼Œä¸¤è€…ä¹‹é—´å°±ç›´æ¥å¯ä»¥åˆ›å»ºæŒä¹…æ€§çš„è¿æ¥ï¼Œå¹¶è¿›è¡ŒåŒå‘æ•°æ®ä¼ è¾“ã€‚ â€”<em>ç™¾åº¦ç™¾ç§‘</em><br><a id="more"></a></p><p>&emsp;ï¼ˆ3ï¼‰é‚£è¿™ç¯‡çš„ä¸»é¢˜å°±æ˜¯å¦‚ä½•ä½¿ç”¨<a>Swoole</a>+<a>WebSocket</a>å®ç°ä¸€ä¸ªç®€æ˜“çš„èŠå¤©å®¤ã€‚</p><p>&emsp;&emsp;ç†Ÿæ‚‰ç½‘ç»œé€šä¿¡åè®®çš„åŒå­¦è‚¯å®šä¸ä¼šé™Œç”Ÿã€‚</p><p><b>åŠŸèƒ½éœ€æ±‚åŠé—®é¢˜å¤„ç†</b></p><p>&emsp;webç«¯ï¼š<br>&emsp;&emsp;ï¼ˆ1ï¼‰æ¯æ¬¡åˆ·æ–°éƒ½ä¼šç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„ID(idå€¼ä»1å¼€å§‹).<br>&emsp;&emsp;ï¼ˆ2ï¼‰ç¬¬ä¸€æ¬¡è¿›å…¥ç½‘ç«™æ—¶ä¼šè¦æ±‚ç”¨æˆ·è®¾ç½®æ˜µç§°å¹¶ä¼šä¸IDè¿›è¡Œç»‘å®šã€‚<br>&emsp;é—®é¢˜ç‚¹ï¼š<br>&emsp;&emsp;ï¼ˆ1ï¼‰åˆ·æ–°é¡µé¢åç”¨æˆ·æ ‡è¯†ï¼ˆIDï¼‰ä¼šé‡æ–°ç”Ÿæˆï¼Œä¹‹å‰ç”ŸæˆIDè¢«å¼ƒç”¨ã€‚<br>&emsp;&emsp;ï¼ˆ2ï¼‰websocketç”Ÿæˆäº†æ–°çš„ç”¨æˆ·ID,ä½†æ˜¯è·Ÿç°åœ¨çš„æ— æ³•å½¢æˆå…³è”å…³ç³»ã€‚</p><p>&emsp;serverç«¯ï¼š<br>&emsp;ï¼ˆ1ï¼‰å½“ç”¨æˆ·è¿›å…¥èŠå¤©å®¤åï¼Œå‘é€å¹¿æ’­ç»™æ‰€æœ‰äººå¹¶åŠ å…¥èŠå¤©ç¾¤ç»„ï¼ˆä½¿ç”¨rediså­˜å‚¨ï¼‰ã€‚<br>&emsp;ï¼ˆ2ï¼‰å½“ç”¨æˆ·é€€å‡ºç›´æ’­é—´åï¼Œå‘é€å¹¿æ’­ç»™æ‰€æœ‰äººå¹¶æ¸…é™¤è¯¥ç”¨æˆ·çš„è®°å½•ã€‚<br>&emsp;ï¼ˆ3ï¼‰ç”¨æˆ·æ¯å‘é€ä¸€æ¬¡æ¶ˆæ¯éƒ½è¦å½¢æˆæ–°çš„è®°å½•å¹¿æ’­ç»™æ‰€æœ‰äººã€‚<br>&emsp;ï¼ˆ4ï¼‰ç”¨æˆ·ç”Ÿæˆæ–°çš„æ˜µç§°åæŠŠæ˜µç§°æ¨é€ç»™ä»–ã€‚</p><p>&emsp;webç«¯é—®é¢˜å¤„ç†æ–¹æ³•ï¼š<br>&emsp;ï¼ˆ1ï¼‰æµè§ˆå™¨åˆ·æ–°æ—¶æé†’ç”¨æˆ·åˆ·æ–°å³å°†é‡æ–°è·å¾—æ–°çš„èº«ä»½ã€‚<br>&emsp;ï¼ˆ2ï¼‰ç”¨æˆ·è¿æ¥æˆåŠŸåè®°å½•ç”¨æˆ·name,æ¯æ¬¡è¿æ¥æŠŠè¿™ä¸ªnameå¸¦ä¸Šï¼Œæ¸…é™¤ä¹‹å‰è¯¥nameçš„ç»‘å®šå…³ç³»ï¼Œå½¢æˆæ–°çš„å…³ç³»ã€‚</p><p><b>æ¼”ç¤ºåœ°å€</b></p><p>&emsp;<a href="http://swoole.daichongweb.cn" target="_blank" rel="noopener">èŠå¤©å®¤æ¼”ç¤º</a></p><p><b>ä»£ç å®ç°</b><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include &quot;RedisManager.php&quot;;</span><br><span class="line"></span><br><span class="line">$server = new Swoole\WebSocket\Server(&quot;0.0.0.0&quot;, 8877);</span><br><span class="line"></span><br><span class="line">// å®¢æˆ·ç«¯è¿æ¥</span><br><span class="line">$server-&gt;on(&apos;open&apos;, function (Swoole\WebSocket\Server $server, $request) &#123;</span><br><span class="line">    //è¿æ¥æˆåŠŸæŠŠå½“å‰åœ¨çº¿çš„ç”¨æˆ·è¿”å›</span><br><span class="line">    $user_list = RedisConnect::getRedis()-&gt;hGetAll(&apos;message:user&apos;);</span><br><span class="line">    alone($server, $request-&gt;fd, [</span><br><span class="line">        &apos;type&apos; =&gt; &apos;first&apos;,</span><br><span class="line">        &apos;data&apos; =&gt; $user_list</span><br><span class="line">    ]);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// æ¥æ”¶å®¢æˆ·ç«¯å‘é€çš„æ¶ˆæ¯</span><br><span class="line">$server-&gt;on(&apos;message&apos;, function (Swoole\WebSocket\Server $server, $frame) &#123;</span><br><span class="line">    $message_data = json_decode($frame-&gt;data, true);</span><br><span class="line">    $type = $message_data[&apos;type&apos;];</span><br><span class="line">    $data = $message_data[&apos;user_name&apos;];</span><br><span class="line">    if (isset($message_data[&apos;send_message&apos;])) &#123;</span><br><span class="line">        $user_message = $message_data[&apos;send_message&apos;];</span><br><span class="line">    &#125;</span><br><span class="line">    switch ($type) &#123;</span><br><span class="line">        case &apos;save_user&apos;:</span><br><span class="line">            $new_name = &apos;å¤§å¦å•å­&apos; . $frame-&gt;fd . &apos;å·&apos;;</span><br><span class="line">            // ä¿®æ”¹ç”¨æˆ·æ˜µç§°</span><br><span class="line">            RedisConnect::getRedis()-&gt;hset(&apos;message:user&apos;, $frame-&gt;fd, $new_name);</span><br><span class="line"></span><br><span class="line">            // æŠŠç”Ÿæˆçš„ç”¨æˆ·æ˜µç§°è¿”å›ç»™ä»–</span><br><span class="line">            alone($server, $frame-&gt;fd, [</span><br><span class="line">                &apos;type&apos; =&gt; &apos;new_name&apos;,</span><br><span class="line">                &apos;name&apos; =&gt; $new_name,</span><br><span class="line">                &apos;id&apos; =&gt; $frame-&gt;fd</span><br><span class="line">            ]);</span><br><span class="line"></span><br><span class="line">            // å¹¿æ’­æ¶ˆæ¯ç»™å…¶ä»–ç”¨æˆ·</span><br><span class="line">            groupSending($server, [</span><br><span class="line">                &apos;type&apos; =&gt; &apos;open&apos;,</span><br><span class="line">                &apos;name&apos; =&gt; $new_name,</span><br><span class="line">                &apos;id&apos; =&gt; $frame-&gt;fd</span><br><span class="line">            ]);</span><br><span class="line">            break;</span><br><span class="line">        case &apos;send_message&apos;:</span><br><span class="line">            $msg = [</span><br><span class="line">                &apos;id&apos; =&gt; $frame-&gt;fd,</span><br><span class="line">                &apos;user_name&apos; =&gt; $data,</span><br><span class="line">                &apos;message&apos; =&gt; $user_message,</span><br><span class="line">                &apos;type&apos; =&gt; &apos;message&apos;</span><br><span class="line">            ];</span><br><span class="line">            // æ¥å—ç”¨æˆ·å‘é€çš„æ¶ˆæ¯</span><br><span class="line">            RedisConnect::getRedis()-&gt;lpush(&apos;message:user:say&apos;, $msg);</span><br><span class="line">            groupSending($server, $msg);</span><br><span class="line">            break;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// é€€å‡ºèŠå¤©å®¤</span><br><span class="line">$server-&gt;on(&apos;close&apos;, function ($ser, $fd) &#123;</span><br><span class="line">    $user = RedisConnect::getRedis()-&gt;hget(&apos;message:user&apos;, $fd);</span><br><span class="line">    RedisConnect::getRedis()-&gt;hdel(&apos;message:user&apos;, $fd);</span><br><span class="line">    $msg = [</span><br><span class="line">        &apos;id&apos; =&gt; $fd,</span><br><span class="line">        &apos;user_name&apos; =&gt; $user,</span><br><span class="line">        &apos;message&apos; =&gt; &apos;é€€å‡ºèŠå¤©å®¤&apos;,</span><br><span class="line">        &apos;type&apos; =&gt; &apos;close&apos;</span><br><span class="line">    ];</span><br><span class="line">    groupSending($ser, $msg, $fd);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// å¼€å¯æœåŠ¡</span><br><span class="line">$server-&gt;start();</span><br><span class="line"></span><br><span class="line">// ç¾¤å‘æ¶ˆæ¯</span><br><span class="line">function groupSending($server, $msg, $self = null)</span><br><span class="line">&#123;</span><br><span class="line">    foreach ($server-&gt;connections as $conn) &#123;</span><br><span class="line">        if ($conn == $self) break; //ä¸å†æ¨é€ç»™å½“å‰é€€å‡ºçš„ç”¨æˆ·</span><br><span class="line">        $server-&gt;push($conn, json_encode($msg));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// å•ç‹¬å‘æ¶ˆæ¯</span><br><span class="line">function alone($server, $fd, $msg)</span><br><span class="line">&#123;</span><br><span class="line">    $server-&gt;push($fd, json_encode($msg));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span><br><span class="line">    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;ie=edge&quot;&gt;</span><br><span class="line">    &lt;title&gt;èŠå¤©å®¤&lt;/title&gt;</span><br><span class="line">    &lt;style&gt;</span><br><span class="line">       *&#123;margin:0;padding:0&#125;.box&#123;width:602px;height:500px;margin:20px auto&#125;.body&#123;width:500px;height:500px;border:1px solid #333;padding:20px;box-sizing:border-box;float:right&#125;.title&#123;text-align:center;margin-top:10px&#125;.msg&#123;margin-top:20px;width:100%;text-align:left&#125;.message_box&#123;width:100%;height:90%;margin-top:10px;font-size:12px;overflow:hidden;overflow-y:auto&#125;.name&#123;font-weight:bold&#125;.right&#123;text-align:right&#125;.prompt&#123;width:600px;margin:0 auto&#125;.live&#123;width:100px;height:500px;float:left;border:1px solid #333;font-size:12px;text-align:center&#125;.live-box&#123;height:100%;overflow:hidden;overflow-y:auto&#125;.live-box p&#123;margin-top:10px&#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div class=&quot;box&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;body&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;title&quot;&gt;+++++++++++èŠå¤©å®¤++++++++++++&lt;/div&gt;</span><br><span class="line">            &lt;div class=&quot;message_box&quot; id=&quot;test&quot;&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div class=&quot;live&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;live-title&quot;&gt;åœ¨çº¿äººæ•°&lt;/div&gt;</span><br><span class="line">            &lt;div class=&quot;live-box&quot;&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div class=&quot;prompt&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;text&quot; name=&quot;say&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;button&quot; value=&quot;å‘é€&quot; id=&quot;send&quot;&gt;</span><br><span class="line">        &lt;!-- &lt;input type=&quot;button&quot; value=&quot;å¢åŠ æ¶ˆæ¯&quot; id=&quot;add&quot;&gt; --&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;script src=&quot;jquery.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">    window.onbeforeunload = function (event) &#123;</span><br><span class="line">        window.localStorage.clear();</span><br><span class="line">    &#125;;</span><br><span class="line">    $(function () &#123;</span><br><span class="line">        window.user_name = &apos;&apos;;</span><br><span class="line">        // è·å–åœ¨çº¿ç”¨æˆ·</span><br><span class="line">        if (!(&quot;WebSocket&quot; in window)) &#123;</span><br><span class="line">            alert(&quot;æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒ WebSocket!&quot;);</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">        // è¿æ¥</span><br><span class="line">        let ws = new WebSocket(&quot;ws://49.235.172.110:8877&quot;);</span><br><span class="line">        //è¿æ¥æˆåŠŸ</span><br><span class="line">        ws.onopen = function (event) &#123;</span><br><span class="line">            // ä¿®æ”¹æ˜µç§°</span><br><span class="line">            let user_info = &#123;</span><br><span class="line">                &apos;type&apos;: &apos;save_user&apos;,</span><br><span class="line">                &apos;user_name&apos;: &apos;&apos;,</span><br><span class="line">            &#125;;</span><br><span class="line">            ws.send(JSON.stringify(user_info));</span><br><span class="line">            console.log(&apos;è¿æ¥æˆåŠŸ&apos;, &apos;ä¿®æ”¹æ˜µç§°æˆåŠŸ&apos;);</span><br><span class="line">        &#125;;</span><br><span class="line">        ws.onmessage = function (evt) &#123;</span><br><span class="line">            let received_msg = JSON.parse(evt.data);</span><br><span class="line">            let type = received_msg[&apos;type&apos;];</span><br><span class="line">            switch (type) &#123;</span><br><span class="line">                case &apos;message&apos;:</span><br><span class="line">                    add_msg(received_msg);</span><br><span class="line">                    break;</span><br><span class="line">                case &apos;close&apos;:</span><br><span class="line">                    $(&quot;.live-box&quot;).find(&apos;p[user=&apos; + received_msg[&apos;id&apos;] + &apos;]&apos;).remove();</span><br><span class="line">                    break;</span><br><span class="line">                case &apos;connect&apos;:</span><br><span class="line">                    console.log(received_msg);</span><br><span class="line">                    break;</span><br><span class="line">                case &apos;new_name&apos;:</span><br><span class="line">                    user_name = received_msg[&apos;name&apos;];</span><br><span class="line">                    break;</span><br><span class="line">                case &apos;open&apos;:</span><br><span class="line">                    $(&apos;.live-box&apos;).append(&apos;&lt;p user=&quot;&apos; + received_msg[&apos;id&apos;] + &apos;&quot;&gt;&apos; + received_msg[&apos;name&apos;] + &apos;&lt;/p&gt;&apos;);</span><br><span class="line">                    break;</span><br><span class="line">                case &apos;first&apos;:</span><br><span class="line">                    let data = received_msg[&apos;data&apos;];</span><br><span class="line">                    let str = &apos;&apos;;</span><br><span class="line">                    $.each(data, function (k, v) &#123;</span><br><span class="line">                        if (isNaN(v)) &#123;</span><br><span class="line">                            str += &apos;&lt;p user=&quot;&apos; + k + &apos;&quot;&gt;&apos; + v + &apos;&lt;/p&gt;&apos;;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;)</span><br><span class="line">                    $(&apos;.live-box&apos;).append(str);</span><br><span class="line">                    break;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        // å‘é€æ¶ˆæ¯</span><br><span class="line">        $(&quot;#send&quot;).click(function () &#123;</span><br><span class="line">            send_msg();</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        $(&quot;input[name=say]&quot;).bind(&quot;keydown&quot;, function (e) &#123;</span><br><span class="line">            var theEvent = e || window.event;</span><br><span class="line">            var code = theEvent.keyCode || theEvent.which || theEvent.charCode;</span><br><span class="line">            if (code == 13) &#123;</span><br><span class="line">                send_msg();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        // å‘é€æ¶ˆæ¯</span><br><span class="line">        function send_msg() &#123;</span><br><span class="line">            var message = $(&apos;input[name=say]&apos;).val();</span><br><span class="line">            if (message !== &apos; &apos;) &#123;</span><br><span class="line">                var arr = &#123;</span><br><span class="line">                    &apos;type&apos;: &apos;send_message&apos;,</span><br><span class="line">                    &apos;user_name&apos;: user_name,</span><br><span class="line">                    &apos;send_message&apos;: message</span><br><span class="line">                &#125;;</span><br><span class="line">                ws.send(JSON.stringify(arr));</span><br><span class="line">            &#125;</span><br><span class="line">            $(&apos;input[name=say]&apos;).val(&apos; &apos;);</span><br><span class="line">            var ele = document.getElementById(&quot;test&quot;);</span><br><span class="line">            if (ele.scrollHeight &gt; ele.clientHeight) &#123;</span><br><span class="line">                ele.scrollTop = ele.scrollHeight + 100;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // å¢åŠ æ¶ˆæ¯</span><br><span class="line">        function add_msg(data) &#123;</span><br><span class="line">            let str = &apos;&lt;div class=&quot;msg&quot;&gt;&apos;;</span><br><span class="line">            str += &apos;&lt;span class=&quot;name&quot;&gt;&apos; + data[&apos;user_name&apos;] + &apos;&lt;/span&gt;:&apos;;</span><br><span class="line">            str += &apos;&lt;span class=&quot;text&quot;&gt;&apos; + data[&apos;message&apos;] + &apos;&lt;/span&gt;&lt;/div&gt;&apos;;</span><br><span class="line">            $(&apos;.message_box&apos;).append(str);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p><b>æ€»ç»“</b></p><p>&emsp;è¿™ç¯‡æ–‡ç« åªæ˜¯ç®€å•çš„ä»‹ç»å‰åç«¯å¦‚ä½•å®ç°é€šä¿¡ï¼Œå¾ˆå¤šçš„ç»†èŠ‚é—®é¢˜æ²¡æœ‰è¿›è¡Œå¤„ç†ã€‚<br>&emsp;UIæ¯”è¾ƒlowï¼Œè¿™é‡Œå¤§å®¶åªçœ‹ä»£ç å°±å¥½äº†â€¦<br>&emsp;æ›´å¤šå…³äºSwooleçš„åŠŸèƒ½è¿˜å¾…æ¢ç´¢â€¦æ•¬è¯·æœŸå¾…â€¦</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;b&gt;åŸºç¡€ä»‹ç»&lt;/b&gt;&lt;/p&gt;
&lt;p&gt;&amp;emsp;ï¼ˆ1ï¼‰&lt;a href=&quot;https://baike.baidu.com/item/Swoole/3707136?fr=aladdin&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Swoole&lt;/a&gt;æ˜¯ä¸€ä¸ªé¢å‘ç”Ÿäº§ç¯å¢ƒçš„ PHP å¼‚æ­¥ç½‘ç»œé€šä¿¡å¼•æ“ï¼Œä½¿ PHP å¼€å‘äººå‘˜å¯ä»¥ç¼–å†™é«˜æ€§èƒ½çš„å¼‚æ­¥å¹¶å‘ TCPã€UDPã€Unix Socketã€HTTPï¼ŒWebSocket æœåŠ¡ã€‚Swoole å¯ä»¥å¹¿æ³›åº”ç”¨äºäº’è”ç½‘ã€ç§»åŠ¨é€šä¿¡ã€ä¼ä¸šè½¯ä»¶ã€äº‘è®¡ç®—ã€ç½‘ç»œæ¸¸æˆã€ç‰©è”ç½‘ï¼ˆIOTï¼‰ã€è½¦è”ç½‘ã€æ™ºèƒ½å®¶å±…ç­‰é¢†åŸŸã€‚ ä½¿ç”¨ PHP + Swoole ä½œä¸ºç½‘ç»œé€šä¿¡æ¡†æ¶ï¼Œå¯ä»¥ä½¿ä¼ä¸š IT ç ”å‘å›¢é˜Ÿçš„æ•ˆç‡å¤§å¤§æå‡ã€‚â€”&lt;em&gt;ç™¾åº¦ç™¾ç§‘&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&amp;emsp;ï¼ˆ2ï¼‰&lt;a href=&quot;https://baike.baidu.com/item/WebSocket/1953845?fr=aladdin&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;WebSocket&lt;/a&gt;æ˜¯ä¸€ç§åœ¨å•ä¸ªTCPè¿æ¥ä¸Šè¿›è¡Œå…¨åŒå·¥é€šä¿¡çš„åè®®ã€‚WebSocketé€šä¿¡åè®®äº2011å¹´è¢«IETFå®šä¸ºæ ‡å‡†RFC 6455ï¼Œå¹¶ç”±RFC7936è¡¥å……è§„èŒƒã€‚WebSocket APIä¹Ÿè¢«W3Cå®šä¸ºæ ‡å‡†ã€‚&lt;br&gt;WebSocketä½¿å¾—å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„æ•°æ®äº¤æ¢å˜å¾—æ›´åŠ ç®€å•ï¼Œå…è®¸æœåŠ¡ç«¯ä¸»åŠ¨å‘å®¢æˆ·ç«¯æ¨é€æ•°æ®ã€‚åœ¨WebSocket APIä¸­ï¼Œæµè§ˆå™¨å’ŒæœåŠ¡å™¨åªéœ€è¦å®Œæˆä¸€æ¬¡æ¡æ‰‹ï¼Œä¸¤è€…ä¹‹é—´å°±ç›´æ¥å¯ä»¥åˆ›å»ºæŒä¹…æ€§çš„è¿æ¥ï¼Œå¹¶è¿›è¡ŒåŒå‘æ•°æ®ä¼ è¾“ã€‚ â€”&lt;em&gt;ç™¾åº¦ç™¾ç§‘&lt;/em&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="phpæ‰©å±•ç±»" scheme="http://www.daichongweb.com/tags/php%E6%89%A9%E5%B1%95%E7%B1%BB/"/>
    
  </entry>
  
  <entry>
    <title>WEBæ€§èƒ½æµ‹è¯•-å¹¶å‘æµ‹è¯•</title>
    <link href="http://www.daichongweb.com/WEB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95-%E5%B9%B6%E5%8F%91%E6%B5%8B%E8%AF%95/"/>
    <id>http://www.daichongweb.com/WEBæ€§èƒ½æµ‹è¯•-å¹¶å‘æµ‹è¯•/</id>
    <published>2019-09-18T07:07:45.000Z</published>
    <updated>2020-08-19T03:46:29.149Z</updated>
    
    <content type="html"><![CDATA[<p><b>å‰ç¯‡å›å¿†ï¼š</b></p><p>&emsp;å‰ä¸¤ç¯‡ä»‹ç»äº†<a>redis</a>é˜Ÿåˆ—å¦‚ä½•å¤„ç†è®¢å•å’Œ<a>JMeter</a>çš„ç¯å¢ƒé…ç½®åŠå®‰è£…æ–¹æ³•ï¼Œè¿™ç¯‡æ ¹æ®ç¨‹åºå¼€å‘çš„é€»è¾‘å’Œä¹ æƒ¯æ¥è§£å†³å‡ ä¸ªé—®é¢˜ï¼š</p><p>&emsp;&emsp;ï¼ˆ1ï¼‰JMeterå¹¶å‘æµ‹è¯•çš„åŸºæœ¬ä½¿ç”¨ã€‚<br>&emsp;&emsp;ï¼ˆ2ï¼‰<a>redis</a>å’Œ<a>mysql</a>ç›¸æ¯”çš„æ€§èƒ½å·®è·å¦‚ä½•ï¼Ÿ<br>&emsp;&emsp;ï¼ˆ3ï¼‰å¤§é‡çš„å¹¶å‘å’Œè¯·æ±‚ä¸‹<a>redis</a>ã€<a>mysql</a>ã€<a>nginx</a>å„è‡ªä¼šå‡ºç°çš„é—®é¢˜ï¼Ÿ<br>&emsp;&emsp;ï¼ˆ4ï¼‰é‡åˆ°å¹¶å‘å¸¦æ¥å„ç§å„æ ·çš„é—®é¢˜å¦‚ä½•è§£å†³ï¼Ÿ<br><a id="more"></a></p><p><b>é—®é¢˜ä¸€ï¼š<sup>JMeterå¹¶å‘æµ‹è¯•çš„åŸºæœ¬ä½¿ç”¨<sup></sup></sup></b></p><p>&emsp;ï¼ˆ1ï¼‰è®¾ç½®ç³»ç»Ÿè¯­è¨€ï¼šOptions-&gt;Choose Lanuage é‡Œé€‰æ‹©é€‚åˆä½ çš„è¯­è¨€ã€‚<br>&emsp;ï¼ˆ2ï¼‰æ·»åŠ çº¿ç¨‹ç»„ï¼š<br><img src="/WEBæ€§èƒ½æµ‹è¯•-å¹¶å‘æµ‹è¯•/img/plan.png"><br>&emsp;ï¼ˆ3ï¼‰è®¾ç½®çº¿ç¨‹å±æ€§ï¼š<br>&emsp;&emsp;çº¿ç¨‹æ•°ï¼šä¹Ÿå°±æ˜¯å¹¶å‘æ•°ã€‚<br>&emsp;&emsp;Ramp-Upæ—¶é—´ï¼ˆç§’ï¼‰ï¼šå¹¶å‘æ—¶é—´ï¼Œ0ä¸ºåŒæ—¶å¹¶å‘ã€‚<br>&emsp;&emsp;å¾ªç¯æ¬¡æ•°ï¼šé‡å¤æ¬¡æ•°ã€‚<br><img src="/WEBæ€§èƒ½æµ‹è¯•-å¹¶å‘æµ‹è¯•/img/plan1.png"><br>&emsp;ï¼ˆ4ï¼‰æ·»åŠ HTTPè¯·æ±‚ï¼š<br>&emsp;&emsp;åè®®ï¼šhttpæˆ–httpsã€‚<br>&emsp;&emsp;æœåŠ¡å™¨åç§°æˆ–IPï¼šè¯·æ±‚åœ°å€ã€‚<br>&emsp;&emsp;è·¯å¾„ï¼šè¦è¯·æ±‚çš„è·¯ç”±æˆ–æ–‡ä»¶è·¯å¾„ã€‚<br>&emsp;&emsp;å‚æ•°ï¼šæ·»åŠ è¯·æ±‚å‚æ•°ã€‚<br><img src="/WEBæ€§èƒ½æµ‹è¯•-å¹¶å‘æµ‹è¯•/img/plan2.png"><br>&emsp;ï¼ˆ5ï¼‰æ·»åŠ å¯Ÿçœ‹ç»“æœæ ‘ï¼šå¯æŸ¥çœ‹å‘é€çš„æ•°æ®ï¼Œè¿”å›çš„ç»“æœç­‰ã€‚<br><img src="/WEBæ€§èƒ½æµ‹è¯•-å¹¶å‘æµ‹è¯•/img/plan3.png"><br>&emsp;ï¼ˆ6ï¼‰æ·»åŠ æ±‡æ€»æŠ¥å‘Šï¼šå¯æŸ¥çœ‹é”™è¯¯ç‡ï¼Œååé‡ç­‰ã€‚<br><img src="/WEBæ€§èƒ½æµ‹è¯•-å¹¶å‘æµ‹è¯•/img/plan4.png"></p><p><b>é—®é¢˜äºŒï¼š<sup>å¤§é‡çš„å¹¶å‘å’Œè¯·æ±‚ä¸‹<a>redis</a>ã€<a>mysql</a>ã€<a>nginx</a>å„è‡ªä¼šå‡ºç°çš„é—®é¢˜ï¼Ÿ<sup></sup></sup></b></p><p>&emsp;åœ¨åŒæ—¶å¹¶å‘2000çš„æƒ…å†µä¸‹ï¼ˆå› ä¸ºredisé˜Ÿåˆ—ä¸ºå¼‚æ­¥ï¼Œæ‰€ä»¥è¿™é‡Œä¸è€ƒè™‘rediså‡ºåˆ—çš„æ€§èƒ½é—®é¢˜ï¼‰ï¼š<br>&emsp;<a>mysql</a>ï¼šé”™è¯¯ç‡87.9%ï¼ŒæˆåŠŸæ¡æ•°241ã€‚<br><img src="/WEBæ€§èƒ½æµ‹è¯•-å¹¶å‘æµ‹è¯•/img/plan5.png"><br>&emsp;<a>redis</a>ï¼šé”™è¯¯ç‡0.35%ï¼ŒæˆåŠŸæ¡æ•°1993ã€‚<br><img src="/WEBæ€§èƒ½æµ‹è¯•-å¹¶å‘æµ‹è¯•/img/plan5.png"><br>&emsp;æ€»ç»“ï¼šä»ä»¥ä¸Šç»“æœå¯ä»¥çœ‹å‡ºåœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹msyqlæ‰›ä¸ä½å‹åŠ›é”™è¯¯ç‡é«˜ã€‚<br>&emsp;ç»“è®ºï¼šredisåœ¨å¤„ç†å¹¶å‘æ€§èƒ½ä¼˜äºmysqlã€‚</p><p><b>é—®é¢˜ä¸‰ï¼šå¤§é‡çš„å¹¶å‘å’Œè¯·æ±‚ä¸‹<a>redis</a>ã€<a>mysql</a>ã€<a>nginx</a>å„è‡ªä¼šå‡ºç°çš„é—®é¢˜ï¼Ÿ</b></p><p>&emsp;3000å¹¶å‘å¾ªç¯è¯·æ±‚3æ¬¡ç›¸å½“äº9000çš„æ¬¡è¯·æ±‚çš„æƒ…å†µä¸‹ï¼š<br>&emsp;&emsp;ï¼ˆ1ï¼‰nginxæŠ¥é”™ï¼š<a>Too many open files</a>ï¼ˆæ‰“å¼€çš„æ–‡ä»¶æ•°è¶…è¿‡é™åˆ¶nginxé»˜è®¤ä¸º1024ï¼‰ã€‚<br>&emsp;&emsp;ï¼ˆ2ï¼‰redisæŠ¥é”™ï¼š<a>RDB: 2 MB of memory used by copy-on-write</a>ã€‚<br>&emsp;&emsp;ï¼ˆ3ï¼‰mysqlç›´æ¥å†™å…¥å¤±è´¥ã€‚</p><p><b>é—®é¢˜å››ï¼š<sup>é‡åˆ°å¹¶å‘å¸¦æ¥å„ç§å„æ ·çš„é—®é¢˜å¦‚ä½•è§£å†³ï¼Ÿ<sup></sup></sup></b></p><p>&emsp;ï¼ˆ1ï¼‰<a>nginxé”™è¯¯åˆ†æï¼šæœ€å¤§æ‰“å¼€æ–‡ä»¶æ•°è¶…è¿‡é™åˆ¶</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥çœ‹ç³»ç»Ÿæ‰“å¼€æ–‡ä»¶å€¼ Max open files</span><br><span class="line">catÂ /proc/`psÂ -efÂ |Â grepÂ nginx|grepÂ -vÂ grep|headÂ -1|awkÂ &apos;&#123;printÂ $2&#125;&apos;`/limits</span><br><span class="line"># ä¿®æ”¹</span><br><span class="line">vi /etc/systemd/ststem.conf</span><br><span class="line"># ä¿®æ”¹ä¸¤ä¸ªå€¼</span><br><span class="line">DefaultLimitNOFILE = 102400</span><br><span class="line">DefaultLimitNPROC = 102400</span><br><span class="line"># éšåé‡å¯ç³»ç»Ÿ</span><br></pre></td></tr></table></figure><br>&emsp;ï¼ˆ2ï¼‰<a>redisé”™è¯¯åˆ†æï¼šä¿å­˜é¢‘ç¹å¯¼è‡´å†…å­˜ä¸å¤Ÿäº†ã€‚</a>ï¼ˆæš‚æœªæ‰¾åˆ°æœ€åˆé€‚çš„æ–¹æ¡ˆï¼‰<br>&emsp;ç‚¹å‡»æŸ¥çœ‹æ›´è¯¦ç»†çš„é”™è¯¯åˆ†æ:<a href="https://yq.aliyun.com/articles/629296" target="_blank" rel="noopener">Redis-rediså¼‚å¸¸è§£å†³ä»¥åŠæ—¥å¸¸å‘½ä»¤</a></p><p>&emsp;ï¼ˆ3ï¼‰<a>mysql</a>æš‚æ²¡æ‰¾åˆ°æ–¹æ¡ˆã€‚</p><p><b>æ€»ç»“ï¼š</b></p><p>&emsp;ç›¸åŒçš„é…ç½®&amp;é«˜å¹¶å‘åœºæ™¯ä¸‹<a>redis</a>æ¯”<a>mysql</a>è¦å¯é å¾ˆå¤šï¼Œä¼´éšç€å¹¶å‘è¶Šæ¥è¶Šé«˜æœåŠ¡å™¨ã€ç¨‹åºã€æ•°æ®åº“å„æ–¹é¢çš„é—®é¢˜æ‰‘é¢è€Œæ¥ï¼Œä¸è¦æ…Œï¼Œè¿™æ‰æ˜¯ä½ çœŸæ­£éœ€è¦å­¦ä¹ çš„ä¸œè¥¿ï¼ç”Ÿäºå¿§æ‚£æ­»äºå®‰ä¹ï¼Œåªæœ‰ä¸æ–­çš„å¤„ç†é—®é¢˜ï¼Œæ‰èƒ½çœŸæ­£çš„é©¾é©­ç¨‹åºï¼ç¥ä½ æ—©æ—¥æˆåŠŸï¼ï¼ï¼</p><p>&emsp;æœ¬æ–‡æœ€é«˜æµ‹è¯•å¹¶å‘åœ¨3000å¾ªç¯æ¬¡æ•°ä¸º3æ¬¡ï¼ŒæœåŠ¡å™¨ç¯å¢ƒä¸ºlnmrp,ç³»ç»Ÿé…ç½®ä¸º2æ ¸4G6M,å› ä¸ºredisçš„é—®é¢˜æ²¡æœ‰è§£å†³ä¸èƒ½åšæ›´é«˜çš„å¹¶å‘æµ‹è¯•ã€‚å¹¶ä¸”è¿˜æœ‰ä¸€ä¸ªredisçš„é—®é¢˜æ²¡æœ‰è§£å†³ï¼Œå¾…æˆ‘ç ”ç©¶å‡ æ—¥è¯´ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;b&gt;å‰ç¯‡å›å¿†ï¼š&lt;/b&gt;&lt;/p&gt;
&lt;p&gt;&amp;emsp;å‰ä¸¤ç¯‡ä»‹ç»äº†&lt;a&gt;redis&lt;/a&gt;é˜Ÿåˆ—å¦‚ä½•å¤„ç†è®¢å•å’Œ&lt;a&gt;JMeter&lt;/a&gt;çš„ç¯å¢ƒé…ç½®åŠå®‰è£…æ–¹æ³•ï¼Œè¿™ç¯‡æ ¹æ®ç¨‹åºå¼€å‘çš„é€»è¾‘å’Œä¹ æƒ¯æ¥è§£å†³å‡ ä¸ªé—®é¢˜ï¼š&lt;/p&gt;
&lt;p&gt;&amp;emsp;&amp;emsp;ï¼ˆ1ï¼‰JMeterå¹¶å‘æµ‹è¯•çš„åŸºæœ¬ä½¿ç”¨ã€‚&lt;br&gt;&amp;emsp;&amp;emsp;ï¼ˆ2ï¼‰&lt;a&gt;redis&lt;/a&gt;å’Œ&lt;a&gt;mysql&lt;/a&gt;ç›¸æ¯”çš„æ€§èƒ½å·®è·å¦‚ä½•ï¼Ÿ&lt;br&gt;&amp;emsp;&amp;emsp;ï¼ˆ3ï¼‰å¤§é‡çš„å¹¶å‘å’Œè¯·æ±‚ä¸‹&lt;a&gt;redis&lt;/a&gt;ã€&lt;a&gt;mysql&lt;/a&gt;ã€&lt;a&gt;nginx&lt;/a&gt;å„è‡ªä¼šå‡ºç°çš„é—®é¢˜ï¼Ÿ&lt;br&gt;&amp;emsp;&amp;emsp;ï¼ˆ4ï¼‰é‡åˆ°å¹¶å‘å¸¦æ¥å„ç§å„æ ·çš„é—®é¢˜å¦‚ä½•è§£å†³ï¼Ÿ&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="æµ‹è¯•" scheme="http://www.daichongweb.com/tags/%E6%B5%8B%E8%AF%95/"/>
    
  </entry>
  
</feed>
